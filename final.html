


<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NewBox - O Sistema Pro Seu Negócio</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
 /* Estilos gerais */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary-color: #004466;
            --secondary-color: #0077aa;
            --accent-color: #009dcf;
            --light-bg: #e6f2f7;
            --white: #ffffff;
            --gray: #f5f5f5;
            --dark-gray: #333333;
            --border-color: #dddddd;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
        }

        /* Estilo do Bot de Ajuda */
        .help-bot-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .help-bot-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 68, 102, 0.3);
            transition: all 0.3s ease;
            position: relative;
        }
        
        .help-bot-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 68, 102, 0.4);
        }
        
        .help-bot-button i {
            font-size: 28px;
        }
        
        .help-bot-button .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--danger);
            color: white;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            border: 2px solid white;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.15);
                opacity: 0.8;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        .help-bot-panel {
            position: absolute;
            bottom: 75px;
            right: 0;
            background-color: white;
            width: 320px;
            border-radius: 15px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.15);
            overflow: hidden;
            display: none;
            opacity: 0;
            transform: translateY(20px) scale(0.95);
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        
        .help-bot-panel.active {
            display: block;
            opacity: 1;
            transform: translateY(0) scale(1);
        }
        
        .help-bot-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .help-bot-header h3 {
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .help-bot-header .close-help {
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            opacity: 0.8;
            transition: opacity 0.2s ease;
        }
        
        .help-bot-header .close-help:hover {
            opacity: 1;
        }
        
        .help-bot-body {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .help-bot-welcome {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid var(--border-color);
        }
        
        .help-bot-welcome h4 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .help-bot-welcome p {
            color: var(--dark-gray);
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .common-questions {
            padding: 20px;
        }
        
        .common-questions h4 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1rem;
        }
        
        .question-item {
            padding: 12px 15px;
            background-color: var(--light-bg);
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
        }
        
        .question-item:hover {
            background-color: rgba(0, 119, 170, 0.1);
            transform: translateX(5px);
        }
        
        .question-item i {
            margin-right: 10px;
            color: var(--secondary-color);
            font-size: 1.1rem;
        }
        
        .question-item span {
            color: var(--primary-color);
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .help-bot-chat {
            padding: 15px;
            display: none;
        }
        
        .help-bot-chat.active {
            display: block;
        }
        
        .chat-messages {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 15px;
        }
        
        .message {
            margin-bottom: 15px;
        }
        
        .message-user {
            display: flex;
            justify-content: flex-end;
        }
        
        .message-bot {
            display: flex;
            justify-content: flex-start;
        }
        
        .message-content {
            max-width: 75%;
            padding: 10px 15px;
            border-radius: 15px;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .message-user .message-content {
            background-color: var(--primary-color);
            color: white;
            border-top-right-radius: 5px;
        }
        
        .message-bot .message-content {
            background-color: var(--light-bg);
            color: var(--dark-gray);
            border-top-left-radius: 5px;
            position: relative;
        }
        
        .bot-options {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        
        .bot-option-btn {
            padding: 8px 12px;
            background-color: var(--light-bg);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            font-size: 0.8rem;
            color: var(--primary-color);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .bot-option-btn:hover {
            background-color: var(--primary-color);
            color: white;
        }
        
        .back-to-questions {
            text-align: center;
            margin-top: 15px;
        }
        
        .back-btn {
            background: none;
            border: none;
            color: var(--primary-color);
            font-size: 0.9rem;
            text-decoration: underline;
            cursor: pointer;
        }
        
        .back-btn:hover {
            color: var(--secondary-color);
        }
        
        /* Animação de digitação */
        .typing-indicator {
            display: flex;
            padding: 10px 15px;
            background-color: var(--light-bg);
            border-radius: 15px;
            border-top-left-radius: 5px;
            width: fit-content;
            margin-bottom: 15px;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            background-color: var(--primary-color);
            border-radius: 50%;
            margin: 0 2px;
            opacity: 0.6;
        }
        
        .typing-dot:nth-child(1) {
            animation: typing 1.2s infinite 0s;
        }
        
        .typing-dot:nth-child(2) {
            animation: typing 1.2s infinite 0.2s;
        }
        
        .typing-dot:nth-child(3) {
            animation: typing 1.2s infinite 0.4s;
        }
        
        @keyframes typing {
            0% {
                transform: translateY(0);
                opacity: 0.6;
            }
            50% {
                transform: translateY(-5px);
                opacity: 1;
            }
            100% {
                transform: translateY(0);
                opacity: 0.6;
            }
        }
        
        /* Estilos para o recurso de fala */
        .speak-button {
            background: none;
            border: none;
            color: var(--secondary-color);
            font-size: 1.1rem;
            cursor: pointer;
            padding: 5px;
            position: absolute;
            right: 5px;
            bottom: 5px;
            opacity: 0.7;
            transition: all 0.2s ease;
        }
        
        .speak-button:hover {
            opacity: 1;
            transform: scale(1.1);
        }
        
        .speak-button.speaking {
            color: var(--danger);
            animation: pulsate 1s infinite;
        }
        
        @keyframes pulsate {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* Controles de áudio */
        .audio-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
            padding: 10px;
            background-color: var(--light-bg);
            border-radius: 8px;
            flex-wrap: wrap;
        }
        
        .audio-toggle-button {
            display: flex;
            align-items: center;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 15px;
            padding: 8px 15px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .audio-toggle-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .audio-toggle-button i {
            margin-right: 5px;
            font-size: 1rem;
        }
        
        .audio-toggle-button.pause {
            background: linear-gradient(135deg, var(--warning), var(--warning));
        }
        
        .audio-control-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .audio-control-group label {
            font-size: 0.8rem;
            color: var(--primary-color);
        }
        
        .audio-control-group select,
        .audio-control-group input[type="range"] {
            width: 100%;
            padding: 5px;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            background-color: var(--white);
        }
        
        .speech-status {
            font-size: 0.8rem;
            color: var(--dark-gray);
            margin-top: 5px;
        }
        
        /* Responsividade para o bot de ajuda */
        @media (max-width: 768px) {
            .help-bot-container {
                bottom: 20px;
                right: 20px;
            }
            
            .help-bot-panel {
                width: 280px;
                right: 0;
                max-height: 80vh;
            }
            
            .help-bot-body {
                max-height: 60vh;
            }
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        :root {
            --primary-color: #004466;
            --secondary-color: #0077aa;
            --accent-color: #009dcf;
            --light-bg: #e6f2f7;
            --white: #ffffff;
            --gray: #f5f5f5;
            --dark-gray: #333333;
            --border-color: #dddddd;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            
            /* Cores para o balanço patrimonial */
            --ativos-color: #004466;
            --ativos-bg: rgba(0, 68, 102, 0.05);
            --ativos-border: rgba(0, 68, 102, 0.2);
            --passivos-color: #8b0000;
            --passivos-bg: rgba(139, 0, 0, 0.05);
            --passivos-border: rgba(139, 0, 0, 0.2);
            --pl-color: #006400;
            --pl-bg: rgba(0, 100, 0, 0.05);
            --pl-border: rgba(0, 100, 0, 0.2);
        }

        /* Modo de alto contraste */
        body.high-contrast {
            --primary-color: #000000;
            --secondary-color: #333333;
            --accent-color: #0066CC;
            --light-bg: #FFFFFF;
            --white: #FFFFFF;
            --gray: #EEEEEE;
            --dark-gray: #000000;
            --border-color: #000000;
            --success: #006600;
            --danger: #CC0000;
            --warning: #CC6600;
            
            /* Cores para o balanço patrimonial em alto contraste */
            --ativos-color: #0000FF;
            --ativos-bg: #FFFFFF;
            --ativos-border: #0000FF;
            --passivos-color: #CC0000;
            --passivos-bg: #FFFFFF;
            --passivos-border: #CC0000;
            --pl-color: #006600;
            --pl-bg: #FFFFFF;
            --pl-border: #006600;
        }

        html, body {
            height: 100%;
            width: 100%;
            overflow: hidden;
        }

        /* LOGIN PAGE STYLES */
        body.login-page {
            overflow: hidden;
            background-color: #e6f2f7;
            height: 100vh;
        }
        
        .wave-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        .wave-top {
            position: absolute;
            top: 0;
            left: 0;
            width: 40%;
            height: 85vh;
            background: linear-gradient(135deg, #004466, #006699);
            border-radius: 0 0 300px 0;
            animation: slideInLeft 1.5s ease-in-out forwards;
        }
        
        .wave-middle {
            position: absolute;
            top: 15vh;
            left: 0;
            width: 30%;
            height: 70vh;
            background: linear-gradient(135deg, #0077aa, #009dcf);
            border-radius: 0 300px 300px 0;
            animation: slideInLeft 1.8s ease-in-out forwards;
        }
        
        .wave-bottom {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60%;
            height: 40vh;
            background: linear-gradient(135deg, #006699, #0088cc);
            border-radius: 0 300px 0 0;
            animation: slideUpLeft 1.5s ease-in-out forwards;
        }
        
        .accent-circle {
            position: absolute;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background-color: rgba(0, 119, 170, 0.3);
            z-index: -1;
        }
        
        .accent-circle:nth-child(1) {
            bottom: 20%;
            left: 10%;
            animation: fadeIn 2s ease-in-out forwards;
        }
        
        .accent-circle:nth-child(2) {
            top: 15%;
            left: 20%;
            width: 150px;
            height: 150px;
            animation: fadeIn 2.5s ease-in-out forwards;
        }
        
        .login-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin-left: 45%;
            width: 55%;
            opacity: 0;
            animation: fadeIn 1s ease-in-out 1s forwards;
        }
        
        .login-logo-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 60px;
        }
        
        .login-logo-title {
            font-size: 5rem;
            font-weight: bold;
            color: #004466;
            letter-spacing: 2px;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 68, 102, 0.1);
        }
        
        .login-tagline {
            font-size: 1.5rem;
            color: #004466;
            font-weight: 500;
        }
        
        .login-btn {
            background-color: #004466;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 68, 102, 0.3);
        }
        
        .login-btn:hover {
            background-color: #0077aa;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 68, 102, 0.4);
        }
        
        .login-form {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
            width: 350px;
            text-align: center;
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.4s ease;
        }
        
        .login-form.active {
            display: block;
            animation: formAppear 0.5s ease forwards;
        }
        
        .form-title {
            color: #004466;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #004466;
            font-weight: 500;
        }
        
        .input-group input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border 0.3s ease;
        }
        
        .input-group input:focus {
            border-color: #0077aa;
            outline: none;
        }
        
        .submit-btn {
            background-color: #004466;
            color: white;
            border: none;
            padding: 12px 0;
            width: 100%;
            font-size: 1.1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }
        
        .submit-btn:hover {
            background-color: #0077aa;
        }
        
        .back-btn {
            color: #004466;
            background: none;
            border: none;
            margin-top: 15px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        /* SISTEMA INTERIOR STYLES */
        body.dashboard-page {
            background-color: var(--light-bg);
            height: 100vh;
            overflow: hidden;
        }
        
        #dashboardPage {
            display: none;
            height: 100vh;
            width: 100%;
            overflow: hidden;
        }
        
        #dashboardPage.active {
            display: flex;
        }
        
        .sidebar {
            width: 250px;
            height: 100vh;
            background: linear-gradient(145deg, var(--primary-color), var(--secondary-color));
            color: var(--white);
            transition: all 0.3s ease;
            box-shadow: 4px 0 10px rgba(0, 0, 0, 0.1);
            z-index: 10;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }
        
        .logo-container {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo-title {
            font-size: 2rem;
            font-weight: bold;
            color: var(--white);
            letter-spacing: 2px;
        }
        
        .tagline {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .nav-menu {
            padding: 20px 0;
            flex-grow: 1;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
        }
        
        .nav-menu::-webkit-scrollbar {
            width: 5px;
        }
        
        .nav-menu::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .nav-menu::-webkit-scrollbar-thumb {
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
        }
        
        .menu-category {
            padding: 10px 20px;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.5);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .nav-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .nav-item:hover, .nav-item.active {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .nav-item i {
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .user-info {
            padding: 15px 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
        }
        
        .user-name {
            font-weight: 500;
        }
        
        .user-role {
            font-size: 0.8rem;
            opacity: 0.7;
        }
        
        .logout-btn {
            margin-left: auto;
            background: none;
            border: none;
            color: var(--white);
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }
        
        .logout-btn:hover {
            opacity: 1;
        }
        
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            height: 100vh;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .section {
            display: none;
            animation: fadeIn 0.5s ease forwards;
            height: auto;
        }
        
        .section.active {
            display: block;
        }
        
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .welcome-message h1 {
            color: var(--primary-color);
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .welcome-message p {
            color: var(--dark-gray);
            opacity: 0.7;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 10px 15px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn i {
            margin-right: 5px;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: var(--white);
        }
        
        .btn-primary:hover {
            background-color: var(--secondary-color);
        }
        
        .btn-success {
            background-color: var(--success);
            color: var(--white);
        }
        
        .btn-success:hover {
            opacity: 0.9;
        }
        
        .btn-danger {
            background-color: var(--danger);
            color: var(--white);
        }
        
        .btn-danger:hover {
            opacity: 0.9;
        }
        
        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background-color: var(--white);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .card-title {
            color: var(--primary-color);
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .card-icon {
            width: 40px;
            height: 40px;
            background-color: var(--light-bg);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
        }
        
        .card-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark-gray);
            margin-bottom: 5px;
        }
        
        .card-description {
            font-size: 0.85rem;
            color: var(--dark-gray);
            opacity: 0.7;
        }
        
        .data-container {
            background-color: var(--white);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .container-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .container-title {
            color: var(--primary-color);
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .table-responsive {
            overflow-x: auto;
            width: 100%;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        thead th {
            background-color: var(--light-bg);
            padding: 12px 15px;
            text-align: left;
            font-weight: 600;
            color: var(--primary-color);
            border-bottom: 2px solid var(--border-color);
        }
        
        tbody td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
            color: var(--dark-gray);
        }
        
        tbody tr:hover {
            background-color: rgba(230, 242, 247, 0.3);
        }
        
        .status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            display: inline-block;
        }
        
        .status-success {
            background-color: rgba(40, 167, 69, 0.1);
            color: var(--success);
        }
        
        .status-danger {
            background-color: rgba(220, 53, 69, 0.1);
            color: var(--danger);
        }
        
        .status-warning {
            background-color: rgba(255, 193, 7, 0.1);
            color: var(--warning);
        }
        
        .action-cell {
            text-align: right;
        }
        
        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.2s ease;
            margin-left: 5px;
        }
        
        .action-btn:hover {
            opacity: 1;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--primary-color);
            font-weight: 500;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            transition: border 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            border-color: var(--secondary-color);
            outline: none;
        }
        
        .search-container {
            display: flex;
            margin-bottom: 20px;
        }
        
        .search-container input {
            flex-grow: 1;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px 0 0 8px;
            font-size: 1rem;
            transition: border 0.3s ease;
        }
        
        .search-container input:focus {
            border-color: var(--secondary-color);
            outline: none;
        }
        
        .search-btn {
            background-color: var(--primary-color);
            color: var(--white);
            border: none;
            border-radius: 0 8px 8px 0;
            padding: 0 20px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .search-btn:hover {
            background-color: var(--secondary-color);
        }
        
        .filter-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .filter-select {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 0.9rem;
            color: var(--dark-gray);
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }
        
        .pagination-btn {
            padding: 8px 15px;
            border: 1px solid var(--border-color);
            background-color: var(--white);
            margin: 0 5px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .pagination-btn:hover, .pagination-btn.active {
            background-color: var(--primary-color);
            color: var(--white);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }
        
        .modal.active {
            display: flex;
            animation: fadeIn 0.3s ease forwards;
        }
        
        .modal-content {
            background-color: var(--white);
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            animation: slideUp 0.4s ease forwards;
        }
        
        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            color: var(--primary-color);
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--dark-gray);
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }
        
        .close-modal:hover {
            opacity: 1;
        }
        
        .modal-body {
            padding: 20px;
            max-height: 70vh;
            overflow-y: auto;
        }
        
        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .chart-container {
            width: 100%;
            height: 300px;
            margin-bottom: 20px;
        }

        /* Estilos para o balanço patrimonial */
        .balance-sheet {
            width: 100%;
        }

        .balance-sheet-column {
            padding: 20px;
            border-radius: 10px;
            background-color: var(--white);
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .balance-sheet-column:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
        }

        .balance-sheet-header {
            font-weight: 600;
            padding-bottom: 15px;
            margin-bottom: 20px;
            font-size: 1.2rem;
            text-align: center;
            position: relative;
        }
        
        .balance-sheet-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            border-radius: 3px;
        }
        
        .ativos-header {
            color: var(--ativos-color);
        }
        
        .ativos-header::after {
            background-color: var(--ativos-color);
        }
        
        .passivos-header {
            color: var(--passivos-color);
        }
        
        .passivos-header::after {
            background-color: var(--passivos-color);
        }

        .balance-sheet-section {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .ativos-section {
            background-color: var(--ativos-bg);
            border-left: 3px solid var(--ativos-border);
        }
        
        .passivos-section {
            background-color: var(--passivos-bg);
            border-left: 3px solid var(--passivos-border);
        }
        
        .pl-section {
            background-color: var(--pl-bg);
            border-left: 3px solid var(--pl-border);
        }

        .balance-sheet-section-title {
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--dark-gray);
            font-size: 1.05rem;
            display: flex;
            align-items: center;
        }
        
        .ativos-title {
            color: var(--ativos-color);
        }
        
        .passivos-title {
            color: var(--passivos-color);
        }
        
        .pl-title {
            color: var(--pl-color);
        }
        
        .balance-sheet-section-title i {
            margin-right: 8px;
            font-size: 1.2rem;
        }

        .balance-sheet-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px dotted var(--border-color);
            transition: background-color 0.2s ease;
        }
        
        .balance-sheet-item:hover {
            background-color: rgba(0, 0, 0, 0.02);
        }

        .balance-sheet-item:last-child {
            border-bottom: none;
        }
        
        .balance-item-name {
            display: flex;
            align-items: center;
            font-size: 0.95rem;
        }
        
        .balance-item-value {
            font-weight: 500;
            font-size: 0.95rem;
        }
        
        .ativos-value {
            color: var(--ativos-color);
        }
        
        .passivos-value {
            color: var(--passivos-color);
        }
        
        .pl-value {
            color: var(--pl-color);
        }

        .balance-sheet-total {
            font-weight: 600;
            border-top: 2px solid var(--border-color);
            padding-top: 15px;
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
            font-size: 1.1rem;
        }
        
        .total-ativos {
            color: var(--ativos-color);
        }
        
        .total-passivos {
            color: var(--passivos-color);
        }
        
        .balance-period-container {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .balance-period-btn {
            padding: 8px 16px;
            margin: 0 5px;
            background-color: var(--light-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .balance-period-btn.active {
            background-color: var(--primary-color);
            color: var(--white);
            border-color: var(--primary-color);
        }
        
        .balance-sheet-loading {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 10px;
            z-index: 5;
            display: none;
        }
        
        .balance-sheet-loading.active {
            display: flex;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--light-bg);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .progress-bar-container {
            width: 100%;
            height: 6px;
            background-color: #e0e0e0;
            border-radius: 3px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            border-radius: 3px;
            transition: width 0.6s ease-in-out;
        }
        
        .progress-ativos {
            background-color: var(--ativos-color);
        }
        
        .progress-passivos {
            background-color: var(--passivos-color);
        }
        
        .progress-pl {
            background-color: var(--pl-color);
        }

        /* Estilos para formulários */
        .mt-4 {
            margin-top: 20px;
        }

        /* Configurações de acessibilidade */
        .settings-btn-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .settings-btn {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            background-color: var(--white);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .settings-btn.active {
            background-color: var(--primary-color);
            color: var(--white);
        }

        /* Adicionando estilos para abas */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 20px;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .tab.active {
            border-bottom: 2px solid var(--primary-color);
            color: var(--primary-color);
            font-weight: 500;
        }
        
        /* Notificações */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background-color: var(--primary-color);
            color: var(--white);
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.3s ease;
        }
        
        .notification.active {
            transform: translateX(0);
        }

        /* Vista de Vendas e Recibo Modais */
        .sale-details-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .sale-detail-group {
            margin-bottom: 15px;
        }

        .sale-detail-group h4 {
            color: var(--primary-color);
            margin-bottom: 5px;
            font-size: 1rem;
        }

        .sale-detail-group p {
            color: var(--dark-gray);
            font-size: 0.95rem;
        }

        .sale-products-table {
            margin-top: 20px;
            width: 100%;
            border-collapse: collapse;
        }

        .sale-products-table th {
            background-color: var(--light-bg);
            padding: 10px;
            text-align: left;
            color: var(--primary-color);
        }

        .sale-products-table td {
            padding: 8px 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .sale-total-row {
            font-weight: 600;
            border-top: 2px solid var(--border-color);
        }

        /* Estilo para o recibo */
        .receipt {
            background-color: white;
            max-width: 380px;
            margin: 0 auto;
            padding: 20px;
            font-family: 'Courier New', monospace;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        .receipt-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #ccc;
        }

        .receipt-header h3 {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .receipt-header p {
            font-size: 0.9rem;
            margin: 2px 0;
        }

        .receipt-info {
            margin-bottom: 15px;
            font-size: 0.9rem;
        }

        .receipt-info p {
            margin: 3px 0;
            display: flex;
            justify-content: space-between;
        }

        .receipt-items {
            border-top: 1px dashed #ccc;
            border-bottom: 1px dashed #ccc;
            padding: 10px 0;
            margin-bottom: 15px;
        }

        .receipt-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .receipt-item-name {
            flex-grow: 1;
        }

        .receipt-item-qty {
            width: 30px;
            text-align: center;
        }

        .receipt-item-price {
            width: 80px;
            text-align: right;
        }

        .receipt-totals {
            margin-bottom: 15px;
        }

        .receipt-total {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            margin: 3px 0;
        }

        .receipt-total.grand-total {
            font-weight: bold;
            font-size: 1rem;
            border-top: 1px dashed #ccc;
            padding-top: 5px;
            margin-top: 5px;
        }

        .receipt-footer {
            text-align: center;
            font-size: 0.85rem;
            margin-top: 15px;
        }

        .receipt-barcode {
            text-align: center;
            margin: 15px 0;
            font-family: 'Libre Barcode 39', cursive;
            font-size: 2.5rem;
        }

        .print-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 15px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            transition: all 0.3s ease;
        }

        .print-btn:hover {
            background-color: var(--secondary-color);
        }

        .print-btn i {
            margin-right: 5px;
            font-size: 1.1rem;
        }

        /* Estilos adicionados para a funcionalidade de seleção de linhas na tabela */
        tr.selected {
            background-color: rgba(255, 193, 7, 0.2) !important;
            font-weight: 500;
        }
        
        /* Estilo para relatórios gerados */
        .report-container {
            background-color: var(--white);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            display: none;
        }
        
        .report-container.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .report-title {
            color: var(--primary-color);
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .report-date {
            color: var(--dark-gray);
            font-size: 0.9rem;
        }
        
        .report-summary {
            margin-bottom: 20px;
            padding: 15px;
            background-color: var(--light-bg);
            border-radius: 8px;
        }
        
        .report-summary-title {
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 1.1rem;
            color: var(--primary-color);
        }
        
        .report-summary-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .report-summary-item {
            background-color: var(--white);
            padding: 12px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .report-summary-item-label {
            font-size: 0.8rem;
            color: var(--dark-gray);
            margin-bottom: 5px;
        }
        
        .report-summary-item-value {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-color);
        }

        /* ANIMATIONS */
        @keyframes slideInLeft {
            from {
                transform: translateX(-100%);
            }
            to {
                transform: translateX(0);
            }
        }
        
        @keyframes slideUpLeft {
            from {
                transform: translateY(100%);
            }
            to {
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes formAppear {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        /* RESPONSIVIDADE */
        @media (max-width: 1200px) {
            .login-content {
                margin-left: 40%;
                width: 60%;
            }
        }
        
        @media (max-width: 768px) {
            .wave-top {
                width: 100%;
                height: 30vh;
                border-radius: 0 0 50% 50%;
            }
            
            .wave-middle, .wave-bottom {
                display: none;
            }
            
            .login-content {
                margin-left: 0;
                width: 100%;
                padding: 0 20px;
            }
            
            .login-logo-title {
                font-size: 3.5rem;
            }
            
            /* Sistema interior */
            .sidebar {
                width: 70px;
                overflow: hidden;
            }
            
            .sidebar.expanded {
                width: 250px;
            }
            
            .logo-container {
                padding: 15px 5px;
            }
            
            .logo-title {
                font-size: 1.5rem;
            }
            
            .tagline {
                display: none;
            }
            
            .nav-item span, .menu-category, .user-name, .user-role {
                display: none;
            }
            
            .sidebar.expanded .nav-item span, 
            .sidebar.expanded .menu-category, 
            .sidebar.expanded .user-name, 
            .sidebar.expanded .user-role {
                display: inline-block;
            }
            
            .main-content {
                padding: 15px;
                width: calc(100% - 70px);
            }
            
            .dashboard-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .action-buttons {
                width: 100%;
            }
            
            .btn {
                flex: 1;
            }
            
            .card-container {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Highlight for search results */
        .highlight {
            background-color: rgba(255, 193, 7, 0.3);
            padding: 2px;
            border-radius: 3px;
        }
    </style>
  </head>
  <body class="login-page">
    <div id="loginPage">
        <div class="wave-container">
            <div class="wave-top"></div>
            <div class="wave-middle"></div>
            <div class="wave-bottom"></div>
            <div class="accent-circle"></div>
            <div class="accent-circle"></div>
        </div>

        <div class="login-content">
            <div class="login-logo-container">
                <h1 class="login-logo-title">NEWBOX</h1>
                <p class="login-tagline">O SISTEMA PRO SEU NEGÓCIO</p>
            </div>
            
            <button class="login-btn" id="loginBtn">Entrar</button>
            
            <div class="login-form" id="loginForm">
                <h2 class="form-title">Entre no NewBox</h2>
                <form id="loginFormElement">
                    <div class="input-group">
                        <label for="username">Usuário</label>
                        <input type="text" id="username">
                    </div>
                    <button type="submit" class="submit-btn">Entrar</button>
                </form>
                <button class="back-btn" id="backBtn">Voltar</button>
            </div>
        </div>
    </div>

    <!-- SISTEMA INTERIOR -->
    <div id="dashboardPage">
        <div class="sidebar" id="sidebar">
            <div class="logo-container">
                <h1 class="logo-title">NEWBOX</h1>
                <p class="tagline">O SISTEMA PRO SEU NEGÓCIO</p>
            </div>
            
            <div class="nav-menu">
                <p class="menu-category">Principal</p>
                <div class="nav-item active" data-section="dashboard">
                    <i class="material-icons">dashboard</i>
                    <span>Dashboard</span>
                </div>
                
                <p class="menu-category">Estoque</p>
                <div class="nav-item" data-section="produtos">
                    <i class="material-icons">inventory_2</i>
                    <span>Produtos</span>
                </div>
                <div class="nav-item" data-section="categorias">
                    <i class="material-icons">category</i>
                    <span>Categorias</span>
                </div>
                <div class="nav-item" data-section="movimentacoes">
                    <i class="material-icons">sync_alt</i>
                    <span>Movimentações</span>
                </div>
                
                <p class="menu-category">Financeiro</p>
                <div class="nav-item" data-section="vendas">
                    <i class="material-icons">point_of_sale</i>
                    <span>Vendas</span>
                </div>
                <div class="nav-item" data-section="compras">
                    <i class="material-icons">shopping_cart</i>
                    <span>Compras</span>
                </div>
                <div class="nav-item" data-section="relatorios">
                    <i class="material-icons">bar_chart</i>
                    <span>Relatórios</span>
                </div>
                
                <p class="menu-category">Cadastros</p>
                <div class="nav-item" data-section="clientes">
                    <i class="material-icons">person</i>
                    <span>Clientes</span>
                </div>
                <div class="nav-item" data-section="fornecedores">
                    <i class="material-icons">business</i>
                    <span>Fornecedores</span>
                </div>
                <div class="nav-item" data-section="usuarios">
                    <i class="material-icons">people</i>
                    <span>Usuários</span>
                </div>
                
                <p class="menu-category">Sistema</p>
                <div class="nav-item" data-section="configuracoes">
                    <i class="material-icons">settings</i>
                    <span>Configurações</span>
                </div>
            </div>
            
            <div class="user-info">
                <div class="user-avatar">
                    <i class="material-icons">person</i>
                </div>
                <div>
                    <div class="user-name" id="userDisplayName">Usuário</div>
                    <div class="user-role">Administrador</div>
                </div>
                <button class="logout-btn" id="logoutBtn">
                    <i class="material-icons">logout</i>
                </button>
            </div>
        </div>
        
        <div class="main-content">
            <!-- Dashboard Section -->
            <div class="section active" id="dashboard">
                <div class="dashboard-header">
                    <div class="welcome-message">
                        <h1>Bem-vindo ao NewBox, <span id="welcomeUserName">Usuário</span>!</h1>
                        <p>Visão geral da sua padaria</p>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" id="novaVendaBtn"><i class="material-icons">add</i> Nova Venda</button>
                        <button class="btn btn-success" id="novaCompraBtn"><i class="material-icons">add_shopping_cart</i> Nova Compra</button>
                    </div>
                </div>
                
                <div class="card-container">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Vendas Hoje</h3>
                            <div class="card-icon">
                                <i class="material-icons">point_of_sale</i>
                            </div>
                        </div>
                        <div class="card-value">R$ 2.789,50</div>
                        <div class="card-description">+15% em relação a ontem</div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Produtos em Baixa</h3>
                            <div class="card-icon">
                                <i class="material-icons">warning</i>
                            </div>
                        </div>
                        <div class="card-value">8</div>
                        <div class="card-description">Produtos precisam de reposição</div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Pedidos Pendentes</h3>
                            <div class="card-icon">
                                <i class="material-icons">hourglass_empty</i>
                            </div>
                        </div>
                        <div class="card-value">12</div>
                        <div class="card-description">Aguardando preparação</div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Clientes Hoje</h3>
                            <div class="card-icon">
                                <i class="material-icons">people</i>
                            </div>
                        </div>
                        <div class="card-value">87</div>
                        <div class="card-description">+23% em relação a ontem</div>
                    </div>
                </div>
                
                <div class="data-container">
                    <div class="container-header">
                        <h3 class="container-title">Vendas Recentes</h3>
                        <button class="btn btn-primary" id="verTodasVendasBtn">Ver Todas</button>
                    </div>
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Cliente</th>
                                    <th>Produtos</th>
                                    <th>Valor</th>
                                    <th>Status</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>5874</td>
                                    <td>Maria Silva</td>
                                    <td>Pão Francês, Bolo de Chocolate</td>
                                    <td>R$ 42,30</td>
                                    <td><span class="status status-success">Concluído</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn view-sale-btn" data-id="5874"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn receipt-btn" data-id="5874"><i class="material-icons">receipt</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>5873</td>
                                    <td>João Santos</td>
                                    <td>Torta de Frango, Refrigerante</td>
                                    <td>R$ 68,75</td>
                                    <td><span class="status status-warning">Preparando</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn view-sale-btn" data-id="5873"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn receipt-btn" data-id="5873"><i class="material-icons">receipt</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>5872</td>
                                    <td>Ana Oliveira</td>
                                    <td>Pão de Queijo (12), Café</td>
                                    <td>R$ 28,50</td>
                                    <td><span class="status status-success">Concluído</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn view-sale-btn" data-id="5872"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn receipt-btn" data-id="5872"><i class="material-icons">receipt</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>5871</td>
                                    <td>Pedro Costa</td>
                                    <td>Bolo de Morango, Suco Natural</td>
                                    <td>R$ 52,00</td>
                                    <td><span class="status status-danger">Cancelado</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn view-sale-btn" data-id="5871"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn receipt-btn" data-id="5871"><i class="material-icons">receipt</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>5870</td>
                                    <td>Lucia Ferreira</td>
                                    <td>Pão Integral, Queijo Minas</td>
                                    <td>R$ 35,20</td>
                                    <td><span class="status status-success">Concluído</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn view-sale-btn" data-id="5870"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn receipt-btn" data-id="5870"><i class="material-icons">receipt</i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="data-container">
                    <div class="container-header">
                        <h3 class="container-title">Balanço Patrimonial</h3>
                        <div class="filter-container">
                            <select class="filter-select" id="balancoPeriodoSelect">
                                <option value="atual">Atual</option>
                                <option value="mensal">Mensal</option>
                                <option value="anual">Anual</option>
                            </select>
                        </div>
                    </div>
                    <div class="balance-period-container">
                        <button class="balance-period-btn active" data-period="atual">Atual</button>
                        <button class="balance-period-btn" data-period="mensal">Mensal</button>
                        <button class="balance-period-btn" data-period="anual">Anual</button>
                    </div>
                    <div class="balance-sheet" id="balanceSheet">
                        <div class="balance-sheet-loading" id="balanceLoading">
                            <div class="loading-spinner"></div>
                        </div>
                        <div style="display: flex; flex-wrap: wrap; gap: 20px; position: relative;">
                            <!-- Coluna Ativos -->
                            <div class="balance-sheet-column" style="flex: 1; min-width: 300px;">
                                <div class="balance-sheet-header ativos-header">ATIVOS</div>
                                
                                <!-- Ativos Circulantes -->
                                <div class="balance-sheet-section ativos-section">
                                    <div class="balance-sheet-section-title ativos-title">
                                        <i class="material-icons">account_balance</i>
                                        Ativos Circulantes
                                    </div>
                                    
                                    <div class="balance-sheet-item">
                                        <div class="balance-item-name">Caixa e Equivalentes</div>
                                        <div class="balance-item-value ativos-value" data-balanco="caixa">R$ 45.750,00</div>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar progress-ativos" id="progressCaixa" style="width: 40%"></div>
                                    </div>
                                    
                                    <div class="balance-sheet-item">
                                        <div class="balance-item-name">Contas a Receber</div>
                                        <div class="balance-item-value ativos-value" data-balanco="contasReceber">R$ 23.680,50</div>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar progress-ativos" id="progressContasReceber" style="width: 20%"></div>
                                    </div>
                                    
                                    <div class="balance-sheet-item">
                                        <div class="balance-item-name">Estoques</div>
                                        <div class="balance-item-value ativos-value" data-balanco="estoques">R$ 38.420,75</div>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar progress-ativos" id="progressEstoques" style="width: 33%"></div>
                                    </div>
                                    
                                    <div class="balance-sheet-item">
                                        <div class="balance-item-name">Adiantamentos</div>
                                        <div class="balance-item-value ativos-value" data-balanco="adiantamentos">R$ 5.200,00</div>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar progress-ativos" id="progressAdiantamentos" style="width: 5%"></div>
                                    </div>
                                </div>
                                
                                <!-- Ativos Não Circulantes -->
                                <div class="balance-sheet-section ativos-section">
                                    <div class="balance-sheet-section-title ativos-title">
                                        <i class="material-icons">business</i>
                                        Ativos Não Circulantes
                                    </div>
                                    
                                    <div class="balance-sheet-item">
                                        <div class="balance-item-name">Investimentos</div>
                                        <div class="balance-item-value ativos-value" data-balanco="investimentos">R$ 75.000,00</div>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar progress-ativos" id="progressInvestimentos" style="width: 65%"></div>
                                    </div>
                                    
                                    <div class="balance-sheet-item">
                                        <div class="balance-item-name">Imobilizado</div>
                                        <div class="balance-item-value ativos-value" data-balanco="imobilizado">R$ 120.500,00</div>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar progress-ativos" id="progressImobilizado" style="width: 90%"></div>
                                    </div>
                                    
                                    <div class="balance-sheet-item">
                                        <div class="balance-item-name">Intangível</div>
                                        <div class="balance-item-value ativos-value" data-balanco="intangivel">R$ 15.750,00</div>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar progress-ativos" id="progressIntangivel" style="width: 14%"></div>
                                    </div>
                                </div>
                                
                                <!-- Total de Ativos -->
                                <div class="balance-sheet-total">
                                    <div>Total de Ativos</div>
                                    <div class="total-ativos" data-balanco="totalAtivos">R$ 324.301,25</div>
                                </div>
                            </div>
                            
                            <!-- Coluna Passivos + PL -->
                            <div class="balance-sheet-column" style="flex: 1; min-width: 300px;">
                                <div class="balance-sheet-header passivos-header">PASSIVOS E PATRIMÔNIO LÍQUIDO</div>
                                
                                <!-- Passivos Circulantes -->
                                <div class="balance-sheet-section passivos-section">
                                    <div class="balance-sheet-section-title passivos-title">
                                        <i class="material-icons">payments</i>
                                        Passivos Circulantes
                                    </div>
                                    
                                    <div class="balance-sheet-item">
                                        <div class="balance-item-name">Contas a Pagar</div>
                                        <div class="balance-item-value passivos-value" data-balanco="contasPagar">R$ 18.640,30</div>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar progress-passivos" id="progressContasPagar" style="width: 20%"></div>
                                    </div>
                                    
                                    <div class="balance-sheet-item">
                                        <div class="balance-item-name">Empréstimos de Curto Prazo</div>
                                        <div class="balance-item-value passivos-value" data-balanco="emprestimosCP">R$ 35.000,00</div>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar progress-passivos" id="progressEmprestimosCP" style="width: 38%"></div>
                                    </div>
                                    
                                    <div class="balance-sheet-item">
                                        <div class="balance-item-name">Salários a Pagar</div>
                                        <div class="balance-item-value passivos-value" data-balanco="salariosPagar">R$ 22.750,00</div>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar progress-passivos" id="progressSalariosPagar" style="width: 25%"></div>
                                    </div>
                                    
                                    <div class="balance-sheet-item">
                                        <div class="balance-item-name">Impostos a Recolher</div>
                                        <div class="balance-item-value passivos-value" data-balanco="impostos">R$ 12.850,45</div>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar progress-passivos" id="progressImpostos" style="width: 14%"></div>
                                    </div>
                                </div>
                                
                                <!-- Passivos Não Circulantes -->
                                <div class="balance-sheet-section passivos-section">
                                    <div class="balance-sheet-section-title passivos-title">
                                        <i class="material-icons">credit_card</i>
                                        Passivos Não Circulantes
                                    </div>
                                    
                                    <div class="balance-sheet-item">
                                        <div class="balance-item-name">Empréstimos de Longo Prazo</div>
                                        <div class="balance-item-value passivos-value" data-balanco="emprestimosLP">R$ 85.000,00</div>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar progress-passivos" id="progressEmprestimosLP" style="width: 90%"></div>
                                    </div>
                                    
                                    <div class="balance-sheet-item">
                                        <div class="balance-item-name">Provisões para Contingências</div>
                                        <div class="balance-item-value passivos-value" data-balanco="provisoes">R$ 25.300,00</div>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar progress-passivos" id="progressProvisoes" style="width: 27%"></div>
                                    </div>
                                </div>
                                
                                <!-- Patrimônio Líquido -->
                                <div class="balance-sheet-section pl-section">
                                    <div class="balance-sheet-section-title pl-title">
                                        <i class="material-icons">account_balance_wallet</i>
                                        Patrimônio Líquido
                                    </div>
                                    
                                    <div class="balance-sheet-item">
                                        <div class="balance-item-name">Capital Social</div>
                                        <div class="balance-item-value pl-value" data-balanco="capitalSocial">R$ 100.000,00</div>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar progress-pl" id="progressCapitalSocial" style="width: 80%"></div>
                                    </div>
                                    
                                    <div class="balance-sheet-item">
                                        <div class="balance-item-name">Lucros Acumulados</div>
                                        <div class="balance-item-value pl-value" data-balanco="lucrosAcumulados">R$ 24.760,50</div>
                                    </div>
                                    <div class="progress-bar-container">
                                        <div class="progress-bar progress-pl" id="progressLucrosAcumulados" style="width: 20%"></div>
                                    </div>
                                </div>
                                
                                <!-- Total de Passivos + PL -->
                                <div class="balance-sheet-total">
                                    <div>Total de Passivos + PL</div>
                                    <div class="total-passivos" data-balanco="totalPassivos">R$ 324.301,25</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Produtos Section -->
            <div class="section" id="produtos">
                <div class="dashboard-header">
                    <div class="welcome-message">
                        <h1>Produtos</h1>
                        <p>Gerencie o catálogo de produtos da sua padaria</p>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" id="novoProdutoBtn"><i class="material-icons">add</i> Novo Produto</button>
                    </div>
                </div>
                
                <div class="data-container">
                    <div class="search-container">
                        <input type="text" placeholder="Buscar produtos..." id="produtosSearchInput">
                        <button class="search-btn"><i class="material-icons">search</i></button>
                    </div>
                    <div class="filter-container">
                        <select class="filter-select" id="categoriaFilter">
                            <option value="todos">Todas as Categorias</option>
                            <option value="paes">Pães</option>
                            <option value="bolos">Bolos</option>
                            <option value="salgados">Salgados</option>
                            <option value="bebidas">Bebidas</option>
                        </select>
                        <select class="filter-select" id="estoqueFilter">
                            <option value="todos">Estoque - Todos</option>
                            <option value="em_estoque">Em Estoque</option>
                            <option value="baixo_estoque">Baixo Estoque</option>
                            <option value="sem_estoque">Sem Estoque</option>
                        </select>
                    </div>
                    <div class="table-responsive">
                        <table id="produtosTable">
                            <thead>
                                <tr>
                                    <th>Código</th>
                                    <th>Nome</th>
                                    <th>Categoria</th>
                                    <th>Preço</th>
                                    <th>Estoque</th>
                                    <th>Status</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>001</td>
                                    <td>Pão Francês</td>
                                    <td>Pães</td>
                                    <td>R$ 0,75</td>
                                    <td>150</td>
                                    <td><span class="status status-success">Em Estoque</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn edit-product-btn" data-id="001"><i class="material-icons">edit</i></button>
                                        <button class="action-btn delete-product-btn" data-id="001"><i class="material-icons">delete</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>002</td>
                                    <td>Bolo de Chocolate</td>
                                    <td>Bolos</td>
                                    <td>R$ 35,00</td>
                                    <td>8</td>
                                    <td><span class="status status-warning">Baixo Estoque</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn edit-product-btn" data-id="002"><i class="material-icons">edit</i></button>
                                        <button class="action-btn delete-product-btn" data-id="002"><i class="material-icons">delete</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>003</td>
                                    <td>Pão de Queijo</td>
                                    <td>Salgados</td>
                                    <td>R$ 2,50</td>
                                    <td>45</td>
                                    <td><span class="status status-success">Em Estoque</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn edit-product-btn" data-id="003"><i class="material-icons">edit</i></button>
                                        <button class="action-btn delete-product-btn" data-id="003"><i class="material-icons">delete</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>004</td>
                                    <td>Café Expresso</td>
                                    <td>Bebidas</td>
                                    <td>R$ 5,00</td>
                                    <td>0</td>
                                    <td><span class="status status-danger">Sem Estoque</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn edit-product-btn" data-id="004"><i class="material-icons">edit</i></button>
                                        <button class="action-btn delete-product-btn" data-id="004"><i class="material-icons">delete</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>005</td>
                                    <td>Croissant</td>
                                    <td>Pães</td>
                                    <td>R$ 6,50</td>
                                    <td>12</td>
                                    <td><span class="status status-success">Em Estoque</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn edit-product-btn" data-id="005"><i class="material-icons">edit</i></button>
                                        <button class="action-btn delete-product-btn" data-id="005"><i class="material-icons">delete</i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="pagination">
                        <button class="pagination-btn" id="prevPageBtn"><i class="material-icons">chevron_left</i></button>
                        <button class="pagination-btn active" data-page="1">1</button>
                        <button class="pagination-btn" data-page="2">2</button>
                        <button class="pagination-btn" data-page="3">3</button>
                        <button class="pagination-btn" id="nextPageBtn"><i class="material-icons">chevron_right</i></button>
                    </div>
                </div>
            </div>
            
            <!-- Categorias Section -->
            <div class="section" id="categorias">
                <div class="dashboard-header">
                    <div class="welcome-message">
                        <h1>Categorias</h1>
                        <p>Gerencie categorias de produtos para seu inventário</p>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" id="novaCategoriaBtn"><i class="material-icons">add</i> Nova Categoria</button>
                    </div>
                </div>
                <div class="data-container">
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nome</th>
                                    <th>Produtos</th>
                                    <th>Status</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>Pães</td>
                                    <td>15</td>
                                    <td><span class="status status-success">Ativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="edit" data-id="1"><i class="material-icons">edit</i></button>
                                        <button class="action-btn" data-action="delete" data-id="1"><i class="material-icons">delete</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>Bolos</td>
                                    <td>8</td>
                                    <td><span class="status status-success">Ativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="edit" data-id="2"><i class="material-icons">edit</i></button>
                                        <button class="action-btn" data-action="delete" data-id="2"><i class="material-icons">delete</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>Salgados</td>
                                    <td>12</td>
                                    <td><span class="status status-success">Ativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="edit" data-id="3"><i class="material-icons">edit</i></button>
                                        <button class="action-btn" data-action="delete" data-id="3"><i class="material-icons">delete</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>4</td>
                                    <td>Bebidas</td>
                                    <td>6</td>
                                    <td><span class="status status-success">Ativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="edit" data-id="4"><i class="material-icons">edit</i></button>
                                        <button class="action-btn" data-action="delete" data-id="4"><i class="material-icons">delete</i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Movimentações Section -->
            <div class="section" id="movimentacoes">
                <div class="dashboard-header">
                    <div class="welcome-message">
                        <h1>Movimentações</h1>
                        <p>Acompanhe entradas e saídas de produtos</p>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" id="novaMovimentacaoBtn"><i class="material-icons">add</i> Nova Movimentação</button>
                    </div>
                </div>
                <div class="data-container">
                    <div class="search-container">
                        <input type="text" placeholder="Buscar movimentações..." id="movimentacoesSearchInput">
                        <button class="search-btn" id="searchMovimentacoesBtn"><i class="material-icons">search</i></button>
                    </div>
                    <div class="filter-container">
                        <select class="filter-select" id="tipoMovimentacaoFilter">
                            <option value="todos">Todos os Tipos</option>
                            <option value="entrada">Entradas</option>
                            <option value="saida">Saídas</option>
                        </select>
                        <input type="date" class="filter-select" id="dataMovimentacaoFilter">
                    </div>
                    <div class="table-responsive">
                        <table id="movimentacoesTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Produto</th>
                                    <th>Tipo</th>
                                    <th>Quantidade</th>
                                    <th>Data</th>
                                    <th>Usuário</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1001</td>
                                    <td>Pão Francês</td>
                                    <td><span class="status status-success">Entrada</span></td>
                                    <td>+200</td>
                                    <td>15/05/2023 08:15</td>
                                    <td>Maria</td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="view" data-id="1001"><i class="material-icons">visibility</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>1000</td>
                                    <td>Bolo de Chocolate</td>
                                    <td><span class="status status-danger">Saída</span></td>
                                    <td>-5</td>
                                    <td>15/05/2023 07:45</td>
                                    <td>João</td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="view" data-id="1000"><i class="material-icons">visibility</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>999</td>
                                    <td>Café Expresso</td>
                                    <td><span class="status status-success">Entrada</span></td>
                                    <td>+30</td>
                                    <td>14/05/2023 18:20</td>
                                    <td>Maria</td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="view" data-id="999"><i class="material-icons">visibility</i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="pagination">
                        <button class="pagination-btn" id="movPrevPageBtn"><i class="material-icons">chevron_left</i></button>
                        <span id="movPageNumbers">
                            <button class="pagination-btn active" data-page="1">1</button>
                            <button class="pagination-btn" data-page="2">2</button>
                            <button class="pagination-btn" data-page="3">3</button>
                        </span>
                        <button class="pagination-btn" id="movNextPageBtn"><i class="material-icons">chevron_right</i></button>
                    </div>
                </div>
            </div>
            
            <!-- Vendas Section -->
            <div class="section" id="vendas">
                <div class="dashboard-header">
                    <div class="welcome-message">
                        <h1>Vendas</h1>
                        <p>Gerencie e acompanhe todas as transações de vendas</p>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" id="novaVendaPageBtn"><i class="material-icons">add</i> Nova Venda</button>
                    </div>
                </div>
                
                <div class="data-container">
                    <div class="search-container">
                        <input type="text" placeholder="Buscar vendas por cliente, produto..." id="vendasSearchInput">
                        <button class="search-btn"><i class="material-icons">search</i></button>
                    </div>
                    <div class="filter-container">
                        <select class="filter-select" id="statusVendaFilter">
                            <option value="todos">Todos os Status</option>
                            <option value="concluido">Concluído</option>
                            <option value="preparando">Preparando</option>
                            <option value="cancelado">Cancelado</option>
                        </select>
                        <input type="date" class="filter-select" id="dataVendaFilter">
                    </div>
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Cliente</th>
                                    <th>Itens</th>
                                    <th>Total</th>
                                    <th>Pagamento</th>
                                    <th>Data</th>
                                    <th>Status</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>5874</td>
                                    <td>Maria Silva</td>
                                    <td>5</td>
                                    <td>R$ 42,30</td>
                                    <td>Cartão de Crédito</td>
                                    <td>16/05/2023 10:15</td>
                                    <td><span class="status status-success">Concluído</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn view-sale-btn" data-id="5874"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn receipt-btn" data-id="5874"><i class="material-icons">receipt</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>5873</td>
                                    <td>João Santos</td>
                                    <td>3</td>
                                    <td>R$ 68,75</td>
                                    <td>Dinheiro</td>
                                    <td>16/05/2023 09:45</td>
                                    <td><span class="status status-warning">Preparando</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn view-sale-btn" data-id="5873"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn receipt-btn" data-id="5873"><i class="material-icons">receipt</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>5872</td>
                                    <td>Ana Oliveira</td>
                                    <td>4</td>
                                    <td>R$ 28,50</td>
                                    <td>Cartão de Débito</td>
                                    <td>15/05/2023 16:30</td>
                                    <td><span class="status status-success">Concluído</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn view-sale-btn" data-id="5872"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn receipt-btn" data-id="5872"><i class="material-icons">receipt</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>5871</td>
                                    <td>Pedro Costa</td>
                                    <td>2</td>
                                    <td>R$ 52,00</td>
                                    <td>Dinheiro</td>
                                    <td>15/05/2023 15:10</td>
                                    <td><span class="status status-danger">Cancelado</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn view-sale-btn" data-id="5871"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn receipt-btn" data-id="5871"><i class="material-icons">receipt</i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="pagination">
                        <button class="pagination-btn" id="vendaPrevPageBtn"><i class="material-icons">chevron_left</i></button>
                        <span id="vendaPageNumbers">
                            <button class="pagination-btn active" data-page="1">1</button>
                            <button class="pagination-btn" data-page="2">2</button>
                            <button class="pagination-btn" data-page="3">3</button>
                        </span>
                        <button class="pagination-btn" id="vendaNextPageBtn"><i class="material-icons">chevron_right</i></button>
                    </div>
                </div>
            </div>
            
            <!-- Compras Section -->
            <div class="section" id="compras">
                <div class="dashboard-header">
                    <div class="welcome-message">
                        <h1>Compras</h1>
                        <p>Gerencie pedidos e compras de fornecedores</p>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" id="novaCompraPageBtn"><i class="material-icons">add</i> Nova Compra</button>
                    </div>
                </div>
                
                <div class="data-container">
                    <div class="search-container">
                        <input type="text" placeholder="Buscar compras por fornecedor, produto..." id="comprasSearchInput">
                        <button class="search-btn" id="searchComprasBtn"><i class="material-icons">search</i></button>
                    </div>
                    <div class="filter-container">
                        <select class="filter-select" id="statusCompraFilter">
                            <option value="todos">Todos os Status</option>
                            <option value="pendente">Pendente</option>
                            <option value="entregue">Entregue</option>
                            <option value="cancelado">Cancelado</option>
                        </select>
                        <input type="date" class="filter-select" id="dataCompraFilter">
                    </div>
                    <div class="table-responsive">
                        <table id="comprasTable">
                            <thead>
                                <tr>
                                    <th>Pedido #</th>
                                    <th>Fornecedor</th>
                                    <th>Itens</th>
                                    <th>Total</th>
                                    <th>Data do Pedido</th>
                                    <th>Data de Entrega</th>
                                    <th>Status</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>PC-2023-001</td>
                                    <td>Distribuidora de Farinhas Ltda</td>
                                    <td>3</td>
                                    <td>R$ 1.250,00</td>
                                    <td>14/05/2023</td>
                                    <td>20/05/2023</td>
                                    <td><span class="status status-warning">Pendente</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="view" data-id="PC-2023-001"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn" data-action="edit" data-id="PC-2023-001"><i class="material-icons">edit</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>PC-2023-002</td>
                                    <td>Açúcar & Cia</td>
                                    <td>5</td>
                                    <td>R$ 780,50</td>
                                    <td>10/05/2023</td>
                                    <td>15/05/2023</td>
                                    <td><span class="status status-success">Entregue</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="view" data-id="PC-2023-002"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn" data-action="edit" data-id="PC-2023-002"><i class="material-icons">edit</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>PC-2023-003</td>
                                    <td>Laticínios do Vale</td>
                                    <td>4</td>
                                    <td>R$ 950,80</td>
                                    <td>08/05/2023</td>
                                    <td>12/05/2023</td>
                                    <td><span class="status status-success">Entregue</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="view" data-id="PC-2023-003"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn" data-action="edit" data-id="PC-2023-003"><i class="material-icons">edit</i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="pagination">
                        <button class="pagination-btn" id="compraPrevPageBtn"><i class="material-icons">chevron_left</i></button>
                        <span id="compraPageNumbers">
                            <button class="pagination-btn active" data-page="1">1</button>
                            <button class="pagination-btn" data-page="2">2</button>
                            <button class="pagination-btn" data-page="3">3</button>
                        </span>
                        <button class="pagination-btn" id="compraNextPageBtn"><i class="material-icons">chevron_right</i></button>
                    </div>
                </div>
            </div>
            
            <!-- Relatórios Section -->
            <div class="section" id="relatorios">
                <div class="dashboard-header">
                    <div class="welcome-message">
                        <h1>Relatórios</h1>
                        <p>Visualize e gere relatórios do negócio</p>
                    </div>
                </div>
                
                <div class="tabs">
                    <div class="tab active" data-tab="mensais">Relatórios Mensais</div>
                    <div class="tab" data-tab="anuais">Relatórios Anuais</div>
                    <div class="tab" data-tab="personalizados">Personalizados</div>
                </div>
                
                <div class="card-container">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Relatório de Vendas</h3>
                            <div class="card-icon">
                                <i class="material-icons">bar_chart</i>
                            </div>
                        </div>
                        <p class="card-description">Acompanhe o desempenho de vendas ao longo do tempo</p>
                        <button class="btn btn-primary mt-4" id="gerarRelatorioVendas">Gerar</button>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Relatório de Estoque</h3>
                            <div class="card-icon">
                                <i class="material-icons">inventory</i>
                            </div>
                        </div>
                        <p class="card-description">Verifique o status atual do inventário</p>
                        <button class="btn btn-primary mt-4" id="gerarRelatorioEstoque">Gerar</button>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Relatório Financeiro</h3>
                            <div class="card-icon">
                                <i class="material-icons">paid</i>
                            </div>
                        </div>
                        <p class="card-description">Visualize receitas e despesas</p>
                        <button class="btn btn-primary mt-4" id="gerarRelatorioFinanceiro">Gerar</button>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Relatório de Clientes</h3>
                            <div class="card-icon">
                                <i class="material-icons">people</i>
                            </div>
                        </div>
                        <p class="card-description">Analise o comportamento dos clientes</p>
                        <button class="btn btn-primary mt-4" id="gerarRelatorioClientes">Gerar</button>
                    </div>
                </div>
                
                <div class="data-container">
                    <div class="container-header">
                        <h3 class="container-title">Relatórios Recentes</h3>
                    </div>
                    <div class="table-responsive">
                        <table id="relatoriosTable">
                            <thead>
                                <tr>
                                    <th>Nome</th>
                                    <th>Tipo</th>
                                    <th>Período</th>
                                    <th>Gerado em</th>
                                    <th>Gerado por</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Relatório de Vendas - Maio 2023</td>
                                    <td>Vendas</td>
                                    <td>Mensal</td>
                                    <td>15/05/2023</td>
                                    <td>Admin</td>
                                    <td class="action-cell">
                                        <button class="action-btn view-report-btn" data-id="1"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn download-report-btn" data-id="1"><i class="material-icons">download</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Relatório de Estoque - Maio 2023</td>
                                    <td>Estoque</td>
                                    <td>Mensal</td>
                                    <td>10/05/2023</td>
                                    <td>Admin</td>
                                    <td class="action-cell">
                                        <button class="action-btn view-report-btn" data-id="2"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn download-report-btn" data-id="2"><i class="material-icons">download</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Relatório Financeiro - Q1 2023</td>
                                    <td>Financeiro</td>
                                    <td>Trimestral</td>
                                    <td>05/04/2023</td>
                                    <td>Admin</td>
                                    <td class="action-cell">
                                        <button class="action-btn view-report-btn" data-id="3"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn download-report-btn" data-id="3"><i class="material-icons">download</i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Container para relatório personalizado -->
                <div class="data-container" id="relatorioPersonalizado" style="display: none;">
                    <div class="container-header">
                        <h3 class="container-title">Relatório Personalizado</h3>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="tipoRelatorioPersonalizado">Tipo de Relatório</label>
                            <select id="tipoRelatorioPersonalizado" class="filter-select">
                                <option value="">Selecione um tipo</option>
                                <option value="vendas">Vendas</option>
                                <option value="estoque">Estoque</option>
                                <option value="financeiro">Financeiro</option>
                                <option value="clientes">Clientes</option>
                                <option value="compras">Compras</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="periodoRelatorioPersonalizado">Período</label>
                            <select id="periodoRelatorioPersonalizado" class="filter-select">
                                <option value="">Selecione um período</option>
                                <option value="diario">Diário</option>
                                <option value="semanal">Semanal</option>
                                <option value="mensal">Mensal</option>
                                <option value="trimestral">Trimestral</option>
                                <option value="anual">Anual</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="dataInicioPersonalizado">Data Inicial</label>
                            <input type="date" id="dataInicioPersonalizado" class="filter-select">
                        </div>
                        <div class="form-group">
                            <label for="dataFimPersonalizado">Data Final</label>
                            <input type="date" id="dataFimPersonalizado" class="filter-select">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Incluir no Relatório</label>
                        <div style="display: flex; gap: 20px; margin-top: 10px;">
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="checkbox" id="incluirGraficos" checked>
                                Gráficos
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="checkbox" id="incluirTabelas" checked>
                                Tabelas
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="checkbox" id="incluirResumo" checked>
                                Resumo Executivo
                            </label>
                        </div>
                    </div>
                    <div style="margin-top: 20px; text-align: right;">
                        <button class="btn btn-primary" id="gerarRelatorioPersonalizado">
                            <i class="material-icons">bar_chart</i> Gerar Relatório
                        </button>
                    </div>
                </div>
                
                <!-- Container para exibir o relatório gerado -->
                <div class="report-container" id="reportContainer">
                    <!-- O conteúdo do relatório será gerado dinamicamente -->
                </div>
            </div>
            
            <!-- Clientes Section -->
            <div class="section" id="clientes">
                <div class="dashboard-header">
                    <div class="welcome-message">
                        <h1>Clientes</h1>
                        <p>Gerencie seu cadastro de clientes</p>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" id="novoClienteBtn"><i class="material-icons">add</i> Novo Cliente</button>
                    </div>
                </div>
                
                <div class="data-container">
                    <div class="search-container">
                        <input type="text" placeholder="Buscar clientes..." id="clientesSearchInput">
                        <button class="search-btn"><i class="material-icons">search</i></button>
                    </div>
                    <div class="filter-container">
                        <select class="filter-select" id="clienteStatusFilter">
                            <option value="todos">Todos</option>
                            <option value="ativo">Ativos</option>
                            <option value="inativo">Inativos</option>
                        </select>
                    </div>
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nome</th>
                                    <th>Email</th>
                                    <th>Telefone</th>
                                    <th>Última Compra</th>
                                    <th>Total Gasto</th>
                                    <th>Status</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>C001</td>
                                    <td>Maria Silva</td>
                                    <td>maria@email.com</td>
                                    <td>(11) 98765-4321</td>
                                    <td>16/05/2023</td>
                                    <td>R$ 450,80</td>
                                    <td><span class="status status-success">Ativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="view" data-id="C001"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn" data-action="edit" data-id="C001"><i class="material-icons">edit</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>C002</td>
                                    <td>João Santos</td>
                                    <td>joao@email.com</td>
                                    <td>(11) 91234-5678</td>
                                    <td>15/05/2023</td>
                                    <td>R$ 325,50</td>
                                    <td><span class="status status-success">Ativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="view" data-id="C002"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn" data-action="edit" data-id="C002"><i class="material-icons">edit</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>C003</td>
                                    <td>Ana Oliveira</td>
                                    <td>ana@email.com</td>
                                    <td>(11) 92345-6789</td>
                                    <td>14/05/2023</td>
                                    <td>R$ 280,00</td>
                                    <td><span class="status status-success">Ativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="view" data-id="C003"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn" data-action="edit" data-id="C003"><i class="material-icons">edit</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>C004</td>
                                    <td>Pedro Costa</td>
                                    <td>pedro@email.com</td>
                                    <td>(11) 93456-7890</td>
                                    <td>12/05/2023</td>
                                    <td>R$ 150,20</td>
                                    <td><span class="status status-success">Ativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="view" data-id="C004"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn" data-action="edit" data-id="C004"><i class="material-icons">edit</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>C005</td>
                                    <td>Lucia Ferreira</td>
                                    <td>lucia@email.com</td>
                                    <td>(11) 94567-8901</td>
                                    <td>10/05/2023</td>
                                    <td>R$ 420,40</td>
                                    <td><span class="status status-danger">Inativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="view" data-id="C005"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn" data-action="edit" data-id="C005"><i class="material-icons">edit</i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="pagination">
                        <button class="pagination-btn"><i class="material-icons">chevron_left</i></button>
                        <button class="pagination-btn active">1</button>
                        <button class="pagination-btn">2</button>
                        <button class="pagination-btn">3</button>
                        <button class="pagination-btn"><i class="material-icons">chevron_right</i></button>
                    </div>
                </div>
            </div>
            
            <!-- Fornecedores Section -->
            <div class="section" id="fornecedores">
                <div class="dashboard-header">
                    <div class="welcome-message">
                        <h1>Fornecedores</h1>
                        <p>Gerencie seus relacionamentos com fornecedores</p>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" id="novoFornecedorBtn"><i class="material-icons">add</i> Novo Fornecedor</button>
                    </div>
                </div>
                
                <div class="data-container">
                    <div class="search-container">
                        <input type="text" placeholder="Buscar fornecedores..." id="fornecedoresSearchInput">
                        <button class="search-btn"><i class="material-icons">search</i></button>
                    </div>
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nome</th>
                                    <th>Contato</th>
                                    <th>Email</th>
                                    <th>Telefone</th>
                                    <th>Status</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>F001</td>
                                    <td>Distribuidora de Farinhas Ltda</td>
                                    <td>João Silva</td>
                                    <td>joao@farinhas.com</td>
                                    <td>(11) 9876-5432</td>
                                    <td><span class="status status-success">Ativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="view" data-id="F001"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn" data-action="edit" data-id="F001"><i class="material-icons">edit</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>F002</td>
                                    <td>Açúcar & Cia</td>
                                    <td>Maria Rodriguez</td>
                                    <td>maria@acucar.com</td>
                                    <td>(11) 8765-4321</td>
                                    <td><span class="status status-success">Ativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="view" data-id="F002"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn" data-action="edit" data-id="F002"><i class="material-icons">edit</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>F003</td>
                                    <td>Laticínios do Vale</td>
                                    <td>Roberto Mendes</td>
                                    <td>roberto@laticinios.com</td>
                                    <td>(11) 7654-3210</td>
                                    <td><span class="status status-success">Ativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="view" data-id="F003"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn" data-action="edit" data-id="F003"><i class="material-icons">edit</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>F004</td>
                                    <td>Embalagens Express</td>
                                    <td>Ana Clara</td>
                                    <td>ana@embalagens.com</td>
                                    <td>(11) 6543-2109</td>
                                    <td><span class="status status-success">Ativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="view" data-id="F004"><i class="material-icons">visibility</i></button>
                                        <button class="action-btn" data-action="edit" data-id="F004"><i class="material-icons">edit</i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="pagination">
                        <button class="pagination-btn"><i class="material-icons">chevron_left</i></button>
                        <button class="pagination-btn active">1</button>
                        <button class="pagination-btn">2</button>
                        <button class="pagination-btn">3</button>
                        <button class="pagination-btn"><i class="material-icons">chevron_right</i></button>
                    </div>
                </div>
            </div>
            
            <!-- Usuários Section -->
            <div class="section" id="usuarios">
                <div class="dashboard-header">
                    <div class="welcome-message">
                        <h1>Usuários</h1>
                        <p>Gerencie usuários e permissões do sistema</p>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" id="novoUsuarioBtn"><i class="material-icons">add</i> Novo Usuário</button>
                    </div>
                </div>
                
                <div class="data-container">
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nome</th>
                                    <th>Email</th>
                                    <th>Função</th>
                                    <th>Último Login</th>
                                    <th>Status</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>Admin</td>
                                    <td>admin@newbox.com</td>
                                    <td>Administrador</td>
                                    <td>16/05/2023 09:30</td>
                                    <td><span class="status status-success">Ativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="edit" data-id="1"><i class="material-icons">edit</i></button>
                                        <button class="action-btn" data-action="lock" data-id="1"><i class="material-icons">lock</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>Maria Silva</td>
                                    <td>maria@newbox.com</td>
                                    <td>Caixa</td>
                                    <td>15/05/2023 18:15</td>
                                    <td><span class="status status-success">Ativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="edit" data-id="2"><i class="material-icons">edit</i></button>
                                        <button class="action-btn" data-action="lock" data-id="2"><i class="material-icons">lock</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>João Silva</td>
                                    <td>joao@newbox.com</td>
                                    <td>Estoquista</td>
                                    <td>14/05/2023 13:40</td>
                                    <td><span class="status status-success">Ativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="edit" data-id="3"><i class="material-icons">edit</i></button>
                                        <button class="action-btn" data-action="lock" data-id="3"><i class="material-icons">lock</i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>4</td>
                                    <td>Pedro Santos</td>
                                    <td>pedro@newbox.com</td>
                                    <td>Gerente</td>
                                    <td>10/05/2023 09:15</td>
                                    <td><span class="status status-danger">Inativo</span></td>
                                    <td class="action-cell">
                                        <button class="action-btn" data-action="edit" data-id="4"><i class="material-icons">edit</i></button>
                                        <button class="action-btn" data-action="lock" data-id="4"><i class="material-icons">lock_open</i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Configurações Section -->
            <div class="section" id="configuracoes">
                <div class="dashboard-header">
                    <div class="welcome-message">
                        <h1>Configurações</h1>
                        <p>Gerencie configurações e preferências do sistema</p>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" id="salvarConfiguracoes"><i class="material-icons">save</i> Salvar Alterações</button>
                    </div>
                </div>
                
                <div class="data-container">
                    <div class="container-header">
                        <h3 class="container-title">Configurações do Sistema</h3>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Nome da Empresa</label>
                            <input type="text" id="nomeEmpresa" value="Padaria NewBox">
                        </div>
                        <div class="form-group">
                            <label>Moeda</label>
                            <select id="moeda">
                                <option value="BRL" selected>R$ (BRL)</option>
                                <option value="USD">$ (USD)</option>
                                <option value="EUR">€ (EUR)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Fuso Horário</label>
                            <select id="fusoHorario">
                                <option value="America/Sao_Paulo" selected>America/Sao_Paulo (GMT-3)</option>
                                <option value="America/New_York">America/New_York (GMT-4)</option>
                                <option value="Europe/London">Europe/London (GMT+1)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Formato de Data</label>
                            <select id="formatoData">
                                <option value="DD/MM/AAAA" selected>DD/MM/AAAA</option>
                                <option value="MM/DD/AAAA">MM/DD/AAAA</option>
                                <option value="AAAA-MM-DD">AAAA-MM-DD</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="data-container">
                    <div class="container-header">
                        <h3 class="container-title">Acessibilidade</h3>
                    </div>
                    <div>
                        <div class="form-group">
                            <label>Modo de Contraste</label>
                            <div class="settings-btn-group">
                                <button class="settings-btn active" id="contrasteNormal">Normal</button>
                                <button class="settings-btn" id="contrasteAlto">Alto Contraste</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Idioma</label>
                            <select id="idioma">
                                <option value="pt-BR" selected>Português (Brasil)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Tamanho da Fonte</label>
                            <div class="settings-btn-group">
                                <button class="settings-btn" id="fontePequena">A-</button>
                                <button class="settings-btn active" id="fonteNormal">A</button>
                                <button class="settings-btn" id="fonteGrande">A+</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="data-container">
                    <div class="container-header">
                        <h3 class="container-title">Configurações Fiscais</h3>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Taxa de Imposto Padrão (%)</label>
                            <input type="number" id="taxaImposto" value="18">
                        </div>
                        <div class="form-group">
                            <label>CNPJ</label>
                            <input type="text" id="cnpj" value="12.345.678/0001-90">
                        </div>
                        <div class="form-group">
                            <label>Inscrição Estadual</label>
                            <input type="text" id="inscricaoEstadual" value="123.456.789">
                        </div>
                        <div class="form-group">
                            <label>Regime Tributário</label>
                            <select id="regimeTributario">
                                <option value="simples" selected>Simples Nacional</option>
                                <option value="lucro_presumido">Lucro Presumido</option>
                                <option value="lucro_real">Lucro Real</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modais -->
    
    <!-- Modal de Novo Produto -->
    <div class="modal" id="novoProdutoModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Adicionar Novo Produto</h2>
                <button class="close-modal" id="closeNovoProdutoModal">×</button>
            </div>
            <div class="modal-body">
                <form id="novoProdutoForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="produtoCodigo">Código</label>
                            <input type="text" id="produtoCodigo" required>
                        </div>
                        <div class="form-group">
                            <label for="produtoNome">Nome</label>
                            <input type="text" id="produtoNome" required>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="produtoCategoria">Categoria</label>
                            <select id="produtoCategoria" required>
                                <option value="">Selecione...</option>
                                <option value="paes">Pães</option>
                                <option value="bolos">Bolos</option>
                                <option value="salgados">Salgados</option>
                                <option value="bebidas">Bebidas</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="produtoPreco">Preço (R$)</label>
                            <input type="number" step="0.01" id="produtoPreco" required>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="produtoEstoque">Estoque Inicial</label>
                            <input type="number" id="produtoEstoque" required>
                        </div>
                        <div class="form-group">
                            <label for="produtoEstoqueMinimo">Estoque Mínimo</label>
                            <input type="number" id="produtoEstoqueMinimo" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="produtoDescricao">Descrição</label>
                        <textarea id="produtoDescricao" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="cancelarNovoProduto">Cancelar</button>
                <button class="btn btn-success" id="salvarNovoProduto">Salvar</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Editar Produto -->
    <div class="modal" id="editarProdutoModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Editar Produto</h2>
                <button class="close-modal" id="closeEditarProdutoModal">×</button>
            </div>
            <div class="modal-body">
                <form id="editarProdutoForm">
                    <input type="hidden" id="editProdutoId">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="editProdutoCodigo">Código</label>
                            <input type="text" id="editProdutoCodigo" required>
                        </div>
                        <div class="form-group">
                            <label for="editProdutoNome">Nome</label>
                            <input type="text" id="editProdutoNome" required>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="editProdutoCategoria">Categoria</label>
                            <select id="editProdutoCategoria" required>
                                <option value="">Selecione...</option>
                                <option value="paes">Pães</option>
                                <option value="bolos">Bolos</option>
                                <option value="salgados">Salgados</option>
                                <option value="bebidas">Bebidas</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="editProdutoPreco">Preço (R$)</label>
                            <input type="number" step="0.01" id="editProdutoPreco" required>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="editProdutoEstoque">Estoque Atual</label>
                            <input type="number" id="editProdutoEstoque" required>
                        </div>
                        <div class="form-group">
                            <label for="editProdutoEstoqueMinimo">Estoque Mínimo</label>
                            <input type="number" id="editProdutoEstoqueMinimo" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="editProdutoDescricao">Descrição</label>
                        <textarea id="editProdutoDescricao" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="cancelarEditarProduto">Cancelar</button>
                <button class="btn btn-success" id="salvarEditarProduto">Salvar Alterações</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Confirmação para Excluir Produto -->
    <div class="modal" id="confirmarExclusaoModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2 class="modal-title">Confirmar Exclusão</h2>
                <button class="close-modal" id="closeConfirmarExclusaoModal">×</button>
            </div>
            <div class="modal-body">
                <p>Tem certeza que deseja excluir o produto <strong id="produtoExcluirNome"></strong>?</p>
                <p>Esta ação não pode ser desfeita.</p>
                <input type="hidden" id="produtoExcluirId">
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="cancelarExclusao">Cancelar</button>
                <button class="btn btn-danger" id="confirmarExclusao">Excluir</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Nova Categoria -->
    <div class="modal" id="novaCategoriaModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="modal-title">Adicionar Nova Categoria</h2>
                <button class="close-modal" id="closeNovaCategoriaModal">×</button>
            </div>
            <div class="modal-body">
                <form id="novaCategoriaForm">
                    <div class="form-group">
                        <label for="categoriaNome">Nome da Categoria</label>
                        <input type="text" id="categoriaNome" required>
                    </div>
                    <div class="form-group">
                        <label for="categoriaDescricao">Descrição</label>
                        <textarea id="categoriaDescricao" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="cancelarNovaCategoria">Cancelar</button>
                <button class="btn btn-success" id="salvarNovaCategoria">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Modal de Editar Categoria -->
    <div class="modal" id="editarCategoriaModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="modal-title">Editar Categoria</h2>
                <button class="close-modal" id="closeEditarCategoriaModal">×</button>
            </div>
            <div class="modal-body">
                <form id="editarCategoriaForm">
                    <input type="hidden" id="editCategoriaId">
                    <div class="form-group">
                        <label for="editCategoriaNome">Nome da Categoria</label>
                        <input type="text" id="editCategoriaNome" required>
                    </div>
                    <div class="form-group">
                        <label for="editCategoriaDescricao">Descrição</label>
                        <textarea id="editCategoriaDescricao" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="editCategoriaStatus">Status</label>
                        <select id="editCategoriaStatus">
                            <option value="ativo">Ativo</option>
                            <option value="inativo">Inativo</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="cancelarEditarCategoria">Cancelar</button>
                <button class="btn btn-success" id="salvarEditarCategoria">Salvar Alterações</button>
            </div>
        </div>
    </div>

    <!-- Modal de Confirmação para Excluir Categoria -->
    <div class="modal" id="confirmarExclusaoCategoriaModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2 class="modal-title">Confirmar Exclusão de Categoria</h2>
                <button class="close-modal" id="closeConfirmarExclusaoCategoriaModal">×</button>
            </div>
            <div class="modal-body">
                <p>Tem certeza que deseja excluir a categoria <strong id="categoriaExcluirNome"></strong>?</p>
                <p>Esta ação pode afetar os produtos vinculados a esta categoria.</p>
                <input type="hidden" id="categoriaExcluirId">
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="cancelarExclusaoCategoria">Cancelar</button>
                <button class="btn btn-danger" id="confirmarExclusaoCategoria">Excluir</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Nova Movimentação -->
    <div class="modal" id="novaMovimentacaoModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Nova Movimentação de Estoque</h2>
                <button class="close-modal" id="closeNovaMovimentacaoModal">×</button>
            </div>
            <div class="modal-body">
                <form id="novaMovimentacaoForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="movProduto">Produto</label>
                            <select id="movProduto" required>
                                <option value="">Selecione um produto...</option>
                                <option value="001">001 - Pão Francês</option>
                                <option value="002">002 - Bolo de Chocolate</option>
                                <option value="003">003 - Pão de Queijo</option>
                                <option value="004">004 - Café Expresso</option>
                                <option value="005">005 - Croissant</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="movTipo">Tipo de Movimentação</label>
                            <select id="movTipo" required>
                                <option value="entrada">Entrada</option>
                                <option value="saida">Saída</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="movQuantidade">Quantidade</label>
                            <input type="number" id="movQuantidade" min="1" required>
                        </div>
                        <div class="form-group">
                            <label for="movData">Data e Hora</label>
                            <input type="datetime-local" id="movData" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="movMotivo">Motivo</label>
                        <textarea id="movMotivo" rows="3" placeholder="Informe o motivo desta movimentação"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="cancelarNovaMovimentacao">Cancelar</button>
                <button class="btn btn-success" id="salvarNovaMovimentacao">Registrar Movimentação</button>
            </div>
        </div>
    </div>

    <!-- Modal para Visualizar Detalhes da Movimentação -->
    <div class="modal" id="verMovimentacaoModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="modal-title">Detalhes da Movimentação</h2>
                <button class="close-modal" id="closeVerMovimentacaoModal">×</button>
            </div>
            <div class="modal-body" id="verMovimentacaoConteudo">
                <!-- Conteúdo será preenchido dinamicamente -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="fecharVerMovimentacaoBtn">Fechar</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Novo Cliente -->
    <div class="modal" id="novoClienteModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Adicionar Novo Cliente</h2>
                <button class="close-modal" id="closeNovoClienteModal">×</button>
            </div>
            <div class="modal-body">
                <form id="novoClienteForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="clienteNome">Nome Completo</label>
                            <input type="text" id="clienteNome" required>
                        </div>
                        <div class="form-group">
                            <label for="clienteEmail">Email</label>
                            <input type="email" id="clienteEmail" required>
                        </div>
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="clienteTelefone">Telefone</label>
                            <input type="tel" id="clienteTelefone" placeholder="(00) 00000-0000" required>
                        </div>
                        <div class="form-group">
                            <label for="clienteCpf">CPF</label>
                            <input type="text" id="clienteCpf" placeholder="000.000.000-00">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="clienteEndereco">Endereço</label>
                        <input type="text" id="clienteEndereco" placeholder="Rua, número, complemento">
                    </div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="clienteCidade">Cidade</label>
                            <input type="text" id="clienteCidade">
                        </div>
                        <div class="form-group">
                            <label for="clienteEstado">Estado</label>
                            <select id="clienteEstado">
                                <option value="">Selecione...</option>
                                <option value="AC">AC</option>
                                <option value="AL">AL</option>
                                <option value="AP">AP</option>
                                <option value="AM">AM</option>
                                <option value="BA">BA</option>
                                <option value="CE">CE</option>
                                <option value="DF">DF</option>
                                <option value="ES">ES</option>
                                <option value="GO">GO</option>
                                <option value="MA">MA</option>
                                <option value="MT">MT</option>
                                <option value="MS">MS</option>
                                <option value="MG">MG</option>
                                <option value="PA">PA</option>
                                <option value="PB">PB</option>
                                <option value="PR">PR</option>
                                <option value="PE">PE</option>
                                <option value="PI">PI</option>
                                <option value="RJ">RJ</option>
                                <option value="RN">RN</option>
                                <option value="RS">RS</option>
                                <option value="RO">RO</option>
                                <option value="RR">RR</option>
                                <option value="SC">SC</option>
                                <option value="SP">SP</option>
                                <option value="SE">SE</option>
                                <option value="TO">TO</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="clienteCep">CEP</label>
                            <input type="text" id="clienteCep" placeholder="00000-000">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="clienteObservacoes">Observações</label>
                        <textarea id="clienteObservacoes" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="cancelarNovoCliente">Cancelar</button>
                <button class="btn btn-success" id="salvarNovoCliente">Salvar</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Nova Venda -->
    <div class="modal" id="novaVendaModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Nova Venda</h2>
                <button class="close-modal" id="closeNovaVendaModal">×</button>
            </div>
            <div class="modal-body">
                <form id="novaVendaForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="vendaCliente">Cliente</label>
                            <select id="vendaCliente" required>
                                <option value="">Selecione o cliente...</option>
                                <option value="outro">Outro / Venda Rápida</option>
                                <option value="C001">Maria Silva</option>
                                <option value="C002">João Santos</option>
                                <option value="C003">Ana Oliveira</option>
                                <option value="C004">Pedro Costa</option>
                                <option value="C005">Lucia Ferreira</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="vendaData">Data</label>
                            <input type="datetime-local" id="vendaData" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Produtos</label>
                        <div class="table-responsive">
                            <table id="vendaProdutosTable">
                                <thead>
                                    <tr>
                                        <th>Produto</th>
                                        <th>Quantidade</th>
                                        <th>Valor Unitário</th>
                                        <th>Subtotal</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <select class="produto-select">
                                                <option value="">Selecione um produto...</option>
                                                <option value="001" data-preco="0.75">Pão Francês - R$ 0,75</option>
                                                <option value="002" data-preco="35.00">Bolo de Chocolate - R$ 35,00</option>
                                                <option value="003" data-preco="2.50">Pão de Queijo - R$ 2,50</option>
                                                <option value="005" data-preco="6.50">Croissant - R$ 6,50</option>
                                            </select>
                                        </td>
                                        <td>
                                            <input type="number" class="produto-qtd" min="1" value="1">
                                        </td>
                                        <td class="produto-valor">R$ 0,00</td>
                                        <td class="produto-subtotal">R$ 0,00</td>
                                        <td>
                                            <button type="button" class="action-btn remover-produto"><i class="material-icons">delete</i></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <button type="button" class="btn btn-primary mt-4" id="adicionarProdutoBtn">
                            <i class="material-icons">add</i> Adicionar Produto
                        </button>
                    </div>
                    
                    <div class="form-grid" style="margin-top: 20px;">
                        <div class="form-group">
                            <label for="vendaFormaPagamento">Forma de Pagamento</label>
                            <select id="vendaFormaPagamento" required>
                                <option value="">Selecione...</option>
                                <option value="dinheiro">Dinheiro</option>
                                <option value="cartao_credito">Cartão de Crédito</option>
                                <option value="cartao_debito">Cartão de Débito</option>
                                <option value="pix">PIX</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="vendaStatus">Status</label>
                            <select id="vendaStatus" required>
                                <option value="concluido">Concluído</option>
                                <option value="preparando">Preparando</option>
                                <option value="pendente">Pendente</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; margin-top: 20px; font-weight: bold;">
                        <div>Total:</div>
                        <div id="vendaTotal">R$ 0,00</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="cancelarNovaVenda">Cancelar</button>
                <button class="btn btn-success" id="finalizarVenda">Finalizar Venda</button>
            </div>
        </div>
    </div>
    
    <!-- Modal para Visualizar Detalhes da Venda -->
    <div class="modal" id="verVendaModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Detalhes da Venda</h2>
                <button class="close-modal" id="closeVerVendaModal">×</button>
            </div>
            <div class="modal-body" id="verVendaConteudo">
                <!-- Conteúdo será preenchido dinamicamente -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="fecharVerVendaBtn">Fechar</button>
                <button class="btn btn-success" id="visualizarReciboBtn"><i class="material-icons">receipt</i> Ver Recibo</button>
            </div>
        </div>
    </div>
    
    <!-- Modal para Recibo -->
    <div class="modal" id="reciboModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="modal-title">Recibo</h2>
                <button class="close-modal" id="closeReciboModal">×</button>
            </div>
            <div class="modal-body" id="reciboConteudo">
                <!-- Conteúdo será preenchido dinamicamente -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="fecharReciboBtn">Fechar</button>
                <button class="btn btn-success" id="imprimirReciboBtn"><i class="material-icons">print</i> Imprimir</button>
            </div>
        </div>
    </div>
    
    <!-- Modal para Nova Compra -->
    <div class="modal" id="novaCompraModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Nova Compra</h2>
                <button class="close-modal" id="closeNovaCompraModal">×</button>
            </div>
            <div class="modal-body">
                <form id="novaCompraForm">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="compraFornecedor">Fornecedor</label>
                            <select id="compraFornecedor" required>
                                <option value="">Selecione o fornecedor...</option>
                                <option value="F001">Distribuidora de Farinhas Ltda</option>
                                <option value="F002">Açúcar & Cia</option>
                                <option value="F003">Laticínios do Vale</option>
                                <option value="F004">Embalagens Express</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="compraPedido">Número do Pedido</label>
                            <input type="text" id="compraPedido" value="PC-2023-004" readonly>
                        </div>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="compraDataPedido">Data do Pedido</label>
                            <input type="date" id="compraDataPedido" required>
                        </div>
                        <div class="form-group">
                            <label for="compraDataEntrega">Data de Entrega Prevista</label>
                            <input type="date" id="compraDataEntrega" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Itens do Pedido</label>
                        <div class="table-responsive">
                            <table id="compraItensTable">
                                <thead>
                                    <tr>
                                        <th>Produto</th>
                                        <th>Quantidade</th>
                                        <th>Valor Unitário</th>
                                        <th>Subtotal</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <input type="text" class="compra-produto-nome" placeholder="Nome do produto">
                                        </td>
                                        <td>
                                            <input type="number" class="compra-qtd" min="1" value="1">
                                        </td>
                                        <td>
                                            <input type="number" step="0.01" class="compra-valor" placeholder="0.00">
                                        </td>
                                        <td class="compra-subtotal">R$ 0,00</td>
                                        <td>
                                            <button type="button" class="action-btn remover-item-compra"><i class="material-icons">delete</i></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <button type="button" class="btn btn-primary mt-4" id="adicionarItemCompraBtn">
                            <i class="material-icons">add</i> Adicionar Item
                        </button>
                    </div>
                    
                    <div class="form-grid" style="margin-top: 20px;">
                        <div class="form-group">
                            <label for="compraStatus">Status</label>
                            <select id="compraStatus" required>
                                <option value="pendente">Pendente</option>
                                <option value="entregue">Entregue</option>
                                <option value="cancelado">Cancelado</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="compraObservacoes">Observações</label>
                            <textarea id="compraObservacoes" rows="2"></textarea>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; margin-top: 20px; font-weight: bold;">
                        <div>Total:</div>
                        <div id="compraTotal">R$ 0,00</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="cancelarNovaCompra">Cancelar</button>
                <button class="btn btn-success" id="salvarCompra">Salvar Compra</button>
            </div>
        </div>
    </div>
    
    <!-- Modal para Editar Compra -->
    <div class="modal" id="editarCompraModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Editar Compra</h2>
                <button class="close-modal" id="closeEditarCompraModal">×</button>
            </div>
            <div class="modal-body">
                <!-- Conteúdo similar ao modal de Nova Compra, mas com campos preenchidos -->
                <form id="editarCompraForm">
                    <input type="hidden" id="editarCompraId">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="editarCompraFornecedor">Fornecedor</label>
                            <select id="editarCompraFornecedor" required>
                                <option value="">Selecione o fornecedor...</option>
                                <option value="F001">Distribuidora de Farinhas Ltda</option>
                                <option value="F002">Açúcar & Cia</option>
                                <option value="F003">Laticínios do Vale</option>
                                <option value="F004">Embalagens Express</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="editarCompraPedido">Número do Pedido</label>
                            <input type="text" id="editarCompraPedido" readonly>
                        </div>
                    </div>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="editarCompraDataPedido">Data do Pedido</label>
                            <input type="date" id="editarCompraDataPedido" required>
                        </div>
                        <div class="form-group">
                            <label for="editarCompraDataEntrega">Data de Entrega Prevista</label>
                            <input type="date" id="editarCompraDataEntrega" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Itens do Pedido</label>
                        <div class="table-responsive">
                            <table id="editarCompraItensTable">
                                <thead>
                                    <tr>
                                        <th>Produto</th>
                                        <th>Quantidade</th>
                                        <th>Valor Unitário</th>
                                        <th>Subtotal</th>
                                        <th>Ações</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Itens serão adicionados dinamicamente -->
                                </tbody>
                            </table>
                        </div>
                        <button type="button" class="btn btn-primary mt-4" id="editarAdicionarItemCompraBtn">
                            <i class="material-icons">add</i> Adicionar Item
                        </button>
                    </div>
                    
                    <div class="form-grid" style="margin-top: 20px;">
                        <div class="form-group">
                            <label for="editarCompraStatus">Status</label>
                            <select id="editarCompraStatus" required>
                                <option value="pendente">Pendente</option>
                                <option value="entregue">Entregue</option>
                                <option value="cancelado">Cancelado</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="editarCompraObservacoes">Observações</label>
                            <textarea id="editarCompraObservacoes" rows="2"></textarea>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; margin-top: 20px; font-weight: bold;">
                        <div>Total:</div>
                        <div id="editarCompraTotal">R$ 0,00</div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" id="cancelarEditarCompra">Cancelar</button>
                <button class="btn btn-success" id="salvarEditarCompra">Salvar Alterações</button>
            </div>
        </div>
    </div>
    
    <!-- Modal para Visualizar Detalhes da Compra -->
    <div class="modal" id="verCompraModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Detalhes da Compra</h2>
                <button class="close-modal" id="closeVerCompraModal">×</button>
            </div>
            <div class="modal-body" id="verCompraConteudo">
                <!-- Conteúdo será preenchido dinamicamente -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="fecharVerCompraBtn">Fechar</button>
                <button class="btn btn-success" id="editarCompraBtn"><i class="material-icons">edit</i> Editar</button>
            </div>
        </div>
    </div>
    
    <!-- Modal para Visualizar Relatório -->
    <div class="modal" id="verRelatorioModal">
        <div class="modal-content" style="max-width: 800px; max-height: 90vh;">
            <div class="modal-header">
                <h2 class="modal-title">Visualização do Relatório</h2>
                <button class="close-modal" id="closeVerRelatorioModal">×</button>
            </div>
            <div class="modal-body" id="verRelatorioConteudo" style="max-height: 70vh; overflow-y: auto;">
                <!-- Conteúdo será preenchido dinamicamente -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" id="fecharVerRelatorioBtn">Fechar</button>
                <button class="btn btn-success" id="downloadRelatorioBtn"><i class="material-icons">download</i> Download</button>
            </div>
        </div>
    </div>
    
    <!-- Notificação -->
    <div class="notification" id="notification"></div>

     <!-- Bot de Ajuda -->
    <div class="help-bot-container">
        <div class="help-bot-button" id="helpBotButton">
            <i class="material-icons">support_agent</i>
            <div class="notification-badge">1</div>
        </div>
        
        <div class="help-bot-panel" id="helpBotPanel">
            <div class="help-bot-header">
                <h3>Assistente NewBox</h3>
                <button class="close-help" id="closeHelpBot">×</button>
            </div>
            
            <div class="help-bot-body">
                <div class="help-bot-welcome">
                    <h4>Olá! Como posso ajudar?</h4>
                    <p>Sou o assistente virtual do NewBox. Selecione uma das perguntas frequentes abaixo ou faça sua própria pergunta.</p>
                    <div class="audio-controls">
                        <button class="audio-toggle-button" id="toggleAudio">
                            <i class="material-icons">volume_up</i>
                            <span>Ativar Voz</span>
                        </button>
                        <div class="audio-control-group">
                            <label for="voiceSelect">Voz:</label>
                            <select id="voiceSelect" disabled>
                                <option value="">Carregando vozes...</option>
                            </select>
                        </div>
                        <div class="audio-control-group">
                            <label for="speechRate">Velocidade:</label>
                            <input type="range" id="speechRate" min="0.5" max="2" step="0.1" value="1">
                        </div>
                        <div class="audio-control-group">
                            <label for="speechVolume">Volume:</label>
                            <input type="range" id="speechVolume" min="0" max="1" step="0.1" value="1">
                        </div>
                        <div class="speech-status" id="speechStatus">Voz desativada</div>
                    </div>
                </div>
                
                <div class="common-questions" id="commonQuestions">
                    <h4>Perguntas Frequentes:</h4>
                    <div class="question-item" data-question="Como adicionar um novo produto?">
                        <i class="material-icons">add_circle</i>
                        <span>Como adicionar um novo produto?</span>
                    </div>
                    <div class="question-item" data-question="Como registrar uma venda?">
                        <i class="material-icons">point_of_sale</i>
                        <span>Como registrar uma venda?</span>
                    </div>
                    <div class="question-item" data-question="Como verificar o estoque?">
                        <i class="material-icons">inventory</i>
                        <span>Como verificar o estoque?</span>
                    </div>
                    <div class="question-item" data-question="Como gerar relatórios?">
                        <i class="material-icons">assessment</i>
                        <span>Como gerar relatórios?</span>
                    </div>
                    <div class="question-item" data-question="Como adicionar novos usuários?">
                        <i class="material-icons">person_add</i>
                        <span>Como adicionar novos usuários?</span>
                    </div>
                    <div class="question-item" data-question="Como atualizar meus dados?">
                        <i class="material-icons">manage_accounts</i>
                        <span>Como atualizar meus dados?</span>
                    </div>
                </div>
                
                <div class="help-bot-chat" id="helpBotChat">
                    <div class="chat-messages" id="chatMessages">
                        <!-- As mensagens são inseridas aqui dinamicamente -->
                    </div>
                    
                    <div class="back-to-questions">
                        <button class="back-btn" id="backToQuestions">Voltar para perguntas frequentes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <script>
        // DATABASE SIMULADA
        const DB = {
            init: function() {
                // Inicializar banco de dados se não existir
                if (!localStorage.getItem('newbox_usuarios')) {
                    localStorage.setItem('newbox_usuarios', JSON.stringify([
                        { id: 1, nome: 'Admin', email: 'admin@newbox.com', senha: 'admin', funcao: 'Administrador', ultimoLogin: '16/05/2023 09:30', status: 'ativo' },
                        { id: 2, nome: 'Maria Silva', email: 'maria@newbox.com', senha: '123456', funcao: 'Caixa', ultimoLogin: '15/05/2023 18:15', status: 'ativo' }
                    ]));
                }
                
                if (!localStorage.getItem('newbox_produtos')) {
                    localStorage.setItem('newbox_produtos', JSON.stringify([
                        { codigo: '001', nome: 'Pão Francês', categoria: 'Pães', preco: 0.75, estoque: 150, estoqueMinimo: 50, status: 'em_estoque' },
                        { codigo: '002', nome: 'Bolo de Chocolate', categoria: 'Bolos', preco: 35.00, estoque: 8, estoqueMinimo: 10, status: 'baixo_estoque' },
                        { codigo: '003', nome: 'Pão de Queijo', categoria: 'Salgados', preco: 2.50, estoque: 45, estoqueMinimo: 20, status: 'em_estoque' },
                        { codigo: '004', nome: 'Café Expresso', categoria: 'Bebidas', preco: 5.00, estoque: 0, estoqueMinimo: 10, status: 'sem_estoque' },
                        { codigo: '005', nome: 'Croissant', categoria: 'Pães', preco: 6.50, estoque: 12, estoqueMinimo: 10, status: 'em_estoque' },
                        // Produtos adicionais para paginação
                        { codigo: '006', nome: 'Pão Integral', categoria: 'Pães', preco: 8.50, estoque: 30, estoqueMinimo: 15, status: 'em_estoque' },
                        { codigo: '007', nome: 'Torta de Frango', categoria: 'Salgados', preco: 39.90, estoque: 5, estoqueMinimo: 3, status: 'em_estoque' },
                        { codigo: '008', nome: 'Refrigerante Cola', categoria: 'Bebidas', preco: 6.00, estoque: 24, estoqueMinimo: 10, status: 'em_estoque' },
                        { codigo: '009', nome: 'Bolo de Cenoura', categoria: 'Bolos', preco: 32.00, estoque: 3, estoqueMinimo: 5, status: 'baixo_estoque' },
                        { codigo: '010', nome: 'Rosquinha', categoria: 'Pães', preco: 3.50, estoque: 40, estoqueMinimo: 20, status: 'em_estoque' },
                        { codigo: '011', nome: 'Sanduíche Natural', categoria: 'Salgados', preco: 12.50, estoque: 7, estoqueMinimo: 5, status: 'em_estoque' },
                        { codigo: '012', nome: 'Suco de Laranja', categoria: 'Bebidas', preco: 7.00, estoque: 15, estoqueMinimo: 8, status: 'em_estoque' },
                        { codigo: '013', nome: 'Bolo de Morango', categoria: 'Bolos', preco: 36.00, estoque: 2, estoqueMinimo: 3, status: 'baixo_estoque' },
                        { codigo: '014', nome: 'Pão Australiano', categoria: 'Pães', preco: 9.90, estoque: 0, estoqueMinimo: 10, status: 'sem_estoque' },
                        { codigo: '015', nome: 'Coxinha', categoria: 'Salgados', preco: 4.50, estoque: 22, estoqueMinimo: 15, status: 'em_estoque' },
                        { codigo: '016', nome: 'Água Mineral', categoria: 'Bebidas', preco: 3.00, estoque: 50, estoqueMinimo: 20, status: 'em_estoque' },
                        { codigo: '017', nome: 'Bolo de Milho', categoria: 'Bolos', preco: 30.00, estoque: 4, estoqueMinimo: 3, status: 'em_estoque' },
                        { codigo: '018', nome: 'Bisnaga', categoria: 'Pães', preco: 1.50, estoque: 60, estoqueMinimo: 30, status: 'em_estoque' },
                        { codigo: '019', nome: 'Empada', categoria: 'Salgados', preco: 5.00, estoque: 18, estoqueMinimo: 10, status: 'em_estoque' },
                        { codigo: '020', nome: 'Café com Leite', categoria: 'Bebidas', preco: 5.50, estoque: 0, estoqueMinimo: 5, status: 'sem_estoque' },
                        { codigo: '021', nome: 'Bolo de Coco', categoria: 'Bolos', preco: 33.00, estoque: 7, estoqueMinimo: 5, status: 'em_estoque' },
                        { codigo: '022', nome: 'Pão de Forma', categoria: 'Pães', preco: 7.90, estoque: 25, estoqueMinimo: 10, status: 'em_estoque' },
                        { codigo: '023', nome: 'Quiche de Queijo', categoria: 'Salgados', preco: 28.00, estoque: 6, estoqueMinimo: 4, status: 'em_estoque' },
                        { codigo: '024', nome: 'Chá Gelado', categoria: 'Bebidas', preco: 6.50, estoque: 12, estoqueMinimo: 8, status: 'em_estoque' },
                        { codigo: '025', nome: 'Bolo de Limão', categoria: 'Bolos', preco: 31.00, estoque: 2, estoqueMinimo: 3, status: 'baixo_estoque' },
                        { codigo: '026', nome: 'Ciabatta', categoria: 'Pães', preco: 8.90, estoque: 18, estoqueMinimo: 10, status: 'em_estoque' },
                        { codigo: '027', nome: 'Risole', categoria: 'Salgados', preco: 4.00, estoque: 30, estoqueMinimo: 15, status: 'em_estoque' },
                        { codigo: '028', nome: 'Suco de Uva', categoria: 'Bebidas', preco: 7.00, estoque: 14, estoqueMinimo: 7, status: 'em_estoque' },
                        { codigo: '029', nome: 'Bolo de Abacaxi', categoria: 'Bolos', preco: 34.00, estoque: 1, estoqueMinimo: 2, status: 'baixo_estoque' },
                        { codigo: '030', nome: 'Pão Sírio', categoria: 'Pães', preco: 9.50, estoque: 0, estoqueMinimo: 8, status: 'sem_estoque' }
                    ]));
                }
                
                if (!localStorage.getItem('newbox_categorias')) {
                    localStorage.setItem('newbox_categorias', JSON.stringify([
                        { id: 1, nome: 'Pães', produtos: 15, status: 'ativo', descricao: 'Todos os tipos de pães' },
                        { id: 2, nome: 'Bolos', produtos: 8, status: 'ativo', descricao: 'Bolos caseiros e tortas' },
                        { id: 3, nome: 'Salgados', produtos: 12, status: 'ativo', descricao: 'Itens salgados diversos' },
                        { id: 4, nome: 'Bebidas', produtos: 6, status: 'ativo', descricao: 'Bebidas quentes e frias' }
                    ]));
                }
                
                if (!localStorage.getItem('newbox_clientes')) {
                    localStorage.setItem('newbox_clientes', JSON.stringify([
                        { id: 'C001', nome: 'Maria Silva', email: 'maria@email.com', telefone: '(11) 98765-4321', ultimaCompra: '16/05/2023', totalGasto: 450.80, status: 'ativo' },
                        { id: 'C002', nome: 'João Santos', email: 'joao@email.com', telefone: '(11) 91234-5678', ultimaCompra: '15/05/2023', totalGasto: 325.50, status: 'ativo' },
                        { id: 'C003', nome: 'Ana Oliveira', email: 'ana@email.com', telefone: '(11) 92345-6789', ultimaCompra: '14/05/2023', totalGasto: 280.00, status: 'ativo' },
                        { id: 'C004', nome: 'Pedro Costa', email: 'pedro@email.com', telefone: '(11) 93456-7890', ultimaCompra: '12/05/2023', totalGasto: 150.20, status: 'ativo' },
                        { id: 'C005', nome: 'Lucia Ferreira', email: 'lucia@email.com', telefone: '(11) 94567-8901', ultimaCompra: '10/05/2023', totalGasto: 420.40, status: 'inativo' },
                        { id: 'C006', nome: 'Outro', email: '', telefone: '', ultimaCompra: '-', totalGasto: 0, status: 'ativo' }
                    ]));
                }
                
                if (!localStorage.getItem('newbox_fornecedores')) {
                    localStorage.setItem('newbox_fornecedores', JSON.stringify([
                        { id: 'F001', nome: 'Distribuidora de Farinhas Ltda', contato: 'João Silva', email: 'joao@farinhas.com', telefone: '(11) 9876-5432', status: 'ativo' },
                        { id: 'F002', nome: 'Açúcar & Cia', contato: 'Maria Rodriguez', email: 'maria@acucar.com', telefone: '(11) 8765-4321', status: 'ativo' },
                        { id: 'F003', nome: 'Laticínios do Vale', contato: 'Roberto Mendes', email: 'roberto@laticinios.com', telefone: '(11) 7654-3210', status: 'ativo' },
                        { id: 'F004', nome: 'Embalagens Express', contato: 'Ana Clara', email: 'ana@embalagens.com', telefone: '(11) 6543-2109', status: 'ativo' }
                    ]));
                }
                
                if (!localStorage.getItem('newbox_vendas')) {
                    localStorage.setItem('newbox_vendas', JSON.stringify([
                        { 
                            id: 5874, 
                            cliente: 'C001', 
                            clienteNome: 'Maria Silva', 
                            itens: 5, 
                            produtos: [
                                { id: '001', nome: 'Pão Francês', quantidade: 10, valorUnitario: 0.75, subtotal: 7.50 },
                                { id: '002', nome: 'Bolo de Chocolate', quantidade: 1, valorUnitario: 35.00, subtotal: 35.00 }
                            ],
                            produtosTexto: 'Pão Francês, Bolo de Chocolate', 
                            total: 42.30, 
                            pagamento: 'Cartão de Crédito', 
                            data: '16/05/2023 10:15',
                            status: 'concluido',
                            observacoes: 'Cliente habitual, sempre compra pão francês pela manhã.'
                        },
                        { 
                            id: 5873, 
                            cliente: 'C002', 
                            clienteNome: 'João Santos', 
                            itens: 3, 
                            produtos: [
                                { id: '007', nome: 'Torta de Frango', quantidade: 1, valorUnitario: 39.90, subtotal: 39.90 },
                                { id: '008', nome: 'Refrigerante Cola', quantidade: 2, valorUnitario: 6.00, subtotal: 12.00 }
                            ],
                            produtosTexto: 'Torta de Frango, Refrigerante', 
                            total: 68.75, 
                            pagamento: 'Dinheiro', 
                            data: '16/05/2023 09:45',
                            status: 'preparando',
                            observacoes: 'Entregar às 12h' 
                        },
                        { 
                            id: 5872, 
                            cliente: 'C003', 
                            clienteNome: 'Ana Oliveira', 
                            itens: 4, 
                            produtos: [
                                { id: '003', nome: 'Pão de Queijo', quantidade: 12, valorUnitario: 2.50, subtotal: 30.00 },
                                { id: '004', nome: 'Café Expresso', quantidade: 1, valorUnitario: 5.00, subtotal: 5.00 }
                            ],
                            produtosTexto: 'Pão de Queijo (12), Café', 
                            total: 28.50, 
                            pagamento: 'Cartão de Débito', 
                            data: '15/05/2023 16:30',
                            status: 'concluido',
                            observacoes: 'Cliente pediu para esquetar o pão de queijo' 
                        },
                        { 
                            id: 5871, 
                            cliente: 'C004', 
                            clienteNome: 'Pedro Costa', 
                            itens: 2, 
                            produtos: [
                                { id: '013', nome: 'Bolo de Morango', quantidade: 1, valorUnitario: 36.00, subtotal: 36.00 },
                                { id: '012', nome: 'Suco de Laranja', quantidade: 1, valorUnitario: 7.00, subtotal: 7.00 }
                            ],
                            produtosTexto: 'Bolo de Morango, Suco Natural', 
                            total: 52.00, 
                            pagamento: 'Dinheiro', 
                            data: '15/05/2023 15:10',
                            status: 'cancelado',
                            observacoes: 'Cliente cancelou o pedido pois estava com pressa' 
                        },
                        { 
                            id: 5870, 
                            cliente: 'C005', 
                            clienteNome: 'Lucia Ferreira', 
                            itens: 3, 
                            produtos: [
                                { id: '006', nome: 'Pão Integral', quantidade: 1, valorUnitario: 8.50, subtotal: 8.50 },
                                { id: '023', nome: 'Quiche de Queijo', quantidade: 1, valorUnitario: 28.00, subtotal: 28.00 }
                            ],
                            produtosTexto: 'Pão Integral, Queijo Minas', 
                            total: 35.20, 
                            pagamento: 'Pix', 
                            data: '14/05/2023 14:20',
                            status: 'concluido',
                            observacoes: 'Cliente solicitou não colocar cebola na Quiche' 
                        }
                    ]));
                }
                
                if (!localStorage.getItem('newbox_compras')) {
                    localStorage.setItem('newbox_compras', JSON.stringify([
                        { 
                            id: 'PC-2023-001', 
                            fornecedor: 'F001', 
                            fornecedorNome: 'Distribuidora de Farinhas Ltda', 
                            itens: 3, 
                            total: 1250.00, 
                            dataPedido: '14/05/2023', 
                            dataEntrega: '20/05/2023', 
                            status: 'pendente',
                            itensDetalhados: [
                                { produto: 'Farinha de Trigo', quantidade: 50, valor: 15.00, subtotal: 750.00 },
                                { produto: 'Fermento Biológico', quantidade: 20, valor: 10.00, subtotal: 200.00 },
                                { produto: 'Farinha Integral', quantidade: 30, valor: 10.00, subtotal: 300.00 }
                            ],
                            observacoes: 'Entrega no período da manhã'
                        },
                        { 
                            id: 'PC-2023-002', 
                            fornecedor: 'F002', 
                            fornecedorNome: 'Açúcar & Cia', 
                            itens: 5, 
                            total: 780.50, 
                            dataPedido: '10/05/2023', 
                            dataEntrega: '15/05/2023', 
                            status: 'entregue',
                            itensDetalhados: [
                                { produto: 'Açúcar Refinado', quantidade: 40, valor: 8.50, subtotal: 340.00 },
                                { produto: 'Açúcar Cristal', quantidade: 30, valor: 7.00, subtotal: 210.00 },
                                { produto: 'Açúcar Mascavo', quantidade: 10, valor: 12.00, subtotal: 120.00 },
                                { produto: 'Açúcar de Confeiteiro', quantidade: 15, valor: 6.50, subtotal: 97.50 },
                                { produto: 'Adoçante', quantidade: 5, valor: 2.60, subtotal: 13.00 }
                            ],
                            observacoes: 'Pedido recebido e conferido'
                        },
                        { 
                            id: 'PC-2023-003', 
                            fornecedor: 'F003', 
                            fornecedorNome: 'Laticínios do Vale', 
                            itens: 4, 
                            total: 950.80, 
                            dataPedido: '08/05/2023', 
                            dataEntrega: '12/05/2023', 
                            status: 'entregue',
                            itensDetalhados: [
                                { produto: 'Leite', quantidade: 100, valor: 4.50, subtotal: 450.00 },
                                { produto: 'Queijo Minas', quantidade: 20, valor: 18.00, subtotal: 360.00 },
                                { produto: 'Manteiga', quantidade: 15, valor: 8.00, subtotal: 120.00 },
                                { produto: 'Requeijão', quantidade: 5, valor: 4.16, subtotal: 20.80 }
                            ],
                            observacoes: 'Produtos recebidos em perfeito estado'
                        }
                    ]));
                }
                
                if (!localStorage.getItem('newbox_movimentacoes')) {
                    localStorage.setItem('newbox_movimentacoes', JSON.stringify([
                        { id: 1001, produto: '001', produtoNome: 'Pão Francês', tipo: 'entrada', quantidade: 200, data: '15/05/2023 08:15', usuario: 'Maria', motivo: 'Reposição de estoque' },
                        { id: 1000, produto: '002', produtoNome: 'Bolo de Chocolate', tipo: 'saida', quantidade: 5, data: '15/05/2023 07:45', usuario: 'João', motivo: 'Venda' },
                        { id: 999, produto: '004', produtoNome: 'Café Expresso', tipo: 'entrada', quantidade: 30, data: '14/05/2023 18:20', usuario: 'Maria', motivo: 'Devolução de fornecedor' }
                    ]));
                }
                
                if (!localStorage.getItem('newbox_configuracoes')) {
                    localStorage.setItem('newbox_configuracoes', JSON.stringify({
                        nomeEmpresa: 'Padaria NewBox',
                        moeda: 'BRL',
                        fusoHorario: 'America/Sao_Paulo',
                        formatoData: 'DD/MM/AAAA',
                        taxaImposto: 18,
                        cnpj: '12.345.678/0001-90',
                        inscricaoEstadual: '123.456.789',
                        regimeTributario: 'simples',
                        temaContraste: 'normal',
                        idioma: 'pt-BR',
                        tamanhoFonte: 'normal'
                    }));
                }
                
                if (!localStorage.getItem('newbox_relatorios')) {
                    localStorage.setItem('newbox_relatorios', JSON.stringify([
                        { 
                            id: 1, 
                            nome: 'Relatório de Vendas - Maio 2023', 
                            tipo: 'Vendas', 
                            periodo: 'Mensal', 
                            geradoEm: '15/05/2023', 
                            geradoPor: 'Admin',
                            conteudo: {
                                titulo: 'Relatório de Vendas - Maio 2023',
                                periodo: '01/05/2023 - 15/05/2023',
                                resumo: {
                                    totalVendas: 'R$ 15.890,75',
                                    quantidadeVendas: 124,
                                    ticketMedio: 'R$ 128,15',
                                    produtoMaisVendido: 'Pão Francês (450 unidades)',
                                },
                                tabelaVendas: [
                                    { data: '15/05/2023', cliente: 'Maria Silva', valor: 'R$ 42,30', status: 'Concluído' },
                                    { data: '14/05/2023', cliente: 'João Santos', valor: 'R$ 68,75', status: 'Concluído' },
                                    { data: '13/05/2023', cliente: 'Ana Oliveira', valor: 'R$ 28,50', status: 'Concluído' },
                                    { data: '12/05/2023', cliente: 'Pedro Costa', valor: 'R$ 52,00', status: 'Cancelado' },
                                    { data: '11/05/2023', cliente: 'Lucia Ferreira', valor: 'R$ 35,20', status: 'Concluído' }
                                ]
                            }
                        },
                        { 
                            id: 2, 
                            nome: 'Relatório de Estoque - Maio 2023', 
                            tipo: 'Estoque', 
                            periodo: 'Mensal', 
                            geradoEm: '10/05/2023', 
                            geradoPor: 'Admin',
                            conteudo: {
                                titulo: 'Relatório de Estoque - Maio 2023',
                                periodo: '01/05/2023 - 10/05/2023',
                                resumo: {
                                    totalItens: 3250,
                                    produtosBaixo: 8,
                                    produtosZerados: 3,
                                    valorTotal: 'R$ 28.750,00'
                                },
                                tabelaEstoque: [
                                    { codigo: '001', nome: 'Pão Francês', estoque: 150, status: 'Em Estoque' },
                                    { codigo: '002', nome: 'Bolo de Chocolate', estoque: 8, status: 'Baixo Estoque' },
                                    { codigo: '003', nome: 'Pão de Queijo', estoque: 45, status: 'Em Estoque' },
                                    { codigo: '004', nome: 'Café Expresso', estoque: 0, status: 'Sem Estoque' },
                                    { codigo: '005', nome: 'Croissant', estoque: 12, status: 'Em Estoque' }
                                ]
                            }
                        },
                        { 
                            id: 3, 
                            nome: 'Relatório Financeiro - Q1 2023', 
                            tipo: 'Financeiro', 
                            periodo: 'Trimestral', 
                            geradoEm: '05/04/2023', 
                            geradoPor: 'Admin',
                            conteudo: {
                                titulo: 'Relatório Financeiro - Q1 2023',
                                periodo: '01/01/2023 - 31/03/2023',
                                resumo: {
                                    receitaTotal: 'R$ 145.780,00',
                                    despesaTotal: 'R$ 98.230,00',
                                    lucroLiquido: 'R$ 47.550,00',
                                    margemLucro: '32,6%'
                                },
                                receitas: {
                                    vendas: 'R$ 135.250,00',
                                    outras: 'R$ 10.530,00'
                                },
                                despesas: {
                                    insumos: 'R$ 58.400,00',
                                    pessoal: 'R$ 25.350,00',
                                    alugueis: 'R$ 7.500,00',
                                    marketing: 'R$ 2.800,00',
                                    outros: 'R$ 4.180,00'
                                }
                            }
                        }
                    ]));
                }
            },
            
            getUsuarios: function() {
                return JSON.parse(localStorage.getItem('newbox_usuarios')) || [];
            },
            
            getProdutos: function() {
                return JSON.parse(localStorage.getItem('newbox_produtos')) || [];
            },
            
            getCategorias: function() {
                return JSON.parse(localStorage.getItem('newbox_categorias')) || [];
            },
            
            getClientes: function() {
                return JSON.parse(localStorage.getItem('newbox_clientes')) || [];
            },
            
            getFornecedores: function() {
                return JSON.parse(localStorage.getItem('newbox_fornecedores')) || [];
            },
            
            getVendas: function() {
                return JSON.parse(localStorage.getItem('newbox_vendas')) || [];
            },
            
            getCompras: function() {
                return JSON.parse(localStorage.getItem('newbox_compras')) || [];
            },
            
            getMovimentacoes: function() {
                return JSON.parse(localStorage.getItem('newbox_movimentacoes')) || [];
            },
            
            getConfiguracoes: function() {
                return JSON.parse(localStorage.getItem('newbox_configuracoes')) || {};
            },
            
            getRelatorios: function() {
                return JSON.parse(localStorage.getItem('newbox_relatorios')) || [];
            },
            
            getRelatorioPorId: function(id) {
                const relatorios = this.getRelatorios();
                return relatorios.find(r => r.id == id) || null;
            },
            
            autenticaUsuario: function(username) {
                // Permite qualquer nome de usuário sem verificação de senha
                if (username) {
                    return { nome: username, funcao: 'Administrador' };
                }
                return null;
            },
            
            adicionarProduto: function(produto) {
                const produtos = this.getProdutos();
                produtos.push(produto);
                localStorage.setItem('newbox_produtos', JSON.stringify(produtos));
                
                // Também atualiza a contagem na categoria
                const categorias = this.getCategorias();
                const catIndex = categorias.findIndex(c => c.nome === produto.categoria);
                if (catIndex !== -1) {
                    categorias[catIndex].produtos++;
                    localStorage.setItem('newbox_categorias', JSON.stringify(categorias));
                }
            },
            
            editarProduto: function(produtoEditado) {
                const produtos = this.getProdutos();
                const index = produtos.findIndex(p => p.codigo === produtoEditado.codigo);
                if (index !== -1) {
                    // Verifica se a categoria mudou
                    const categoriaAntiga = produtos[index].categoria;
                    const categoriaNova = produtoEditado.categoria;
                    
                    // Atualiza o produto
                    produtos[index] = produtoEditado;
                    localStorage.setItem('newbox_produtos', JSON.stringify(produtos));
                    
                    // Atualiza contagens de categoria se necessário
                    if (categoriaAntiga !== categoriaNova) {
                        const categorias = this.getCategorias();
                        const catAntigaIndex = categorias.findIndex(c => c.nome === categoriaAntiga);
                        const catNovaIndex = categorias.findIndex(c => c.nome === categoriaNova);
                        
                        if (catAntigaIndex !== -1) {
                            categorias[catAntigaIndex].produtos--;
                        }
                        
                        if (catNovaIndex !== -1) {
                            categorias[catNovaIndex].produtos++;
                        }
                        
                        localStorage.setItem('newbox_categorias', JSON.stringify(categorias));
                    }
                    
                    return true;
                }
                return false;
            },
            
            excluirProduto: function(codigo) {
                const produtos = this.getProdutos();
                const index = produtos.findIndex(p => p.codigo === codigo);
                
                if (index !== -1) {
                    const categoriaProduto = produtos[index].categoria;
                    
                    // Remove o produto
                    produtos.splice(index, 1);
                    localStorage.setItem('newbox_produtos', JSON.stringify(produtos));
                    
                    // Atualiza a contagem na categoria
                    const categorias = this.getCategorias();
                    const catIndex = categorias.findIndex(c => c.nome === categoriaProduto);
                    if (catIndex !== -1) {
                        categorias[catIndex].produtos--;
                        localStorage.setItem('newbox_categorias', JSON.stringify(categorias));
                    }
                    
                    return true;
                }
                
                return false;
            },
            
            adicionarCategoria: function(categoria) {
                const categorias = this.getCategorias();
                // Gerar ID
                const lastId = categorias.length > 0 ? Math.max(...categorias.map(c => c.id)) : 0;
                categoria.id = lastId + 1;
                categoria.produtos = 0;
                categoria.status = 'ativo';
                categorias.push(categoria);
                localStorage.setItem('newbox_categorias', JSON.stringify(categorias));
                return categoria;
            },
            
            editarCategoria: function(categoriaEditada) {
                const categorias = this.getCategorias();
                const index = categorias.findIndex(c => c.id === parseInt(categoriaEditada.id));
                if (index !== -1) {
                    // Manter a contagem de produtos
                    categoriaEditada.produtos = categorias[index].produtos;
                    categorias[index] = categoriaEditada;
                    localStorage.setItem('newbox_categorias', JSON.stringify(categorias));
                    return true;
                }
                return false;
            },
            
            excluirCategoria: function(id) {
                const categorias = this.getCategorias();
                const index = categorias.findIndex(c => c.id === parseInt(id));
                
                if (index !== -1) {
                    // Verifica se há produtos nesta categoria
                    if (categorias[index].produtos > 0) {
                        // Neste caso, apenas marcamos como inativo em vez de excluir
                        categorias[index].status = 'inativo';
                    } else {
                        // Se não houver produtos, podemos excluir
                        categorias.splice(index, 1);
                    }
                    localStorage.setItem('newbox_categorias', JSON.stringify(categorias));
                    return true;
                }
                
                return false;
            },
            
            adicionarMovimentacao: function(movimentacao) {
                const movimentacoes = this.getMovimentacoes();
                // Gerar ID
                const lastId = movimentacoes.length > 0 ? Math.max(...movimentacoes.map(m => m.id)) : 0;
                movimentacao.id = lastId + 1;
                
                // Obter nome do produto
                const produtos = this.getProdutos();
                const produto = produtos.find(p => p.codigo === movimentacao.produto);
                if (produto) {
                    movimentacao.produtoNome = produto.nome;
                    
                    // Atualizar estoque do produto
                    const quantidade = parseInt(movimentacao.quantidade);
                    if (movimentacao.tipo === 'entrada') {
                        produto.estoque += quantidade;
                    } else if (movimentacao.tipo === 'saida') {
                        produto.estoque -= quantidade;
                        if (produto.estoque < 0) produto.estoque = 0;
                    }
                    
                    // Atualizar status do produto
                    if (produto.estoque <= 0) {
                        produto.status = 'sem_estoque';
                    } else if (produto.estoque < produto.estoqueMinimo) {
                        produto.status = 'baixo_estoque';
                    } else {
                        produto.status = 'em_estoque';
                    }
                    
                    // Salvar produto atualizado
                    const produtoIndex = produtos.findIndex(p => p.codigo === movimentacao.produto);
                    if (produtoIndex !== -1) {
                        produtos[produtoIndex] = produto;
                        localStorage.setItem('newbox_produtos', JSON.stringify(produtos));
                    }
                }
                
                movimentacoes.push(movimentacao);
                localStorage.setItem('newbox_movimentacoes', JSON.stringify(movimentacoes));
                return movimentacao;
            },
            
            getMovimentacaoPorId: function(id) {
                const movimentacoes = this.getMovimentacoes();
                return movimentacoes.find(m => m.id == id) || null;
            },
            
            adicionarCliente: function(cliente) {
                const clientes = this.getClientes();
                // Gerar ID
                const lastId = clientes.length > 0 ? parseInt(clientes[clientes.length - 1].id.replace('C', '')) : 0;
                cliente.id = `C${String(lastId + 1).padStart(3, '0')}`;
                clientes.push(cliente);
                localStorage.setItem('newbox_clientes', JSON.stringify(clientes));
                return cliente;
            },
            
            registrarVenda: function(venda) {
                const vendas = this.getVendas();
                // Gerar ID
                const lastId = vendas.length > 0 ? vendas[vendas.length - 1].id : 5870;
                venda.id = lastId + 1;
                vendas.push(venda);
                localStorage.setItem('newbox_vendas', JSON.stringify(vendas));
                
                // Atualiza o último registro de compra do cliente
                if (venda.cliente !== 'outro') {
                    const clientes = this.getClientes();
                    const clienteIndex = clientes.findIndex(c => c.id === venda.cliente);
                    if (clienteIndex !== -1) {
                        clientes[clienteIndex].ultimaCompra = venda.data.split(' ')[0];
                        clientes[clienteIndex].totalGasto += venda.total;
                        localStorage.setItem('newbox_clientes', JSON.stringify(clientes));
                    }
                }
                
                // Atualiza o estoque dos produtos
                if (venda.produtos && venda.produtos.length > 0) {
                    const produtos = this.getProdutos();
                    
                    venda.produtos.forEach(produtoVenda => {
                        const produtoIndex = produtos.findIndex(p => p.codigo === produtoVenda.id);
                        if (produtoIndex !== -1) {
                            // Registra a movimentação de saída
                            this.adicionarMovimentacao({
                                produto: produtoVenda.id,
                                produtoNome: produtoVenda.nome,
                                tipo: 'saida',
                                quantidade: produtoVenda.quantidade,
                                data: venda.data,
                                usuario: 'Sistema',
                                motivo: `Venda #${venda.id}`
                            });
                        }
                    });
                }
                
                return venda;
            },
            
            getVendaPorId: function(id) {
                const vendas = this.getVendas();
                return vendas.find(v => v.id == id) || null;
            },
            
            adicionarCompra: function(compra) {
                const compras = this.getCompras();
                compras.push(compra);
                localStorage.setItem('newbox_compras', JSON.stringify(compras));
                return compra;
            },
            
            editarCompra: function(compraEditada) {
                const compras = this.getCompras();
                const index = compras.findIndex(c => c.id === compraEditada.id);
                if (index !== -1) {
                    compras[index] = compraEditada;
                    localStorage.setItem('newbox_compras', JSON.stringify(compras));
                    return true;
                }
                return false;
            },
            
            getCompraPorId: function(id) {
                const compras = this.getCompras();
                return compras.find(c => c.id === id) || null;
            },
            
            filtrarCompras: function(filtro) {
                let compras = this.getCompras();
                
                if (filtro.status && filtro.status !== 'todos') {
                    compras = compras.filter(c => c.status === filtro.status);
                }
                
                if (filtro.data) {
                    compras = compras.filter(c => c.dataPedido === filtro.data || c.dataEntrega === filtro.data);
                }
                
                if (filtro.termo) {
                    const termo = filtro.termo.toLowerCase();
                    compras = compras.filter(c => 
                        c.id.toLowerCase().includes(termo) || 
                        c.fornecedorNome.toLowerCase().includes(termo) || 
                        c.itensDetalhados.some(item => item.produto.toLowerCase().includes(termo)) ||
                        c.total.toString().includes(termo) ||
                        c.dataPedido.includes(termo) ||
                        c.dataEntrega.includes(termo) ||
                        c.observacoes?.toLowerCase().includes(termo)
                    );
                }
                
                return compras;
            },
            
            gerarRelatorio: function(tipo, periodo, dataInicio, dataFim, incluirGraficos, incluirTabelas, incluirResumo) {
                const relatorios = this.getRelatorios();
                // Gerar ID
                const lastId = relatorios.length > 0 ? Math.max(...relatorios.map(r => r.id)) : 0;
                
                const hoje = new Date();
                const dataFormatada = hoje.toLocaleDateString('pt-BR');
                const periodoTexto = this.obterTextoPeriodo(periodo);
                
                let novoRelatorio = {
                    id: lastId + 1,
                    nome: `Relatório de ${this.obterTextoTipo(tipo)} - ${periodoTexto} ${hoje.getFullYear()}`,
                    tipo: this.obterTextoTipo(tipo),
                    periodo: periodoTexto,
                    geradoEm: dataFormatada,
                    geradoPor: document.getElementById('userDisplayName').textContent,
                    conteudo: {
                        titulo: `Relatório de ${this.obterTextoTipo(tipo)} - ${periodoTexto} ${hoje.getFullYear()}`,
                        periodo: `${dataInicio ? dataInicio.split('-').reverse().join('/') : '01/' + String(hoje.getMonth() + 1).padStart(2, '0') + '/' + hoje.getFullYear()} - ${dataFim ? dataFim.split('-').reverse().join('/') : dataFormatada}`,
                        resumo: this.gerarResumoPorTipo(tipo)
                    }
                };
                
                // Adicionar tabelas conforme tipo
                switch (tipo) {
                    case 'vendas':
                        novoRelatorio.conteudo.tabelaVendas = this.gerarTabelaVendas();
                        break;
                    case 'estoque':
                        novoRelatorio.conteudo.tabelaEstoque = this.gerarTabelaEstoque();
                        break;
                    case 'financeiro':
                        novoRelatorio.conteudo.receitas = this.gerarDadosReceitas();
                        novoRelatorio.conteudo.despesas = this.gerarDadosDespesas();
                        break;
                    case 'clientes':
                        novoRelatorio.conteudo.tabelaClientes = this.gerarTabelaClientes();
                        break;
                    case 'compras':
                        novoRelatorio.conteudo.tabelaCompras = this.gerarTabelaCompras();
                        break;
                }
                
                relatorios.push(novoRelatorio);
                localStorage.setItem('newbox_relatorios', JSON.stringify(relatorios));
                return novoRelatorio;
            },
            
            obterTextoTipo: function(tipo) {
                const tipos = {
                    'vendas': 'Vendas',
                    'estoque': 'Estoque',
                    'financeiro': 'Financeiro',
                    'clientes': 'Clientes',
                    'compras': 'Compras'
                };
                return tipos[tipo] || 'Personalizado';
            },
            
            obterTextoPeriodo: function(periodo) {
                const periodos = {
                    'diario': 'Diário',
                    'semanal': 'Semanal',
                    'mensal': 'Mensal',
                    'trimestral': 'Trimestral',
                    'anual': 'Anual'
                };
                return periodos[periodo] || 'Personalizado';
            },
            
            gerarResumoPorTipo: function(tipo) {
                const hoje = new Date();
                const resumos = {
                    'vendas': {
                        totalVendas: formatarMoeda(Math.random() * 20000 + 5000),
                        quantidadeVendas: Math.floor(Math.random() * 200 + 50),
                        ticketMedio: formatarMoeda(Math.random() * 150 + 50),
                        produtoMaisVendido: 'Pão Francês (450 unidades)'
                    },
                    'estoque': {
                        totalItens: Math.floor(Math.random() * 5000 + 1000),
                        produtosBaixo: Math.floor(Math.random() * 15 + 5),
                        produtosZerados: Math.floor(Math.random() * 5 + 1),
                        valorTotal: formatarMoeda(Math.random() * 50000 + 10000)
                    },
                    'financeiro': {
                        receitaTotal: formatarMoeda(Math.random() * 200000 + 50000),
                        despesaTotal: formatarMoeda(Math.random() * 150000 + 30000),
                        lucroLiquido: formatarMoeda(Math.random() * 50000 + 10000),
                        margemLucro: (Math.random() * 40 + 10).toFixed(1) + '%'
                    },
                    'clientes': {
                        totalClientes: Math.floor(Math.random() * 500 + 100),
                        clientesAtivos: Math.floor(Math.random() * 400 + 80),
                        clientesNovos: Math.floor(Math.random() * 50 + 10),
                        valorMedioPorCliente: formatarMoeda(Math.random() * 500 + 100)
                    },
                    'compras': {
                        totalCompras: formatarMoeda(Math.random() * 50000 + 10000),
                        quantidadeCompras: Math.floor(Math.random() * 50 + 10),
                        comprasPendentes: Math.floor(Math.random() * 10 + 2),
                        fornecedorPrincipal: 'Distribuidora de Farinhas Ltda'
                    }
                };
                
                return resumos[tipo] || resumos['vendas'];
            },
            
            gerarTabelaVendas: function() {
                const vendas = this.getVendas();
                return vendas.slice(0, 5).map(v => ({
                    data: v.data.split(' ')[0],
                    cliente: v.clienteNome,
                    valor: formatarMoeda(v.total),
                    status: getStatusText(v.status, 'venda')
                }));
            },
            
            gerarTabelaEstoque: function() {
                const produtos = this.getProdutos();
                return produtos.slice(0, 5).map(p => ({
                    codigo: p.codigo,
                    nome: p.nome,
                    estoque: p.estoque,
                    status: getStatusText(p.status, 'produto')
                }));
            },
            
            gerarDadosReceitas: function() {
                return {
                    vendas: formatarMoeda(Math.random() * 180000 + 40000),
                    outras: formatarMoeda(Math.random() * 20000 + 5000)
                };
            },
            
            gerarDadosDespesas: function() {
                return {
                    insumos: formatarMoeda(Math.random() * 80000 + 20000),
                    pessoal: formatarMoeda(Math.random() * 40000 + 15000),
                    alugueis: formatarMoeda(Math.random() * 10000 + 5000),
                    marketing: formatarMoeda(Math.random() * 5000 + 1000),
                    outros: formatarMoeda(Math.random() * 8000 + 2000)
                };
            },
            
            gerarTabelaClientes: function() {
                const clientes = this.getClientes();
                return clientes.slice(0, 5).map(c => ({
                    id: c.id,
                    nome: c.nome,
                    email: c.email,
                    ultimaCompra: c.ultimaCompra,
                    totalGasto: formatarMoeda(c.totalGasto)
                }));
            },
            
            gerarTabelaCompras: function() {
                const compras = this.getCompras();
                return compras.map(c => ({
                    pedido: c.id,
                    fornecedor: c.fornecedorNome,
                    dataPedido: c.dataPedido,
                    valor: formatarMoeda(c.total),
                    status: getStatusText(c.status, 'compra')
                }));
            },
            
            atualizarConfiguracoes: function(config) {
                localStorage.setItem('newbox_configuracoes', JSON.stringify(config));
            },
            
            // Adiciona função para atualizar moeda
            atualizarMoeda: function(moeda) {
                const config = this.getConfiguracoes();
                config.moeda = moeda;
                this.atualizarConfiguracoes(config);
                return this.formatarMoeda(1234.56); // Retorna exemplo formatado
            },
            
            // Função para formatar moeda
            formatarMoeda: function(valor) {
                const config = this.getConfiguracoes();
                const formatadores = {
                    'BRL': new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }),
                    'USD': new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }),
                    'EUR': new Intl.NumberFormat('de-DE', { style: 'currency', currency: 'EUR' })
                };
                return formatadores[config.moeda].format(valor);
            },
            
            // Função para formatar data
            formatarData: function(data) {
                const config = this.getConfiguracoes();
                const formatadores = {
                    'DD/MM/AAAA': new Intl.DateTimeFormat('pt-BR'),
                    'MM/DD/AAAA': new Intl.DateTimeFormat('en-US'),
                    'AAAA-MM-DD': new Intl.DateTimeFormat('sv-SE')
                };
                return formatadores[config.formatoData].format(new Date(data));
            },
            
            // Função para gerar dados do balanço
            gerarDadosBalanco: function(periodo) {
                const dadosPeriodo = {
                    atual: {
                        ativos: {
                            circulantes: {
                                caixa: 45750.00,
                                contasReceber: 23680.50,
                                estoques: 38420.75,
                                adiantamentos: 5200.00
                            },
                            naoCirculantes: {
                                investimentos: 75000.00,
                                imobilizado: 120500.00,
                                intangivel: 15750.00
                            }
                        },
                        passivos: {
                            circulantes: {
                                contasPagar: 18640.30,
                                emprestimosCP: 35000.00,
                                salariosPagar: 22750.00,
                                impostos: 12850.45
                            },
                            naoCirculantes: {
                                emprestimosLP: 85000.00,
                                provisoes: 25300.00
                            },
                            patrimonioLiquido: {
                                capitalSocial: 100000.00,
                                lucrosAcumulados: 24760.50
                            }
                        }
                    },
                    mensal: {
                        ativos: {
                            circulantes: {
                                caixa: 52000.00,
                                contasReceber: 28000.00,
                                estoques: 42000.00,
                                adiantamentos: 6000.00
                            },
                            naoCirculantes: {
                                investimentos: 78000.00,
                                imobilizado: 125000.00,
                                intangivel: 16000.00
                            }
                        },
                        passivos: {
                            circulantes: {
                                contasPagar: 20000.00,
                                emprestimosCP: 38000.00,
                                salariosPagar: 24000.00,
                                impostos: 14000.00
                            },
                            naoCirculantes: {
                                emprestimosLP: 88000.00,
                                provisoes: 26000.00
                            },
                            patrimonioLiquido: {
                                capitalSocial: 100000.00,
                                lucrosAcumulados: 27000.00
                            }
                        }
                    },
                    anual: {
                        ativos: {
                            circulantes: {
                                caixa: 60000.00,
                                contasReceber: 32000.00,
                                estoques: 45000.00,
                                adiantamentos: 7000.00
                            },
                            naoCirculantes: {
                                investimentos: 82000.00,
                                imobilizado: 130000.00,
                                intangivel: 18000.00
                            }
                        },
                        passivos: {
                            circulantes: {
                                contasPagar: 22000.00,
                                emprestimosCP: 40000.00,
                                salariosPagar: 26000.00,
                                impostos: 15000.00
                            },
                            naoCirculantes: {
                                emprestimosLP: 90000.00,
                                provisoes: 28000.00
                            },
                            patrimonioLiquido: {
                                capitalSocial: 100000.00,
                                lucrosAcumulados: 30000.00
                            }
                        }
                    }
                };
                
                return dadosPeriodo[periodo];
            }
        };
        
        // Inicializa o banco de dados
        DB.init();
        
        // FUNÇÕES DE APOIO
        function formatarMoeda(valor) {
            return DB.formatarMoeda(valor);
        }
        
        function getStatusClass(status, tipo) {
            if (tipo === 'produto') {
                switch(status) {
                    case 'em_estoque': return 'status-success';
                    case 'baixo_estoque': return 'status-warning';
                    case 'sem_estoque': return 'status-danger';
                    default: return '';
                }
            } else if (tipo === 'venda') {
                switch(status) {
                    case 'concluido': return 'status-success';
                    case 'preparando': return 'status-warning';
                    case 'cancelado': return 'status-danger';
                    default: return '';
                }
            } else if (tipo === 'compra') {
                switch(status) {
                    case 'entregue': return 'status-success';
                    case 'pendente': return 'status-warning';
                    case 'cancelado': return 'status-danger';
                    default: return '';
                }
            } else if (tipo === 'movimentacao') {
                switch(status) {
                    case 'entrada': return 'status-success';
                    case 'saida': return 'status-danger';
                    default: return '';
                }
            } else if (tipo === 'usuario' || tipo === 'cliente' || tipo === 'fornecedor' || tipo === 'categoria') {
                switch(status) {
                    case 'ativo': return 'status-success';
                    case 'inativo': return 'status-danger';
                    default: return '';
                }
            }
            return '';
        }
        
        function getStatusText(status, tipo) {
            if (tipo === 'produto') {
                switch(status) {
                    case 'em_estoque': return 'Em Estoque';
                    case 'baixo_estoque': return 'Baixo Estoque';
                    case 'sem_estoque': return 'Sem Estoque';
                    default: return '';
                }
            } else if (tipo === 'venda') {
                switch(status) {
                    case 'concluido': return 'Concluído';
                    case 'preparando': return 'Preparando';
                    case 'cancelado': return 'Cancelado';
                    default: return '';
                }
            } else if (tipo === 'compra') {
                switch(status) {
                    case 'entregue': return 'Entregue';
                    case 'pendente': return 'Pendente';
                    case 'cancelado': return 'Cancelado';
                    default: return '';
                }
            } else if (tipo === 'movimentacao') {
                switch(status) {
                    case 'entrada': return 'Entrada';
                    case 'saida': return 'Saída';
                    default: return '';
                }
            } else if (tipo === 'usuario' || tipo === 'cliente' || tipo === 'fornecedor' || tipo === 'categoria') {
                switch(status) {
                    case 'ativo': return 'Ativo';
                    case 'inativo': return 'Inativo';
                    default: return '';
                }
            }
            return '';
        }
        
        // Função para mostrar notificações
        function mostrarNotificacao(mensagem, duracao = 3000) {
            const notificacao = document.getElementById('notification');
            notificacao.textContent = mensagem;
            notificacao.classList.add('active');
            
            setTimeout(() => {
                notificacao.classList.remove('active');
            }, duracao);
        }
        
        // LOGIN PAGE FUNCTIONS
        document.getElementById('loginBtn').addEventListener('click', function() {
            document.getElementById('loginForm').classList.add('active');
            this.style.display = 'none';
        });
        
        document.getElementById('backBtn').addEventListener('click', function() {
            document.getElementById('loginForm').classList.remove('active');
            document.getElementById('loginBtn').style.display = 'block';
        });
        
        document.getElementById('loginFormElement').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            
            // Permite acesso direto se houver qualquer nome de usuário
            if (username) {
                const usuario = DB.autenticaUsuario(username);
                
                if (usuario) {
                    // Esconde a página de login e mostra o dashboard
                    document.getElementById('loginPage').style.display = 'none';
                    document.getElementById('dashboardPage').classList.add('active');
                    document.body.classList.remove('login-page');
                    document.body.classList.add('dashboard-page');
                    
                    // Atualiza o nome do usuário
                    document.getElementById('userDisplayName').textContent = usuario.nome;
                    document.getElementById('welcomeUserName').textContent = usuario.nome;
                    
                    // Carrega configurações do usuário
                    carregarConfiguracoes();
                    
                    // Inicializa o balanço patrimonial
                    initializeBalanceSheet();
                    
                    // Inicializa a paginação para produtos
                    initializeProdutosPagination();
                    
                    // Inicializa a funcionalidade dos botões de visualizar venda e recibo
                    initializeViewSaleButtons();
                    
                    // Inicializa as funcionalidades de categorias
                    initializeCategoriasFunctionality();
                    
                    // Inicializa as funcionalidades de movimentações
                    initializeMovimentacoesFunctionality();
                    
                    // Inicializa a paginação de vendas
                    initializeVendasPagination();
                    
                    // Inicializar funcionalidades de compras
                    initializeComprasFunctionality();
                    
                    // Inicializar funcionalidades de relatórios
                    initializeRelatoriosFunctionality();
                    
                    // Mostrar notificação de boas-vindas
                    mostrarNotificacao(`Bem-vindo ao NewBox, ${usuario.nome}!`);
                }
            } else {
                alert('Por favor, digite um nome de usuário.');
            }
        });
        
        // Função para carregar configurações
        function carregarConfiguracoes() {
            const config = DB.getConfiguracoes();
            
            // Aplica o tema de contraste
            if (config.temaContraste === 'alto') {
                document.body.classList.add('high-contrast');
                document.getElementById('contrasteAlto').classList.add('active');
                document.getElementById('contrasteNormal').classList.remove('active');
            } else {
                document.body.classList.remove('high-contrast');
                document.getElementById('contrasteNormal').classList.add('active');
                document.getElementById('contrasteAlto').classList.remove('active');
            }
            
            // Aplica o tamanho da fonte
            if (config.tamanhoFonte === 'pequeno') {
                document.documentElement.style.fontSize = '0.9rem';
                document.getElementById('fontePequena').classList.add('active');
                document.getElementById('fonteNormal').classList.remove('active');
                document.getElementById('fonteGrande').classList.remove('active');
            } else if (config.tamanhoFonte === 'grande') {
                document.documentElement.style.fontSize = '1.1rem';
                document.getElementById('fonteGrande').classList.add('active');
                document.getElementById('fonteNormal').classList.remove('active');
                document.getElementById('fontePequena').classList.remove('active');
            } else {
                document.documentElement.style.fontSize = '1rem';
                document.getElementById('fonteNormal').classList.add('active');
                document.getElementById('fontePequena').classList.remove('active');
                document.getElementById('fonteGrande').classList.remove('active');
            }
            
            // Preenche os campos do formulário de configurações
            document.getElementById('nomeEmpresa').value = config.nomeEmpresa;
            document.getElementById('moeda').value = config.moeda;
            document.getElementById('fusoHorario').value = config.fusoHorario;
            document.getElementById('formatoData').value = config.formatoData;
            document.getElementById('taxaImposto').value = config.taxaImposto;
            document.getElementById('cnpj').value = config.cnpj;
            document.getElementById('inscricaoEstadual').value = config.inscricaoEstadual;
            document.getElementById('regimeTributario').value = config.regimeTributario;
            document.getElementById('idioma').value = config.idioma;
        }
        
        // BOTÃO DE LOGOUT
        document.getElementById('logoutBtn').addEventListener('click', function() {
            document.getElementById('dashboardPage').classList.remove('active');
            document.getElementById('loginPage').style.display = 'block';
            document.body.classList.add('login-page');
            document.body.classList.remove('dashboard-page');
            document.getElementById('loginForm').classList.remove('active');
            document.getElementById('loginBtn').style.display = 'block';
            document.getElementById('username').value = '';
        });
        
        // DASHBOARD PAGE FUNCTIONS
        // Navigation between sections
        document.querySelectorAll('.nav-item').forEach(function(item) {
            item.addEventListener('click', function() {
                // Remove active class from all items
                document.querySelectorAll('.nav-item').forEach(function(navItem) {
                    navItem.classList.remove('active');
                });
                
                // Add active class to clicked item
                this.classList.add('active');
                
                // Hide all sections
                document.querySelectorAll('.section').forEach(function(section) {
                    section.classList.remove('active');
                });
                
                // Show selected section
                const sectionId = this.getAttribute('data-section');
                document.getElementById(sectionId).classList.add('active');
                
                // Reinicializa o balanço se a seção de dashboard estiver ativa
                if (sectionId === 'dashboard') {
                    initializeBalanceSheet();
                }
                
                // Reinicializa a paginação se a seção de produtos estiver ativa
                if (sectionId === 'produtos') {
                    initializeProdutosPagination();
                }
                
                // Se for a seção de relatórios, esconde o relatório personalizado por padrão
                if (sectionId === 'relatorios') {
                    document.getElementById('relatorioPersonalizado').style.display = 'none';
                    document.getElementById('reportContainer').classList.remove('active');
                }
            });
        });
        
        // Tabs
        document.querySelectorAll('.tab').forEach(function(tab) {
            tab.addEventListener('click', function() {
                const tabsContainer = this.closest('.tabs');
                tabsContainer.querySelectorAll('.tab').forEach(function(t) {
                    t.classList.remove('active');
                });
                this.classList.add('active');
                
                // Se for a aba de relatórios personalizados, mostra o formulário
                if (this.getAttribute('data-tab') === 'personalizados') {
                    document.getElementById('relatorioPersonalizado').style.display = 'block';
                } else {
                    document.getElementById('relatorioPersonalizado').style.display = 'none';
                }
                
                // Esconde qualquer relatório gerado
                document.getElementById('reportContainer').classList.remove('active');
            });
        });
        
        // Modal Functions
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        // BALANÇO PATRIMONIAL FUNCTIONS
        function initializeBalanceSheet() {
            // Inicializa com o período atual
            atualizarBalanco('atual');
            
            // Adiciona eventos aos botões de período
            document.querySelectorAll('.balance-period-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.balance-period-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    const periodo = this.getAttribute('data-period');
                    atualizarBalanco(periodo);
                    
                    // Também atualiza o select
                    document.getElementById('balancoPeriodoSelect').value = periodo;
                });
            });
            
            // Adiciona evento ao select de período
            document.getElementById('balancoPeriodoSelect').addEventListener('change', function() {
                const periodo = this.value;
                atualizarBalanco(periodo);
                
                // Também atualiza os botões
                document.querySelectorAll('.balance-period-btn').forEach(btn => {
                    if (btn.getAttribute('data-period') === periodo) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });
            });
            
            // Calcula a largura das barras de progresso iniciais
            calcularProgressoBars();
        }
        
        function atualizarBalanco(periodo) {
            // Mostra o indicador de carregamento
            document.getElementById('balanceLoading').classList.add('active');
            
            // Simula um delay de carregamento (para efeito visual)
            setTimeout(() => {
                // Obtém os dados do balanço
                const dados = DB.gerarDadosBalanco(periodo);
                
                // Atualiza os valores do balanço
                // Ativos Circulantes
                document.querySelector('[data-balanco="caixa"]').textContent = formatarMoeda(dados.ativos.circulantes.caixa);
                document.querySelector('[data-balanco="contasReceber"]').textContent = formatarMoeda(dados.ativos.circulantes.contasReceber);
                document.querySelector('[data-balanco="estoques"]').textContent = formatarMoeda(dados.ativos.circulantes.estoques);
                document.querySelector('[data-balanco="adiantamentos"]').textContent = formatarMoeda(dados.ativos.circulantes.adiantamentos);
                
                // Ativos Não Circulantes
                document.querySelector('[data-balanco="investimentos"]').textContent = formatarMoeda(dados.ativos.naoCirculantes.investimentos);
                document.querySelector('[data-balanco="imobilizado"]').textContent = formatarMoeda(dados.ativos.naoCirculantes.imobilizado);
                document.querySelector('[data-balanco="intangivel"]').textContent = formatarMoeda(dados.ativos.naoCirculantes.intangivel);
                
                // Passivos Circulantes
                document.querySelector('[data-balanco="contasPagar"]').textContent = formatarMoeda(dados.passivos.circulantes.contasPagar);
                document.querySelector('[data-balanco="emprestimosCP"]').textContent = formatarMoeda(dados.passivos.circulantes.emprestimosCP);
                document.querySelector('[data-balanco="salariosPagar"]').textContent = formatarMoeda(dados.passivos.circulantes.salariosPagar);
                document.querySelector('[data-balanco="impostos"]').textContent = formatarMoeda(dados.passivos.circulantes.impostos);
                
                // Passivos Não Circulantes
                document.querySelector('[data-balanco="emprestimosLP"]').textContent = formatarMoeda(dados.passivos.naoCirculantes.emprestimosLP);
                document.querySelector('[data-balanco="provisoes"]').textContent = formatarMoeda(dados.passivos.naoCirculantes.provisoes);
                
                // Patrimônio Líquido
                document.querySelector('[data-balanco="capitalSocial"]').textContent = formatarMoeda(dados.passivos.patrimonioLiquido.capitalSocial);
                document.querySelector('[data-balanco="lucrosAcumulados"]').textContent = formatarMoeda(dados.passivos.patrimonioLiquido.lucrosAcumulados);
                
                // Calcula os totais
                const totalAtivos = 
                    dados.ativos.circulantes.caixa + 
                    dados.ativos.circulantes.contasReceber + 
                    dados.ativos.circulantes.estoques + 
                    dados.ativos.circulantes.adiantamentos + 
                    dados.ativos.naoCirculantes.investimentos + 
                    dados.ativos.naoCirculantes.imobilizado + 
                    dados.ativos.naoCirculantes.intangivel;
                
                const totalPassivos = 
                    dados.passivos.circulantes.contasPagar + 
                    dados.passivos.circulantes.emprestimosCP + 
                    dados.passivos.circulantes.salariosPagar + 
                    dados.passivos.circulantes.impostos + 
                    dados.passivos.naoCirculantes.emprestimosLP + 
                    dados.passivos.naoCirculantes.provisoes + 
                    dados.passivos.patrimonioLiquido.capitalSocial + 
                    dados.passivos.patrimonioLiquido.lucrosAcumulados;
                
                document.querySelector('[data-balanco="totalAtivos"]').textContent = formatarMoeda(totalAtivos);
                document.querySelector('[data-balanco="totalPassivos"]').textContent = formatarMoeda(totalPassivos);
                
                // Atualiza as barras de progresso
                calcularProgressoBars();
                
                // Esconde o indicador de carregamento
                document.getElementById('balanceLoading').classList.remove('active');
                
                // Animação de entrada para os números
                const valores = document.querySelectorAll('.balance-item-value, .balance-sheet-total > div:last-child');
                valores.forEach((valor, index) => {
                    setTimeout(() => {
                        valor.style.transform = 'scale(1.1)';
                        setTimeout(() => {
                            valor.style.transform = 'scale(1)';
                        }, 200);
                    }, index * 50);
                });
                
                // Mostra notificação
                mostrarNotificacao(`Balanço patrimonial atualizado para o período ${periodo}.`);
            }, 800);
        }
        
        function calcularProgressoBars() {
            // Calcula a largura das barras de progresso para os ativos circulantes
            const valorCaixa = parseFloat(document.querySelector('[data-balanco="caixa"]').textContent.replace(/[^\d,]/g, '').replace(',', '.'));
            const valorContasReceber = parseFloat(document.querySelector('[data-balanco="contasReceber"]').textContent.replace(/[^\d,]/g, '').replace(',', '.'));
            const valorEstoques = parseFloat(document.querySelector('[data-balanco="estoques"]').textContent.replace(/[^\d,]/g, '').replace(',', '.'));
            const valorAdiantamentos = parseFloat(document.querySelector('[data-balanco="adiantamentos"]').textContent.replace(/[^\d,]/g, '').replace(',', '.'));
            
            const totalAtivosCirulantes = valorCaixa + valorContasReceber + valorEstoques + valorAdiantamentos;
            
            if (totalAtivosCirulantes > 0) {
                document.getElementById('progressCaixa').style.width = `${(valorCaixa / totalAtivosCirulantes * 100).toFixed(0)}%`;
                document.getElementById('progressContasReceber').style.width = `${(valorContasReceber / totalAtivosCirulantes * 100).toFixed(0)}%`;
                document.getElementById('progressEstoques').style.width = `${(valorEstoques / totalAtivosCirulantes * 100).toFixed(0)}%`;
                document.getElementById('progressAdiantamentos').style.width = `${(valorAdiantamentos / totalAtivosCirulantes * 100).toFixed(0)}%`;
            }
            
            // Calcula a largura das barras de progresso para os ativos não circulantes
            const valorInvestimentos = parseFloat(document.querySelector('[data-balanco="investimentos"]').textContent.replace(/[^\d,]/g, '').replace(',', '.'));
            const valorImobilizado = parseFloat(document.querySelector('[data-balanco="imobilizado"]').textContent.replace(/[^\d,]/g, '').replace(',', '.'));
            const valorIntangivel = parseFloat(document.querySelector('[data-balanco="intangivel"]').textContent.replace(/[^\d,]/g, '').replace(',', '.'));
            
            const totalAtivosNaoCirculantes = valorInvestimentos + valorImobilizado + valorIntangivel;
            
            if (totalAtivosNaoCirculantes > 0) {
                document.getElementById('progressInvestimentos').style.width = `${(valorInvestimentos / totalAtivosNaoCirculantes * 100).toFixed(0)}%`;
                document.getElementById('progressImobilizado').style.width = `${(valorImobilizado / totalAtivosNaoCirculantes * 100).toFixed(0)}%`;
                document.getElementById('progressIntangivel').style.width = `${(valorIntangivel / totalAtivosNaoCirculantes * 100).toFixed(0)}%`;
            }
            
            // Calcula a largura das barras de progresso para os passivos circulantes
            const valorContasPagar = parseFloat(document.querySelector('[data-balanco="contasPagar"]').textContent.replace(/[^\d,]/g, '').replace(',', '.'));
            const valorEmprestimosCP = parseFloat(document.querySelector('[data-balanco="emprestimosCP"]').textContent.replace(/[^\d,]/g, '').replace(',', '.'));
            const valorSalariosPagar = parseFloat(document.querySelector('[data-balanco="salariosPagar"]').textContent.replace(/[^\d,]/g, '').replace(',', '.'));
            const valorImpostos = parseFloat(document.querySelector('[data-balanco="impostos"]').textContent.replace(/[^\d,]/g, '').replace(',', '.'));
            
            const totalPassivosCirculantes = valorContasPagar + valorEmprestimosCP + valorSalariosPagar + valorImpostos;
            
            if (totalPassivosCirculantes > 0) {
                document.getElementById('progressContasPagar').style.width = `${(valorContasPagar / totalPassivosCirculantes * 100).toFixed(0)}%`;
                document.getElementById('progressEmprestimosCP').style.width = `${(valorEmprestimosCP / totalPassivosCirculantes * 100).toFixed(0)}%`;
                document.getElementById('progressSalariosPagar').style.width = `${(valorSalariosPagar / totalPassivosCirculantes * 100).toFixed(0)}%`;
                document.getElementById('progressImpostos').style.width = `${(valorImpostos / totalPassivosCirculantes * 100).toFixed(0)}%`;
            }
            
            // Calcula a largura das barras de progresso para os passivos não circulantes
            const valorEmprestimosLP = parseFloat(document.querySelector('[data-balanco="emprestimosLP"]').textContent.replace(/[^\d,]/g, '').replace(',', '.'));
            const valorProvisoes = parseFloat(document.querySelector('[data-balanco="provisoes"]').textContent.replace(/[^\d,]/g, '').replace(',', '.'));
            
            const totalPassivosNaoCirculantes = valorEmprestimosLP + valorProvisoes;
            
            if (totalPassivosNaoCirculantes > 0) {
                document.getElementById('progressEmprestimosLP').style.width = `${(valorEmprestimosLP / totalPassivosNaoCirculantes * 100).toFixed(0)}%`;
                document.getElementById('progressProvisoes').style.width = `${(valorProvisoes / totalPassivosNaoCirculantes * 100).toFixed(0)}%`;
            }
            
            // Calcula a largura das barras de progresso para o patrimônio líquido
            const valorCapitalSocial = parseFloat(document.querySelector('[data-balanco="capitalSocial"]').textContent.replace(/[^\d,]/g, '').replace(',', '.'));
            const valorLucrosAcumulados = parseFloat(document.querySelector('[data-balanco="lucrosAcumulados"]').textContent.replace(/[^\d,]/g, '').replace(',', '.'));
            
            const totalPatrimonioLiquido = valorCapitalSocial + valorLucrosAcumulados;
            
            if (totalPatrimonioLiquido > 0) {
                document.getElementById('progressCapitalSocial').style.width = `${(valorCapitalSocial / totalPatrimonioLiquido * 100).toFixed(0)}%`;
                document.getElementById('progressLucrosAcumulados').style.width = `${(valorLucrosAcumulados / totalPatrimonioLiquido * 100).toFixed(0)}%`;
            }
        }
        
        // Inicializar paginação de produtos
        function initializeProdutosPagination() {
            const ITEMS_PER_PAGE = 10;
            let currentPage = 1;
            
            function renderPage(page) {
                // Obter todos os produtos
                const produtos = DB.getProdutos();
                
                // Calcular páginas totais
                const totalPages = Math.ceil(produtos.length / ITEMS_PER_PAGE);
                
                // Pegar os produtos para a página atual
                const start = (page - 1) * ITEMS_PER_PAGE;
                const end = start + ITEMS_PER_PAGE;
                const produtosPagina = produtos.slice(start, end);
                
                // Limpar a tabela
                const tbody = document.querySelector('#produtosTable tbody');
                tbody.innerHTML = '';
                
                // Preencher a tabela com os produtos da página atual
                produtosPagina.forEach(produto => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${produto.codigo}</td>
                        <td>${produto.nome}</td>
                        <td>${produto.categoria}</td>
                        <td>${formatarMoeda(produto.preco)}</td>
                        <td>${produto.estoque}</td>
                        <td><span class="status ${getStatusClass(produto.status, 'produto')}">${getStatusText(produto.status, 'produto')}</span></td>
                        <td class="action-cell">
                            <button class="action-btn edit-product-btn" data-id="${produto.codigo}"><i class="material-icons">edit</i></button>
                            <button class="action-btn delete-product-btn" data-id="${produto.codigo}"><i class="material-icons">delete</i></button>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
                
                // Atualizar botões de paginação
                updatePaginationButtons(page, totalPages);
                
                // Adicionar evento aos botões de editar e excluir
                addProductActionEvents();
            }
            
            function updatePaginationButtons(currentPage, totalPages) {
                // Limpar botões de página existentes
                const paginationContainer = document.querySelector('#produtos .pagination');
                const buttonsToRemove = paginationContainer.querySelectorAll('[data-page]');
                buttonsToRemove.forEach(btn => btn.remove());
                
                // Adicionar botões de página
                const prevBtn = document.getElementById('prevPageBtn');
                const nextBtn = document.getElementById('nextPageBtn');
                
                // Limitar a quantidade de botões de página exibidos
                let startPage = Math.max(1, currentPage - 1);
                let endPage = Math.min(totalPages, startPage + 2);
                
                if (endPage - startPage < 2) {
                    startPage = Math.max(1, endPage - 2);
                }
                
                for (let i = startPage; i <= endPage; i++) {
                    const btn = document.createElement('button');
                    btn.classList.add('pagination-btn');
                    btn.setAttribute('data-page', i);
                    btn.textContent = i;
                    
                    if (i === currentPage) {
                        btn.classList.add('active');
                    }
                    
                    // Inserir antes do botão "próximo"
                    paginationContainer.insertBefore(btn, nextBtn);
                }
                
                // Desabilitar botões prev/next quando necessário
                prevBtn.disabled = currentPage === 1;
                nextBtn.disabled = currentPage === totalPages;
                
                // Adicionar eventos aos botões de página
                document.querySelectorAll('#produtos .pagination [data-page]').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const page = parseInt(this.getAttribute('data-page'));
                        renderPage(page);
                        currentPage = page;
                    });
                });
            }
            
            function addProductActionEvents() {
                // Adicionar evento aos botões de editar
                document.querySelectorAll('.edit-product-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const produtoId = this.getAttribute('data-id');
                        openEditProductModal(produtoId);
                    });
                });
                
                // Adicionar evento aos botões de excluir
                document.querySelectorAll('.delete-product-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const produtoId = this.getAttribute('data-id');
                        openDeleteProductModal(produtoId);
                    });
                });
            }
            
            // Adicionar evento ao botão de página anterior
            document.getElementById('prevPageBtn').addEventListener('click', function() {
                if (currentPage > 1) {
                    currentPage--;
                    renderPage(currentPage);
                }
            });
            
            // Adicionar evento ao botão de próxima página
            document.getElementById('nextPageBtn').addEventListener('click', function() {
                const totalPages = Math.ceil(DB.getProdutos().length / ITEMS_PER_PAGE);
                if (currentPage < totalPages) {
                    currentPage++;
                    renderPage(currentPage);
                }
            });
            
            // Inicializar a primeira página
            renderPage(currentPage);
        }

        // Função para abrir modal de edição de produto
        function openEditProductModal(produtoId) {
            const produto = DB.getProdutos().find(p => p.codigo === produtoId);
            if (!produto) return;
            
            // Preencher o formulário com os dados do produto
            document.getElementById('editProdutoId').value = produto.codigo;
            document.getElementById('editProdutoCodigo').value = produto.codigo;
            document.getElementById('editProdutoNome').value = produto.nome;
            document.getElementById('editProdutoCategoria').value = produto.categoria;
            document.getElementById('editProdutoPreco').value = produto.preco;
            document.getElementById('editProdutoEstoque').value = produto.estoque;
            document.getElementById('editProdutoEstoqueMinimo').value = produto.estoqueMinimo;
            document.getElementById('editProdutoDescricao').value = produto.descricao || '';
            
            // Abrir o modal
            openModal('editarProdutoModal');
        }
        
        // Função para abrir modal de exclusão de produto
        function openDeleteProductModal(produtoId) {
            const produto = DB.getProdutos().find(p => p.codigo === produtoId);
            if (!produto) return;
            
            // Preencher informações no modal
            document.getElementById('produtoExcluirId').value = produto.codigo;
            document.getElementById('produtoExcluirNome').textContent = produto.nome;
            
            // Abrir o modal
            openModal('confirmarExclusaoModal');
        }
        
        // Evento para salvar edição de produto
        document.getElementById('salvarEditarProduto').addEventListener('click', function() {
            const produtoId = document.getElementById('editProdutoId').value;
            const produtoCodigo = document.getElementById('editProdutoCodigo').value;
            const produtoNome = document.getElementById('editProdutoNome').value;
            const produtoCategoria = document.getElementById('editProdutoCategoria').value;
            const produtoPreco = parseFloat(document.getElementById('editProdutoPreco').value);
            const produtoEstoque = parseInt(document.getElementById('editProdutoEstoque').value);
            const produtoEstoqueMinimo = parseInt(document.getElementById('editProdutoEstoqueMinimo').value);
            const produtoDescricao = document.getElementById('editProdutoDescricao').value;
            
            if (!produtoCodigo || !produtoNome || !produtoCategoria || isNaN(produtoPreco) || isNaN(produtoEstoque) || isNaN(produtoEstoqueMinimo)) {
                alert('Preencha todos os campos obrigatórios corretamente.');
                return;
            }
            
            // Determinar status do produto
            let status;
            if (produtoEstoque <= 0) {
                status = 'sem_estoque';
            } else if (produtoEstoque < produtoEstoqueMinimo) {
                status = 'baixo_estoque';
            } else {
                status = 'em_estoque';
            }
            
            const produtoEditado = {
                codigo: produtoCodigo,
                nome: produtoNome,
                categoria: produtoCategoria,
                preco: produtoPreco,
                estoque: produtoEstoque,
                estoqueMinimo: produtoEstoqueMinimo,
                descricao: produtoDescricao,
                status: status
            };
            
            // Atualizar o produto no banco de dados
            const sucesso = DB.editarProduto(produtoEditado);
            
            if (sucesso) {
                mostrarNotificacao('Produto atualizado com sucesso!');
                
                // Atualizar a tabela
                initializeProdutosPagination();
                
                // Fechar o modal
                closeModal('editarProdutoModal');
            } else {
                mostrarNotificacao('Erro ao atualizar o produto. Tente novamente.', 'error');
            }
        });
        
        // Evento para cancelar edição de produto
        document.getElementById('cancelarEditarProduto').addEventListener('click', function() {
            closeModal('editarProdutoModal');
        });
        
        // Evento para fechar modal de edição de produto com o X
        document.getElementById('closeEditarProdutoModal').addEventListener('click', function() {
            closeModal('editarProdutoModal');
        });
        
        // Evento para confirmar exclusão de produto
        document.getElementById('confirmarExclusao').addEventListener('click', function() {
            const produtoId = document.getElementById('produtoExcluirId').value;
            
            // Excluir o produto do banco de dados
            const sucesso = DB.excluirProduto(produtoId);
            
            if (sucesso) {
                mostrarNotificacao('Produto excluído com sucesso!');
                
                // Atualizar a tabela
                initializeProdutosPagination();
                
                // Fechar o modal
                closeModal('confirmarExclusaoModal');
            } else {
                mostrarNotificacao('Erro ao excluir o produto. Tente novamente.', 'error');
            }
        });
        
        // Evento para cancelar exclusão de produto
        document.getElementById('cancelarExclusao').addEventListener('click', function() {
            closeModal('confirmarExclusaoModal');
        });
        
        // Evento para fechar modal de confirmar exclusão com o X
        document.getElementById('closeConfirmarExclusaoModal').addEventListener('click', function() {
            closeModal('confirmarExclusaoModal');
        });
        
        // Inicializar funcionalidade dos botões de visualizar venda e recibo
        function initializeViewSaleButtons() {
            // Botões para visualizar detalhes da venda
            document.querySelectorAll('.view-sale-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const saleId = this.getAttribute('data-id');
                    openSaleDetailsModal(saleId);
                });
            });
            
            // Botões para visualizar recibo da venda
            document.querySelectorAll('.receipt-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const saleId = this.getAttribute('data-id');
                    openReceiptModal(saleId);
                });
            });
            
            // Fechar modal de detalhes da venda
            document.getElementById('closeVerVendaModal').addEventListener('click', function() {
                closeModal('verVendaModal');
            });
            
            // Fechar modal de detalhes da venda com botão
            document.getElementById('fecharVerVendaBtn').addEventListener('click', function() {
                closeModal('verVendaModal');
            });
            
            // Abrir recibo a partir do modal de detalhes da venda
            document.getElementById('visualizarReciboBtn').addEventListener('click', function() {
                const saleId = document.getElementById('verVendaModal').getAttribute('data-sale-id');
                closeModal('verVendaModal');
                openReceiptModal(saleId);
            });
            
            // Fechar modal de recibo
            document.getElementById('closeReciboModal').addEventListener('click', function() {
                closeModal('reciboModal');
            });
            
            // Fechar modal de recibo com botão
            document.getElementById('fecharReciboBtn').addEventListener('click', function() {
                closeModal('reciboModal');
            });
            
            // Botão de imprimir recibo
            document.getElementById('imprimirReciboBtn').addEventListener('click', function() {
                window.print();
            });
        }
        
        // Função para abrir o modal de detalhes da venda
        function openSaleDetailsModal(saleId) {
            const venda = DB.getVendaPorId(saleId);
            if (!venda) return;
            
            // Salvar o ID da venda no modal para uso posterior
            document.getElementById('verVendaModal').setAttribute('data-sale-id', saleId);
            
            // Preencher o conteúdo do modal com os detalhes da venda
            const modalBody = document.getElementById('verVendaConteudo');
            
            let produtosHTML = '';
            let total = 0;
            
            if (venda.produtos && venda.produtos.length) {
                venda.produtos.forEach(produto => {
                    produtosHTML += `
                        <tr>
                            <td>${produto.nome}</td>
                            <td>${produto.quantidade}</td>
                            <td>${formatarMoeda(produto.valorUnitario)}</td>
                            <td>${formatarMoeda(produto.subtotal)}</td>
                        </tr>
                    `;
                    total += produto.subtotal;
                });
            }
            
            modalBody.innerHTML = `
                <div class="sale-details-container">
                    <div class="sale-detail-group">
                        <h4>Venda #${venda.id}</h4>
                        <p>Data: ${venda.data}</p>
                    </div>
                    
                    <div class="sale-detail-group">
                        <h4>Status</h4>
                        <p><span class="status ${getStatusClass(venda.status, 'venda')}">${getStatusText(venda.status, 'venda')}</span></p>
                    </div>
                    
                    <div class="sale-detail-group">
                        <h4>Cliente</h4>
                        <p>${venda.clienteNome}</p>
                    </div>
                    
                    <div class="sale-detail-group">
                        <h4>Forma de Pagamento</h4>
                        <p>${venda.pagamento}</p>
                    </div>
                </div>
                
                <h4 style="margin-top: 20px; margin-bottom: 10px; color: var(--primary-color);">Produtos</h4>
                <table class="sale-products-table">
                    <thead>
                        <tr>
                            <th>Produto</th>
                            <th>Qtd</th>
                            <th>Valor Unit.</th>
                            <th>Subtotal</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${produtosHTML}
                        <tr class="sale-total-row">
                            <td colspan="3" style="text-align: right;">Total:</td>
                            <td>${formatarMoeda(venda.total)}</td>
                        </tr>
                    </tbody>
                </table>
                
                ${venda.observacoes ? `
                <div class="sale-detail-group" style="margin-top: 20px;">
                    <h4>Observações</h4>
                    <p>${venda.observacoes}</p>
                </div>
                ` : ''}
            `;
            
            // Abrir o modal
            openModal('verVendaModal');
        }
        
        // Função para abrir o modal de recibo
        function openReceiptModal(saleId) {
            const venda = DB.getVendaPorId(saleId);
            if (!venda) return;
            
            // Preencher o conteúdo do recibo
            const reciboConteudo = document.getElementById('reciboConteudo');
            
            const config = DB.getConfiguracoes();
            const dataHoje = new Date().toLocaleDateString('pt-BR');
            const horaAtual = new Date().toLocaleTimeString('pt-BR');
            
            let produtosHTML = '';
            let total = 0;
            
            if (venda.produtos && venda.produtos.length) {
                venda.produtos.forEach(produto => {
                    produtosHTML += `
                        <div class="receipt-item">
                            <div class="receipt-item-name">${produto.nome}</div>
                            <div class="receipt-item-qty">${produto.quantidade}x</div>
                            <div class="receipt-item-price">${formatarMoeda(produto.subtotal)}</div>
                        </div>
                    `;
                    total += produto.subtotal;
                });
            }
            
            reciboConteudo.innerHTML = `
                <div class="receipt">
                    <div class="receipt-header">
                        <h3>${config.nomeEmpresa}</h3>
                        <p>CNPJ: ${config.cnpj}</p>
                        <p>Insc. Est.: ${config.inscricaoEstadual}</p>
                        <p>Venda: #${venda.id}</p>
                    </div>
                    
                    <div class="receipt-info">
                        <p>
                            <span>Data:</span>
                            <span>${venda.data.split(' ')[0]}</span>
                        </p>
                        <p>
                            <span>Hora:</span>
                            <span>${venda.data.split(' ')[1] || "00:00"}</span>
                        </p>
                        <p>
                            <span>Cliente:</span>
                            <span>${venda.clienteNome}</span>
                        </p>
                        <p>
                            <span>Atendente:</span>
                            <span>Usuário</span>
                        </p>
                    </div>
                    
                    <div class="receipt-items">
                        ${produtosHTML}
                    </div>
                    
                    <div class="receipt-totals">
                        <div class="receipt-total">
                            <span>Subtotal:</span>
                            <span>${formatarMoeda(venda.total)}</span>
                        </div>
                        <div class="receipt-total">
                            <span>Desconto:</span>
                            <span>${formatarMoeda(0)}</span>
                        </div>
                        <div class="receipt-total grand-total">
                            <span>TOTAL:</span>
                            <span>${formatarMoeda(venda.total)}</span>
                        </div>
                    </div>
                    
                    <div class="receipt-info">
                        <p>
                            <span>Forma de Pagamento:</span>
                            <span>${venda.pagamento}</span>
                        </p>
                    </div>
                    
                    <div class="receipt-barcode">
                        ${venda.id}
                    </div>
                    
                    <div class="receipt-footer">
                        <p>Impresso em: ${dataHoje} ${horaAtual}</p>
                        <p>Agradecemos pela preferência!</p>
                    </div>
                </div>
                
                <button class="print-btn" id="printReceiptBtn"><i class="material-icons">print</i> Imprimir Recibo</button>
            `;
            
            // Adicionar evento ao botão de impressão interno
            document.getElementById('printReceiptBtn').addEventListener('click', function() {
                window.print();
            });
            
            // Abrir o modal
            openModal('reciboModal');
        }
        
        // Link de "Ver Todas" para vendas
        document.getElementById('verTodasVendasBtn').addEventListener('click', function() {
            // Mostra a seção de vendas
            document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
            document.getElementById('vendas').classList.add('active');
            
            // Atualiza o item de menu ativo
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            document.querySelector('.nav-item[data-section="vendas"]').classList.add('active');
        });
        
        // Produto Modal
        document.getElementById('novoProdutoBtn').addEventListener('click', function() {
            openModal('novoProdutoModal');
        });
        
        document.getElementById('closeNovoProdutoModal').addEventListener('click', function() {
            closeModal('novoProdutoModal');
        });
        
        document.getElementById('cancelarNovoProduto').addEventListener('click', function() {
            closeModal('novoProdutoModal');
        });
        
        document.getElementById('salvarNovoProduto').addEventListener('click', function() {
            const codigo = document.getElementById('produtoCodigo').value;
            const nome = document.getElementById('produtoNome').value;
            const categoria = document.getElementById('produtoCategoria').value;
            const preco = parseFloat(document.getElementById('produtoPreco').value);
            const estoque = parseInt(document.getElementById('produtoEstoque').value);
            const estoqueMinimo = parseInt(document.getElementById('produtoEstoqueMinimo').value);
            const descricao = document.getElementById('produtoDescricao').value;
            
            if (!codigo || !nome || !categoria || isNaN(preco) || isNaN(estoque) || isNaN(estoqueMinimo)) {
                alert('Preencha todos os campos obrigatórios corretamente.');
                return;
            }
            
            // Determinar status do produto
            let status;
            if (estoque <= 0) {
                status = 'sem_estoque';
            } else if (estoque < estoqueMinimo) {
                status = 'baixo_estoque';
            } else {
                status = 'em_estoque';
            }
            
            const novoProduto = {
                codigo,
                nome,
                categoria,
                preco,
                estoque,
                estoqueMinimo,
                descricao,
                status
            };
            
            DB.adicionarProduto(novoProduto);
            
            // Atualiza a tabela de produtos
            initializeProdutosPagination();
            
            // Mostra notificação
            mostrarNotificacao('Produto salvo com sucesso!');
            
            closeModal('novoProdutoModal');
            
            // Limpa o formulário
            document.getElementById('novoProdutoForm').reset();
        });
        
        // Inicializa as funcionalidades de categorias
        function initializeCategoriasFunctionality() {
            // Botão para nova categoria
            document.getElementById('novaCategoriaBtn').addEventListener('click', function() {
                openModal('novaCategoriaModal');
            });
            
            // Fechar modal de nova categoria
            document.getElementById('closeNovaCategoriaModal').addEventListener('click', function() {
                closeModal('novaCategoriaModal');
            });
            
            // Cancelar nova categoria
            document.getElementById('cancelarNovaCategoria').addEventListener('click', function() {
                closeModal('novaCategoriaModal');
            });
            
            // Salvar nova categoria
            document.getElementById('salvarNovaCategoria').addEventListener('click', function() {
                const nome = document.getElementById('categoriaNome').value;
                const descricao = document.getElementById('categoriaDescricao').value;
                
                if (!nome) {
                    alert('O nome da categoria é obrigatório.');
                    return;
                }
                
                const novaCategoria = {
                    nome,
                    descricao
                };
                
                const categoriaSalva = DB.adicionarCategoria(novaCategoria);
                
                // Atualiza a tabela de categorias
                const tbody = document.querySelector('#categorias .table-responsive tbody');
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${categoriaSalva.id}</td>
                    <td>${categoriaSalva.nome}</td>
                    <td>${categoriaSalva.produtos}</td>
                    <td><span class="status ${getStatusClass(categoriaSalva.status, 'categoria')}">${getStatusText(categoriaSalva.status, 'categoria')}</span></td>
                    <td class="action-cell">
                        <button class="action-btn" data-action="edit" data-id="${categoriaSalva.id}"><i class="material-icons">edit</i></button>
                        <button class="action-btn" data-action="delete" data-id="${categoriaSalva.id}"><i class="material-icons">delete</i></button>
                    </td>
                `;
                tbody.appendChild(tr);
                
                // Adiciona evento aos botões
                addCategoryActionEvents();
                
                // Também adiciona ao select de categorias no modal de produtos
                const selects = [
                    document.getElementById('produtoCategoria'),
                    document.getElementById('editProdutoCategoria')
                ];
                selects.forEach(select => {
                    const option = document.createElement('option');
                    option.value = categoriaSalva.nome;
                    option.textContent = categoriaSalva.nome;
                    select.appendChild(option);
                });
                
                // Mostra notificação
                mostrarNotificacao('Categoria cadastrada com sucesso!');
                
                closeModal('novaCategoriaModal');
                
                // Limpa o formulário
                document.getElementById('novaCategoriaForm').reset();
            });
            
            // Adiciona evento aos botões de editar e excluir categorias
            addCategoryActionEvents();
            
            // Modal de editar categoria
            document.getElementById('closeEditarCategoriaModal').addEventListener('click', function() {
                closeModal('editarCategoriaModal');
            });
            
            document.getElementById('cancelarEditarCategoria').addEventListener('click', function() {
                closeModal('editarCategoriaModal');
            });
            
            document.getElementById('salvarEditarCategoria').addEventListener('click', function() {
                const id = document.getElementById('editCategoriaId').value;
                const nome = document.getElementById('editCategoriaNome').value;
                const descricao = document.getElementById('editCategoriaDescricao').value;
                const status = document.getElementById('editCategoriaStatus').value;
                
                if (!nome) {
                    alert('O nome da categoria é obrigatório.');
                    return;
                }
                
                const categoriaEditada = {
                    id,
                    nome,
                    descricao,
                    status
                };
                
                const sucesso = DB.editarCategoria(categoriaEditada);
                
                if (sucesso) {
                    // Atualiza a tabela de categorias
                    const categorias = DB.getCategorias();
                    const categoria = categorias.find(c => c.id === parseInt(id));
                    
                    const row = document.querySelector(`#categorias .table-responsive tbody tr td:first-child:contains('${id}')`).closest('tr');
                    if (row) {
                        row.innerHTML = `
                            <td>${categoria.id}</td>
                            <td>${categoria.nome}</td>
                            <td>${categoria.produtos}</td>
                            <td><span class="status ${getStatusClass(categoria.status, 'categoria')}">${getStatusText(categoria.status, 'categoria')}</span></td>
                            <td class="action-cell">
                                <button class="action-btn" data-action="edit" data-id="${categoria.id}"><i class="material-icons">edit</i></button>
                                <button class="action-btn" data-action="delete" data-id="${categoria.id}"><i class="material-icons">delete</i></button>
                            </td>
                        `;
                    }
                    
                    // Atualiza selects de categorias se o nome mudou
                    const selects = [
                        document.getElementById('produtoCategoria'),
                        document.getElementById('editProdutoCategoria')
                    ];
                    selects.forEach(select => {
                        const options = select.querySelectorAll('option');
                        let found = false;
                        for (let option of options) {
                            if (option.value === categoria.nome) {
                                found = true;
                                break;
                            }
                        }
                        
                        if (!found) {
                            const option = document.createElement('option');
                            option.value = categoria.nome;
                            option.textContent = categoria.nome;
                            select.appendChild(option);
                        }
                    });
                    
                    // Mostra notificação
                    mostrarNotificacao('Categoria atualizada com sucesso!');
                    
                    closeModal('editarCategoriaModal');
                    
                    // Adiciona eventos aos botões novamente
                    addCategoryActionEvents();
                } else {
                    mostrarNotificacao('Erro ao atualizar a categoria. Tente novamente.', 'error');
                }
            });
            
            // Confirmar exclusão de categoria
            document.getElementById('closeConfirmarExclusaoCategoriaModal').addEventListener('click', function() {
                closeModal('confirmarExclusaoCategoriaModal');
            });
            
            document.getElementById('cancelarExclusaoCategoria').addEventListener('click', function() {
                closeModal('confirmarExclusaoCategoriaModal');
            });
            
            document.getElementById('confirmarExclusaoCategoria').addEventListener('click', function() {
                const id = document.getElementById('categoriaExcluirId').value;
                
                const sucesso = DB.excluirCategoria(id);
                
                if (sucesso) {
                    // Atualiza a tabela de categorias
                    document.querySelector(`#categorias .table-responsive tbody tr td:first-child:contains('${id}')`).closest('tr').remove();
                    
                    // Mostra notificação
                    mostrarNotificacao('Categoria excluída com sucesso!');
                    
                    closeModal('confirmarExclusaoCategoriaModal');
                } else {
                    mostrarNotificacao('Erro ao excluir a categoria. Tente novamente.', 'error');
                }
            });
        }
        
        // Adiciona eventos aos botões de editar e excluir categorias
        function addCategoryActionEvents() {
            document.querySelectorAll('#categorias .table-responsive tbody .action-btn').forEach(btn => {
                const action = btn.getAttribute('data-action');
                const id = btn.getAttribute('data-id');
                
                btn.addEventListener('click', function() {
                    if (action === 'edit') {
                        openEditCategoryModal(id);
                    } else if (action === 'delete') {
                        openDeleteCategoryModal(id);
                    }
                });
            });
        }
        
        // Função para abrir modal de edição de categoria
        function openEditCategoryModal(id) {
            const categorias = DB.getCategorias();
            const categoria = categorias.find(c => c.id === parseInt(id));
            
            if (!categoria) return;
            
            // Preencher o formulário com os dados da categoria
            document.getElementById('editCategoriaId').value = categoria.id;
            document.getElementById('editCategoriaNome').value = categoria.nome;
            document.getElementById('editCategoriaDescricao').value = categoria.descricao || '';
            document.getElementById('editCategoriaStatus').value = categoria.status;
            
            // Abrir o modal
            openModal('editarCategoriaModal');
        }
        
        // Função para abrir modal de exclusão de categoria
        function openDeleteCategoryModal(id) {
            const categorias = DB.getCategorias();
            const categoria = categorias.find(c => c.id === parseInt(id));
            
            if (!categoria) return;
            
            // Preencher informações no modal
            document.getElementById('categoriaExcluirId').value = categoria.id;
            document.getElementById('categoriaExcluirNome').textContent = categoria.nome;
            
            // Abrir o modal
            openModal('confirmarExclusaoCategoriaModal');
        }
        
        // Inicializa as funcionalidades de movimentações
        function initializeMovimentacoesFunctionality() {
            // Botão para nova movimentação
            document.getElementById('novaMovimentacaoBtn').addEventListener('click', function() {
                prepararModalMovimentacao();
                openModal('novaMovimentacaoModal');
            });
            
            // Fechar modal de nova movimentação
            document.getElementById('closeNovaMovimentacaoModal').addEventListener('click', function() {
                closeModal('novaMovimentacaoModal');
            });
            
            // Cancelar nova movimentação
            document.getElementById('cancelarNovaMovimentacao').addEventListener('click', function() {
                closeModal('novaMovimentacaoModal');
            });
            
            // Salvar nova movimentação
            document.getElementById('salvarNovaMovimentacao').addEventListener('click', function() {
                const produto = document.getElementById('movProduto').value;
                const tipo = document.getElementById('movTipo').value;
                const quantidade = document.getElementById('movQuantidade').value;
                const data = document.getElementById('movData').value;
                const motivo = document.getElementById('movMotivo').value;
                
                if (!produto || !tipo || !quantidade || !data) {
                    alert('Preencha todos os campos obrigatórios.');
                    return;
                }
                
                // Formatar data para exibição
                const dataFormatada = new Date(data).toLocaleString('pt-BR').replace(',', '');
                
                const novaMovimentacao = {
                    produto,
                    tipo,
                    quantidade: parseInt(quantidade),
                    data: dataFormatada,
                    usuario: document.getElementById('userDisplayName').textContent,
                    motivo
                };
                
                const movimentacaoSalva = DB.adicionarMovimentacao(novaMovimentacao);
                
                // Atualiza a tabela de movimentações
                const tbody = document.querySelector('#movimentacoesTable tbody');
                const tr = document.createElement('tr');
                
                // Formatar quantidade com sinal
                const quantidadeFormatada = novaMovimentacao.tipo === 'entrada' ? 
                    `+${novaMovimentacao.quantidade}` : 
                    `-${novaMovimentacao.quantidade}`;
                
                tr.innerHTML = `
                    <td>${movimentacaoSalva.id}</td>
                    <td>${movimentacaoSalva.produtoNome}</td>
                    <td><span class="status ${getStatusClass(movimentacaoSalva.tipo, 'movimentacao')}">${getStatusText(movimentacaoSalva.tipo, 'movimentacao')}</span></td>
                    <td>${quantidadeFormatada}</td>
                    <td>${movimentacaoSalva.data}</td>
                    <td>${movimentacaoSalva.usuario}</td>
                    <td class="action-cell">
                        <button class="action-btn" data-action="view" data-id="${movimentacaoSalva.id}"><i class="material-icons">visibility</i></button>
                    </td>
                `;
                tbody.prepend(tr);
                
                // Adiciona evento ao botão de visualizar
                tr.querySelector('.action-btn').addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    openViewMovementModal(id);
                });
                
                // Mostra notificação
                mostrarNotificacao('Movimentação registrada com sucesso!');
                
                closeModal('novaMovimentacaoModal');
                
                // Limpa o formulário
                document.getElementById('novaMovimentacaoForm').reset();
                
                // Também atualiza a tabela de produtos na página de produtos
                initializeProdutosPagination();
            });
            
            // Adiciona evento de busca nas movimentações
            document.getElementById('searchMovimentacoesBtn').addEventListener('click', function() {
                buscarMovimentacoes();
            });
            
            document.getElementById('movimentacoesSearchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    buscarMovimentacoes();
                }
            });
            
            // Adiciona evento aos botões de visualizar movimentação
            document.querySelectorAll('#movimentacoesTable .action-btn[data-action="view"]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-id');
                    openViewMovementModal(id);
                });
            });
            
            // Fechar modal de visualizar movimentação
            document.getElementById('closeVerMovimentacaoModal').addEventListener('click', function() {
                closeModal('verMovimentacaoModal');
            });
            
            document.getElementById('fecharVerMovimentacaoBtn').addEventListener('click', function() {
                closeModal('verMovimentacaoModal');
            });
            
            // Inicializa a paginação de movimentações
            initializeMovimentacoesPagination();
        }
        
        function prepararModalMovimentacao() {
            // Define a data atual
            const agora = new Date();
            const dataFormatada = agora.toISOString().slice(0, 16);
            document.getElementById('movData').value = dataFormatada;
            
            // Carrega produtos disponíveis no select
            const selectProduto = document.getElementById('movProduto');
            selectProduto.innerHTML = '<option value="">Selecione um produto...</option>';
            
            const produtos = DB.getProdutos();
            produtos.forEach(produto => {
                const option = document.createElement('option');
                option.value = produto.codigo;
                option.textContent = `${produto.codigo} - ${produto.nome}`;
                selectProduto.appendChild(option);
            });
        }
        
        function buscarMovimentacoes() {
            const searchTerm = document.getElementById('movimentacoesSearchInput').value.toLowerCase();
            const rows = document.querySelectorAll('#movimentacoesTable tbody tr');
            
            rows.forEach(row => {
                const id = row.querySelector('td:nth-child(1)').textContent;
                const produto = row.querySelector('td:nth-child(2)').textContent;
                const quantidade = row.querySelector('td:nth-child(4)').textContent;
                const data = row.querySelector('td:nth-child(5)').textContent;
                
                const match = 
                    id.toLowerCase().includes(searchTerm) || 
                    produto.toLowerCase().includes(searchTerm) ||
                    quantidade.includes(searchTerm) ||
                    data.toLowerCase().includes(searchTerm);
                
                row.style.display = match ? '' : 'none';
                
                // Destacar os termos encontrados
                if (match) {
                    row.querySelectorAll('td').forEach(cell => {
                        const text = cell.textContent;
                        if (text.toLowerCase().includes(searchTerm)) {
                            // Preservar o conteúdo HTML interno (como spans para status)
                            if (cell.querySelector('.status')) {
                                const statusSpan = cell.querySelector('.status').outerHTML;
                                const parts = text.split(new RegExp(`(${searchTerm})`, 'i'));
                                cell.innerHTML = '';
                                parts.forEach(part => {
                                    if (part.toLowerCase() === searchTerm) {
                                        const span = document.createElement('span');
                                        span.className = 'highlight';
                                        span.textContent = part;
                                        cell.appendChild(span);
                                    } else if (part.includes('Entrada') || part.includes('Saída')) {
                                        cell.innerHTML += statusSpan;
                                    } else {
                                        cell.appendChild(document.createTextNode(part));
                                    }
                                });
                            } else {
                                const parts = text.split(new RegExp(`(${searchTerm})`, 'i'));
                                cell.innerHTML = parts.map(part => 
                                    part.toLowerCase() === searchTerm ? 
                                    `<span class="highlight">${part}</span>` : part
                                ).join('');
                            }
                        }
                    });
                }
            });
            
            mostrarNotificacao('Busca realizada');
        }
        
        function openViewMovementModal(id) {
            const movimentacao = DB.getMovimentacaoPorId(id);
            if (!movimentacao) return;
            
            // Formatar quantidade com sinal
            const quantidadeFormatada = movimentacao.tipo === 'entrada' ? 
                `+${movimentacao.quantidade}` : 
                `-${movimentacao.quantidade}`;
            
            // Preencher o conteúdo do modal
            document.getElementById('verMovimentacaoConteudo').innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                    <div>
                        <h4 style="color: var(--primary-color); margin-bottom: 5px;">ID</h4>
                        <p>${movimentacao.id}</p>
                    </div>
                    <div>
                        <h4 style="color: var(--primary-color); margin-bottom: 5px;">Tipo</h4>
                        <p><span class="status ${getStatusClass(movimentacao.tipo, 'movimentacao')}">${getStatusText(movimentacao.tipo, 'movimentacao')}</span></p>
                    </div>
                    <div>
                        <h4 style="color: var(--primary-color); margin-bottom: 5px;">Produto</h4>
                        <p>${movimentacao.produtoNome} (Código: ${movimentacao.produto})</p>
                    </div>
                    <div>
                        <h4 style="color: var(--primary-color); margin-bottom: 5px;">Quantidade</h4>
                        <p>${quantidadeFormatada}</p>
                    </div>
                    <div>
                        <h4 style="color: var(--primary-color); margin-bottom: 5px;">Data</h4>
                        <p>${movimentacao.data}</p>
                    </div>
                    <div>
                        <h4 style="color: var(--primary-color); margin-bottom: 5px;">Usuário</h4>
                        <p>${movimentacao.usuario}</p>
                    </div>
                </div>
                
                ${movimentacao.motivo ? `
                <div>
                    <h4 style="color: var(--primary-color); margin-bottom: 5px;">Motivo</h4>
                    <p style="margin-bottom: 20px;">${movimentacao.motivo}</p>
                </div>
                ` : ''}
                
                <div>
                    <h4 style="color: var(--primary-color); margin-bottom: 5px;">Efeito no Estoque</h4>
                    <p>Esta movimentação ${movimentacao.tipo === 'entrada' ? 'aumentou' : 'reduziu'} o estoque em ${movimentacao.quantidade} ${movimentacao.quantidade > 1 ? 'unidades' : 'unidade'}.</p>
                </div>
            `;
            
            // Abrir o modal
            openModal('verMovimentacaoModal');
        }
        
        function initializeMovimentacoesPagination() {
            // Implementar paginação para movimentações
            const movPrevBtn = document.getElementById('movPrevPageBtn');
            const movNextBtn = document.getElementById('movNextPageBtn');
            const movPageNumbers = document.getElementById('movPageNumbers');
            
            // Adiciona eventos aos botões de paginação
            if (movPrevBtn && movNextBtn) {
                let currentPage = 1;
                
                movPrevBtn.addEventListener('click', function() {
                    if (currentPage > 1) {
                        currentPage--;
                        updateMovPaginationButtons(currentPage);
                    }
                });
                
                movNextBtn.addEventListener('click', function() {
                    const pages = movPageNumbers.querySelectorAll('.pagination-btn');
                    if (currentPage < pages.length) {
                        currentPage++;
                        updateMovPaginationButtons(currentPage);
                    }
                });
                
                // Adiciona eventos aos botões de número de página
                movPageNumbers.querySelectorAll('.pagination-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        currentPage = parseInt(this.getAttribute('data-page'));
                        updateMovPaginationButtons(currentPage);
                    });
                });
            }
        }
        
        function updateMovPaginationButtons(currentPage) {
            // Atualizar botões de paginação para movimentações
            const pages = document.getElementById('movPageNumbers').querySelectorAll('.pagination-btn');
            
            pages.forEach(btn => {
                const page = parseInt(btn.getAttribute('data-page'));
                if (page === currentPage) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // Mostra/esconde linhas baseado na página atual (simulação)
            // Em um cenário real, você traria novos dados para cada página
            mostrarNotificacao(`Página ${currentPage} de movimentações carregada`);
        }
        
        // Inicializa a paginação de vendas
        function initializeVendasPagination() {
            // Implementar paginação para vendas
            const vendaPrevBtn = document.getElementById('vendaPrevPageBtn');
            const vendaNextBtn = document.getElementById('vendaNextPageBtn');
            const vendaPageNumbers = document.getElementById('vendaPageNumbers');
            
            // Adiciona eventos aos botões de paginação
            if (vendaPrevBtn && vendaNextBtn) {
                let currentPage = 1;
                
                vendaPrevBtn.addEventListener('click', function() {
                    if (currentPage > 1) {
                        currentPage--;
                        updateVendaPaginationButtons(currentPage);
                    }
                });
                
                vendaNextBtn.addEventListener('click', function() {
                    const pages = vendaPageNumbers.querySelectorAll('.pagination-btn');
                    if (currentPage < pages.length) {
                        currentPage++;
                        updateVendaPaginationButtons(currentPage);
                    }
                });
                
                // Adiciona eventos aos botões de número de página
                vendaPageNumbers.querySelectorAll('.pagination-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        currentPage = parseInt(this.getAttribute('data-page'));
                        updateVendaPaginationButtons(currentPage);
                    });
                });
            }
        }
        
        function updateVendaPaginationButtons(currentPage) {
            // Atualizar botões de paginação para vendas
            const pages = document.getElementById('vendaPageNumbers').querySelectorAll('.pagination-btn');
            
            pages.forEach(btn => {
                const page = parseInt(btn.getAttribute('data-page'));
                if (page === currentPage) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // Mostra/esconde linhas baseado na página atual (simulação)
            // Em um cenário real, você traria novos dados para cada página
            mostrarNotificacao(`Página ${currentPage} de vendas carregada`);
        }
        
        // Cliente Modal
        document.getElementById('novoClienteBtn').addEventListener('click', function() {
            openModal('novoClienteModal');
        });
        
        document.getElementById('closeNovoClienteModal').addEventListener('click', function() {
            closeModal('novoClienteModal');
        });
        
        document.getElementById('cancelarNovoCliente').addEventListener('click', function() {
            closeModal('novoClienteModal');
        });
        
        document.getElementById('salvarNovoCliente').addEventListener('click', function() {
            const nome = document.getElementById('clienteNome').value;
            const email = document.getElementById('clienteEmail').value;
            const telefone = document.getElementById('clienteTelefone').value;
            
            if (!nome || !email || !telefone) {
                alert('Preencha todos os campos obrigatórios.');
                return;
            }
            
            const novoCliente = {
                nome,
                email,
                telefone,
                cpf: document.getElementById('clienteCpf').value,
                endereco: document.getElementById('clienteEndereco').value,
                cidade: document.getElementById('clienteCidade').value,
                estado: document.getElementById('clienteEstado').value,
                cep: document.getElementById('clienteCep').value,
                observacoes: document.getElementById('clienteObservacoes').value,
                ultimaCompra: '—',
                totalGasto: 0,
                status: 'ativo'
            };
            
            const clienteSalvo = DB.adicionarCliente(novoCliente);
            
            // Atualiza a tabela de clientes
            const tbody = document.querySelector('#clientes .table-responsive tbody');
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${clienteSalvo.id}</td>
                <td>${clienteSalvo.nome}</td>
                <td>${clienteSalvo.email}</td>
                <td>${clienteSalvo.telefone}</td>
                <td>${clienteSalvo.ultimaCompra}</td>
                <td>${formatarMoeda(clienteSalvo.totalGasto)}</td>
                <td><span class="status ${getStatusClass(clienteSalvo.status, 'cliente')}">${getStatusText(clienteSalvo.status, 'cliente')}</span></td>
                <td class="action-cell">
                    <button class="action-btn" data-action="view" data-id="${clienteSalvo.id}"><i class="material-icons">visibility</i></button>
                    <button class="action-btn" data-action="edit" data-id="${clienteSalvo.id}"><i class="material-icons">edit</i></button>
                </td>
            `;
            tbody.appendChild(tr);
            
            // Também adiciona ao select de clientes no modal de vendas
            const select = document.getElementById('vendaCliente');
            const option = document.createElement('option');
            option.value = clienteSalvo.id;
            option.textContent = clienteSalvo.nome;
            select.appendChild(option);
            
            // Mostra notificação
            mostrarNotificacao('Cliente cadastrado com sucesso!');
            
            closeModal('novoClienteModal');
            
            // Limpa o formulário
            document.getElementById('novoClienteForm').reset();
        });
        
        // Nova Venda Modal
        document.getElementById('novaVendaBtn').addEventListener('click', function() {
            prepararModalVenda();
            openModal('novaVendaModal');
        });
        
        document.getElementById('novaVendaPageBtn').addEventListener('click', function() {
            prepararModalVenda();
            openModal('novaVendaModal');
        });
        
        document.getElementById('closeNovaVendaModal').addEventListener('click', function() {
            closeModal('novaVendaModal');
        });
        
        document.getElementById('cancelarNovaVenda').addEventListener('click', function() {
            closeModal('novaVendaModal');
        });
        
        function prepararModalVenda() {
            // Define a data atual
            const agora = new Date();
            const dataFormatada = agora.toISOString().slice(0, 16);
            document.getElementById('vendaData').value = dataFormatada;
            
            // Limpa produtos
            const tbody = document.querySelector('#vendaProdutosTable tbody');
            tbody.innerHTML = `
                <tr>
                    <td>
                        <select class="produto-select">
                            <option value="">Selecione um produto...</option>
                            <option value="001" data-preco="0.75">Pão Francês - R$ 0,75</option>
                            <option value="002" data-preco="35.00">Bolo de Chocolate - R$ 35,00</option>
                            <option value="003" data-preco="2.50">Pão de Queijo - R$ 2,50</option>
                            <option value="005" data-preco="6.50">Croissant - R$ 6,50</option>
                        </select>
                    </td>
                    <td>
                        <input type="number" class="produto-qtd" min="1" value="1">
                    </td>
                    <td class="produto-valor">R$ 0,00</td>
                    <td class="produto-subtotal">R$ 0,00</td>
                    <td>
                        <button type="button" class="action-btn remover-produto"><i class="material-icons">delete</i></button>
                    </td>
                </tr>
            `;
            
            // Adiciona eventos aos selects de produtos
            adicionarEventosProdutos();
            
            // Zera total
            document.getElementById('vendaTotal').textContent = 'R$ 0,00';
        }
        
        document.getElementById('adicionarProdutoBtn').addEventListener('click', function() {
            const tbody = document.querySelector('#vendaProdutosTable tbody');
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>
                    <select class="produto-select">
                        <option value="">Selecione um produto...</option>
                        <option value="001" data-preco="0.75">Pão Francês - R$ 0,75</option>
                        <option value="002" data-preco="35.00">Bolo de Chocolate - R$ 35,00</option>
                        <option value="003" data-preco="2.50">Pão de Queijo - R$ 2,50</option>
                        <option value="005" data-preco="6.50">Croissant - R$ 6,50</option>
                    </select>
                </td>
                <td>
                    <input type="number" class="produto-qtd" min="1" value="1">
                </td>
                <td class="produto-valor">R$ 0,00</td>
                <td class="produto-subtotal">R$ 0,00</td>
                <td>
                    <button type="button" class="action-btn remover-produto"><i class="material-icons">delete</i></button>
                </td>
            `;
            tbody.appendChild(tr);
            
            // Adiciona eventos ao novo produto
            adicionarEventosProdutos();
        });
        
        function adicionarEventosProdutos() {
            // Selects de produtos
            document.querySelectorAll('.produto-select').forEach(function(select) {
                select.addEventListener('change', function() {
                    const option = this.options[this.selectedIndex];
                    const preco = option.getAttribute('data-preco');
                    const tr = this.closest('tr');
                    const valorCell = tr.querySelector('.produto-valor');
                    const qtdInput = tr.querySelector('.produto-qtd');
                    const subtotalCell = tr.querySelector('.produto-subtotal');
                    
                    if (preco) {
                        valorCell.textContent = `R$ ${parseFloat(preco).toFixed(2)}`;
                        const subtotal = parseFloat(preco) * parseInt(qtdInput.value);
                        subtotalCell.textContent = `R$ ${subtotal.toFixed(2)}`;
                        atualizarTotalVenda();
                    } else {
                        valorCell.textContent = 'R$ 0,00';
                        subtotalCell.textContent = 'R$ 0,00';
                        atualizarTotalVenda();
                    }
                });
            });
            
            // Inputs de quantidade
            document.querySelectorAll('.produto-qtd').forEach(function(input) {
                input.addEventListener('change', function() {
                    const tr = this.closest('tr');
                    const select = tr.querySelector('.produto-select');
                    const option = select.options[select.selectedIndex];
                    const preco = option.getAttribute('data-preco');
                    const subtotalCell = tr.querySelector('.produto-subtotal');
                    
                    if (preco) {
                        const subtotal = parseFloat(preco) * parseInt(this.value);
                        subtotalCell.textContent = `R$ ${subtotal.toFixed(2)}`;
                        atualizarTotalVenda();
                    }
                });
            });
            
            // Botões de remover
            document.querySelectorAll('.remover-produto').forEach(function(botao) {
                botao.addEventListener('click', function() {
                    const tr = this.closest('tr');
                    const tbody = tr.parentNode;
                    
                    // Não remover se for o único produto
                    if (tbody.children.length > 1) {
                        tbody.removeChild(tr);
                        atualizarTotalVenda();
                    } else {
                        // Se for o único, apenas limpa os valores
                        const select = tr.querySelector('.produto-select');
                        select.value = '';
                        const valorCell = tr.querySelector('.produto-valor');
                        const qtdInput = tr.querySelector('.produto-qtd');
                        const subtotalCell = tr.querySelector('.produto-subtotal');
                        
                        valorCell.textContent = 'R$ 0,00';
                        qtdInput.value = 1;
                        subtotalCell.textContent = 'R$ 0,00';
                        atualizarTotalVenda();
                    }
                });
            });
        }
        
        function atualizarTotalVenda() {
            let total = 0;
            document.querySelectorAll('.produto-subtotal').forEach(function(cell) {
                const valor = parseFloat(cell.textContent.replace('R$ ', '').replace(',', '.'));
                if (!isNaN(valor)) {
                    total += valor;
                }
            });
            
            document.getElementById('vendaTotal').textContent = formatarMoeda(total);
        }
        
        document.getElementById('finalizarVenda').addEventListener('click', function() {
            const cliente = document.getElementById('vendaCliente').value;
            const clienteNome = cliente ? 
                (cliente === 'outro' ? 'Outro / Venda Rápida' : document.getElementById('vendaCliente').options[document.getElementById('vendaCliente').selectedIndex].text) : '';
            const data = document.getElementById('vendaData').value;
            const dataFormatada = new Date(data).toLocaleString('pt-BR').replace(',', '');
            const formaPagamento = document.getElementById('vendaFormaPagamento').value;
            const status = document.getElementById('vendaStatus').value;
            
            if (!cliente || !data || !formaPagamento || !status) {
                alert('Preencha todos os campos obrigatórios.');
                return;
            }
            
            // Verifica se há produtos
            const produtos = [];
            let itens = 0;
            let total = 0;
            let produtosTexto = [];
            
            document.querySelectorAll('#vendaProdutosTable tbody tr').forEach(function(tr) {
                const select = tr.querySelector('.produto-select');
                const produtoId = select.value;
                
                if (produtoId) {
                    const produtoNome = select.options[select.selectedIndex].text.split(' - ')[0];
                    const quantidade = parseInt(tr.querySelector('.produto-qtd').value);
                    const valorUnitario = parseFloat(select.options[select.selectedIndex].getAttribute('data-preco'));
                    const subtotal = valorUnitario * quantidade;
                    
                    produtos.push({
                        id: produtoId,
                        nome: produtoNome,
                        quantidade: quantidade,
                        valorUnitario: valorUnitario,
                        subtotal: subtotal
                    });
                    
                    itens += quantidade;
                    total += subtotal;
                    produtosTexto.push(`${produtoNome}${quantidade > 1 ? ' (' + quantidade + ')' : ''}`);
                }
            });
            
            if (produtos.length === 0) {
                alert('Adicione pelo menos um produto à venda.');
                return;
            }
            
            // Cria o objeto de venda
            const venda = {
                cliente: cliente,
                clienteNome: clienteNome,
                data: dataFormatada,
                produtos: produtos,
                produtosTexto: produtosTexto.join(', '),
                itens: itens,
                total: total,
                pagamento: document.getElementById('vendaFormaPagamento').options[document.getElementById('vendaFormaPagamento').selectedIndex].text,
                status: status
            };
            
            const vendaRegistrada = DB.registrarVenda(venda);
            
            // Atualiza a tabela de vendas
            const tbody = document.querySelector('#vendas .table-responsive tbody');
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${vendaRegistrada.id}</td>
                <td>${vendaRegistrada.clienteNome}</td>
                <td>${vendaRegistrada.itens}</td>
                <td>${formatarMoeda(vendaRegistrada.total)}</td>
                <td>${vendaRegistrada.pagamento}</td>
                <td>${vendaRegistrada.data}</td>
                <td><span class="status ${getStatusClass(vendaRegistrada.status, 'venda')}">${getStatusText(vendaRegistrada.status, 'venda')}</span></td>
                <td class="action-cell">
                    <button class="action-btn view-sale-btn" data-id="${vendaRegistrada.id}"><i class="material-icons">visibility</i></button>
                    <button class="action-btn receipt-btn" data-id="${vendaRegistrada.id}"><i class="material-icons">receipt</i></button>
                </td>
            `;
            tbody.prepend(tr);
            
            // Também atualiza a tabela de vendas recentes no dashboard
            const dashboardTbody = document.querySelector('#dashboard .data-container .table-responsive tbody');
            const dashboardTr = document.createElement('tr');
            dashboardTr.innerHTML = `
                <td>${vendaRegistrada.id}</td>
                <td>${vendaRegistrada.clienteNome}</td>
                <td>${vendaRegistrada.produtosTexto}</td>
                <td>${formatarMoeda(vendaRegistrada.total)}</td>
                <td><span class="status ${getStatusClass(vendaRegistrada.status, 'venda')}">${getStatusText(vendaRegistrada.status, 'venda')}</span></td>
                <td class="action-cell">
                    <button class="action-btn view-sale-btn" data-id="${vendaRegistrada.id}"><i class="material-icons">visibility</i></button>
                    <button class="action-btn receipt-btn" data-id="${vendaRegistrada.id}"><i class="material-icons">receipt</i></button>
                </td>
            `;
            dashboardTbody.prepend(dashboardTr);
            
            // Adiciona os eventos aos novos botões
            initializeViewSaleButtons();
            
            // Mostra notificação
            mostrarNotificacao('Venda registrada com sucesso!');
            
            closeModal('novaVendaModal');
            
            // Limpa o formulário e fecha o modal
            document.getElementById('vendaCliente').value = '';
            document.getElementById('vendaFormaPagamento').value = '';
            document.getElementById('vendaStatus').value = 'concluido';
        });
        
        // Configurações
        document.getElementById('contrasteNormal').addEventListener('click', function() {
            document.body.classList.remove('high-contrast');
            this.classList.add('active');
            document.getElementById('contrasteAlto').classList.remove('active');
            
            // Atualiza a configuração
            const config = DB.getConfiguracoes();
            config.temaContraste = 'normal';
            DB.atualizarConfiguracoes(config);
            
            // Mostra notificação
            mostrarNotificacao('Modo de contraste normal ativado.');
        });
        
        document.getElementById('contrasteAlto').addEventListener('click', function() {
            document.body.classList.add('high-contrast');
            this.classList.add('active');
            document.getElementById('contrasteNormal').classList.remove('active');
            
            // Atualiza a configuração
            const config = DB.getConfiguracoes();
            config.temaContraste = 'alto';
            DB.atualizarConfiguracoes(config);
            
            // Mostra notificação
            mostrarNotificacao('Modo de alto contraste ativado.');
        });
        
        document.getElementById('fontePequena').addEventListener('click', function() {
            document.documentElement.style.fontSize = '0.9rem';
            this.classList.add('active');
            document.getElementById('fonteNormal').classList.remove('active');
            document.getElementById('fonteGrande').classList.remove('active');
            
            // Atualiza a configuração
            const config = DB.getConfiguracoes();
            config.tamanhoFonte = 'pequeno';
            DB.atualizarConfiguracoes(config);
            
            // Mostra notificação
            mostrarNotificacao('Tamanho de fonte pequeno ativado.');
        });
        
        document.getElementById('fonteNormal').addEventListener('click', function() {
            document.documentElement.style.fontSize = '1rem';
            this.classList.add('active');
            document.getElementById('fontePequena').classList.remove('active');
            document.getElementById('fonteGrande').classList.remove('active');
            
            // Atualiza a configuração
            const config = DB.getConfiguracoes();
            config.tamanhoFonte = 'normal';
            DB.atualizarConfiguracoes(config);
            
            // Mostra notificação
            mostrarNotificacao('Tamanho de fonte normal ativado.');
        });
        
        document.getElementById('fonteGrande').addEventListener('click', function() {
            document.documentElement.style.fontSize = '1.1rem';
            this.classList.add('active');
            document.getElementById('fonteNormal').classList.remove('active');
            document.getElementById('fontePequena').classList.remove('active');
            
            // Atualiza a configuração
            const config = DB.getConfiguracoes();
            config.tamanhoFonte = 'grande';
            DB.atualizarConfiguracoes(config);
            
            // Mostra notificação
            mostrarNotificacao('Tamanho de fonte grande ativado.');
        });
        
        document.getElementById('salvarConfiguracoes').addEventListener('click', function() {
            const config = {
                nomeEmpresa: document.getElementById('nomeEmpresa').value,
                moeda: document.getElementById('moeda').value,
                fusoHorario: document.getElementById('fusoHorario').value,
                formatoData: document.getElementById('formatoData').value,
                taxaImposto: parseInt(document.getElementById('taxaImposto').value),
                cnpj: document.getElementById('cnpj').value,
                inscricaoEstadual: document.getElementById('inscricaoEstadual').value,
                regimeTributario: document.getElementById('regimeTributario').value,
                temaContraste: document.body.classList.contains('high-contrast') ? 'alto' : 'normal',
                idioma: document.getElementById('idioma').value,
                tamanhoFonte: document.documentElement.style.fontSize === '1.1rem' ? 'grande' : (document.documentElement.style.fontSize === '0.9rem' ? 'pequeno' : 'normal')
            };
            
            DB.atualizarConfiguracoes(config);
            
            // Mostra notificação
            mostrarNotificacao('Configurações salvas com sucesso!');
        });
        
        // Inicializa funcionalidades de compras
        function initializeComprasFunctionality() {
            // Botão nova compra
            document.getElementById('novaCompraBtn').addEventListener('click', function() {
                prepararModalCompra();
                openModal('novaCompraModal');
            });
            
            document.getElementById('novaCompraPageBtn').addEventListener('click', function() {
                prepararModalCompra();
                openModal('novaCompraModal');
            });
            
            document.getElementById('closeNovaCompraModal').addEventListener('click', function() {
                closeModal('novaCompraModal');
            });
            
            document.getElementById('cancelarNovaCompra').addEventListener('click', function() {
                closeModal('novaCompraModal');
            });
            
            // Adicionar item na compra
            document.getElementById('adicionarItemCompraBtn').addEventListener('click', function() {
                const tbody = document.querySelector('#compraItensTable tbody');
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>
                        <input type="text" class="compra-produto-nome" placeholder="Nome do produto">
                    </td>
                    <td>
                        <input type="number" class="compra-qtd" min="1" value="1">
                    </td>
                    <td>
                        <input type="number" step="0.01" class="compra-valor" placeholder="0.00">
                    </td>
                    <td class="compra-subtotal">R$ 0,00</td>
                    <td>
                        <button type="button" class="action-btn remover-item-compra"><i class="material-icons">delete</i></button>
                    </td>
                `;
                tbody.appendChild(tr);
                
                // Adicionar eventos
                adicionarEventosItemCompra(tr);
            });
            
            // Salvar nova compra
            document.getElementById('salvarCompra').addEventListener('click', function() {
                const fornecedor = document.getElementById('compraFornecedor').value;
                const fornecedorNome = fornecedor ? document.getElementById('compraFornecedor').options[document.getElementById('compraFornecedor').selectedIndex].text : '';
                const pedido = document.getElementById('compraPedido').value;
                const dataPedido = document.getElementById('compraDataPedido').value;
                const dataFormatadaPedido = dataPedido ? new Date(dataPedido).toLocaleDateString('pt-BR') : '';
                const dataEntrega = document.getElementById('compraDataEntrega').value;
                const dataFormatadaEntrega = dataEntrega ? new Date(dataEntrega).toLocaleDateString('pt-BR') : '';
                const status = document.getElementById('compraStatus').value;
                const observacoes = document.getElementById('compraObservacoes').value;
                
                if (!fornecedor || !pedido || !dataPedido || !dataEntrega || !status) {
                    alert('Preencha todos os campos obrigatórios.');
                    return;
                }
                
                // Verificar itens da compra
                const itensDetalhados = [];
                let total = 0;
                let contador = 0;
                
                document.querySelectorAll('#compraItensTable tbody tr').forEach(function(tr) {
                    const produtoNome = tr.querySelector('.compra-produto-nome').value;
                    const quantidade = parseInt(tr.querySelector('.compra-qtd').value);
                    const valor = parseFloat(tr.querySelector('.compra-valor').value);
                    
                    if (produtoNome && !isNaN(quantidade) && !isNaN(valor)) {
                        const subtotal = quantidade * valor;
                        
                        itensDetalhados.push({
                            produto: produtoNome,
                            quantidade: quantidade,
                            valor: valor,
                            subtotal: subtotal
                        });
                        
                        total += subtotal;
                        contador++;
                    }
                });
                
                if (itensDetalhados.length === 0) {
                    alert('Adicione pelo menos um item à compra.');
                    return;
                }
                
                // Criar objeto de compra
                const compra = {
                    id: pedido,
                    fornecedor: fornecedor,
                    fornecedorNome: fornecedorNome,
                    itens: contador,
                    total: total,
                    dataPedido: dataFormatadaPedido,
                    dataEntrega: dataFormatadaEntrega,
                    status: status,
                    itensDetalhados: itensDetalhados,
                    observacoes: observacoes
                };
                
                // Salvar compra
                const compraSalva = DB.adicionarCompra(compra);
                
                // Atualizar tabela de compras
                const tbody = document.querySelector('#comprasTable tbody');
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${compraSalva.id}</td>
                    <td>${compraSalva.fornecedorNome}</td>
                    <td>${compraSalva.itens}</td>
                    <td>${formatarMoeda(compraSalva.total)}</td>
                    <td>${compraSalva.dataPedido}</td>
                    <td>${compraSalva.dataEntrega}</td>
                    <td><span class="status ${getStatusClass(compraSalva.status, 'compra')}">${getStatusText(compraSalva.status, 'compra')}</span></td>
                    <td class="action-cell">
                        <button class="action-btn" data-action="view" data-id="${compraSalva.id}"><i class="material-icons">visibility</i></button>
                        <button class="action-btn" data-action="edit" data-id="${compraSalva.id}"><i class="material-icons">edit</i></button>
                    </td>
                `;
                tbody.prepend(tr);
                
                // Adicionar eventos aos botões
                const viewBtn = tr.querySelector('[data-action="view"]');
                const editBtn = tr.querySelector('[data-action="edit"]');
                
                viewBtn.addEventListener('click', function() {
                    openViewCompraModal(this.getAttribute('data-id'));
                });
                
                editBtn.addEventListener('click', function() {
                    openEditCompraModal(this.getAttribute('data-id'));
                });
                
                // Mostrar notificação
                mostrarNotificacao('Compra registrada com sucesso!');
                
                // Fechar modal
                closeModal('novaCompraModal');
            });
            
            // Adicionar eventos aos botões de visualizar e editar
            document.querySelectorAll('#comprasTable .action-btn[data-action]').forEach(btn => {
                const action = btn.getAttribute('data-action');
                const id = btn.getAttribute('data-id');
                
                btn.addEventListener('click', function() {
                    if (action === 'view') {
                        openViewCompraModal(id);
                    } else if (action === 'edit') {
                        openEditCompraModal(id);
                    }
                });
            });
            
            // Adicionar evento de busca nas compras
            document.getElementById('searchComprasBtn').addEventListener('click', function() {
                buscarCompras();
            });
            
            document.getElementById('comprasSearchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    buscarCompras();
                }
            });
            
            // Adicionar evento ao filtro de status de compras
            document.getElementById('statusCompraFilter').addEventListener('change', function() {
                buscarCompras();
            });
            
            // Adicionar evento ao filtro de data de compras
            document.getElementById('dataCompraFilter').addEventListener('change', function() {
                buscarCompras();
            });
            
            // Modals de detalhes da compra
            document.getElementById('closeVerCompraModal').addEventListener('click', function() {
                closeModal('verCompraModal');
            });
            
            document.getElementById('fecharVerCompraBtn').addEventListener('click', function() {
                closeModal('verCompraModal');
            });
            
            document.getElementById('editarCompraBtn').addEventListener('click', function() {
                const compraId = document.getElementById('verCompraModal').getAttribute('data-compra-id');
                closeModal('verCompraModal');
                openEditCompraModal(compraId);
            });
            
            // Modals para editar compra
            document.getElementById('closeEditarCompraModal').addEventListener('click', function() {
                closeModal('editarCompraModal');
            });
            
            document.getElementById('cancelarEditarCompra').addEventListener('click', function() {
                closeModal('editarCompraModal');
            });
            
            document.getElementById('editarAdicionarItemCompraBtn').addEventListener('click', function() {
                const tbody = document.querySelector('#editarCompraItensTable tbody');
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>
                        <input type="text" class="compra-produto-nome" placeholder="Nome do produto">
                    </td>
                    <td>
                        <input type="number" class="compra-qtd" min="1" value="1">
                    </td>
                    <td>
                        <input type="number" step="0.01" class="compra-valor" placeholder="0.00">
                    </td>
                    <td class="compra-subtotal">R$ 0,00</td>
                    <td>
                        <button type="button" class="action-btn remover-item-compra"><i class="material-icons">delete</i></button>
                    </td>
                `;
                tbody.appendChild(tr);
                
                // Adicionar eventos
                adicionarEventosItemCompra(tr);
            });
            
            document.getElementById('salvarEditarCompra').addEventListener('click', function() {
                const id = document.getElementById('editarCompraId').value;
                const fornecedor = document.getElementById('editarCompraFornecedor').value;
                const fornecedorNome = fornecedor ? document.getElementById('editarCompraFornecedor').options[document.getElementById('editarCompraFornecedor').selectedIndex].text : '';
                const dataPedido = document.getElementById('editarCompraDataPedido').value;
                const dataFormatadaPedido = dataPedido ? new Date(dataPedido).toLocaleDateString('pt-BR') : '';
                const dataEntrega = document.getElementById('editarCompraDataEntrega').value;
                const dataFormatadaEntrega = dataEntrega ? new Date(dataEntrega).toLocaleDateString('pt-BR') : '';
                const status = document.getElementById('editarCompraStatus').value;
                const observacoes = document.getElementById('editarCompraObservacoes').value;
                
                if (!fornecedor || !dataPedido || !dataEntrega || !status) {
                    alert('Preencha todos os campos obrigatórios.');
                    return;
                }
                
                // Verificar itens da compra
                const itensDetalhados = [];
                let total = 0;
                let contador = 0;
                
                document.querySelectorAll('#editarCompraItensTable tbody tr').forEach(function(tr) {
                    const produtoNome = tr.querySelector('.compra-produto-nome').value;
                    const quantidade = parseInt(tr.querySelector('.compra-qtd').value);
                    const valor = parseFloat(tr.querySelector('.compra-valor').value);
                    
                    if (produtoNome && !isNaN(quantidade) && !isNaN(valor)) {
                        const subtotal = quantidade * valor;
                        
                        itensDetalhados.push({
                            produto: produtoNome,
                            quantidade: quantidade,
                            valor: valor,
                            subtotal: subtotal
                        });
                        
                        total += subtotal;
                        contador++;
                    }
                });
                
                if (itensDetalhados.length === 0) {
                    alert('Adicione pelo menos um item à compra.');
                    return;
                }
                
                // Criar objeto de compra atualizado
                const compraAtualizada = {
                    id: id,
                    fornecedor: fornecedor,
                    fornecedorNome: fornecedorNome,
                    itens: contador,
                    total: total,
                    dataPedido: dataFormatadaPedido,
                    dataEntrega: dataFormatadaEntrega,
                    status: status,
                    itensDetalhados: itensDetalhados,
                    observacoes: observacoes
                };
                
                // Atualizar compra
                const sucesso = DB.editarCompra(compraAtualizada);
                
                if (sucesso) {
                    // Atualizar a linha na tabela
                    const row = document.querySelector(`#comprasTable tbody tr td:first-child:contains('${id}')`).closest('tr');
                    if (row) {
                        row.innerHTML = `
                            <td>${compraAtualizada.id}</td>
                            <td>${compraAtualizada.fornecedorNome}</td>
                            <td>${compraAtualizada.itens}</td>
                            <td>${formatarMoeda(compraAtualizada.total)}</td>
                            <td>${compraAtualizada.dataPedido}</td>
                            <td>${compraAtualizada.dataEntrega}</td>
                            <td><span class="status ${getStatusClass(compraAtualizada.status, 'compra')}">${getStatusText(compraAtualizada.status, 'compra')}</span></td>
                            <td class="action-cell">
                                <button class="action-btn" data-action="view" data-id="${compraAtualizada.id}"><i class="material-icons">visibility</i></button>
                                <button class="action-btn" data-action="edit" data-id="${compraAtualizada.id}"><i class="material-icons">edit</i></button>
                            </td>
                        `;
                        
                        // Reativar eventos
                        const viewBtn = row.querySelector('[data-action="view"]');
                        const editBtn = row.querySelector('[data-action="edit"]');
                        
                        viewBtn.addEventListener('click', function() {
                            openViewCompraModal(this.getAttribute('data-id'));
                        });
                        
                        editBtn.addEventListener('click', function() {
                            openEditCompraModal(this.getAttribute('data-id'));
                        });
                    }
                    
                    // Mostrar notificação
                    mostrarNotificacao('Compra atualizada com sucesso!');
                    
                    // Fechar modal
                    closeModal('editarCompraModal');
                } else {
                    mostrarNotificacao('Erro ao atualizar a compra!', 5000);
                }
            });
            
            // Adicionar eventos para navegação de compras
            initializeCompraPagination();
            
            // Adicionar suporte para seleção de linhas com teclado
            initializeTableRowSelection('#comprasTable');
        }
        
        function prepararModalCompra() {
            // Obter a data atual
            const hoje = new Date();
            const dataFormatada = hoje.toISOString().split('T')[0];
            
            // Data estimada de entrega (7 dias a frente)
            const entrega = new Date();
            entrega.setDate(entrega.getDate() + 7);
            const entregaFormatada = entrega.toISOString().split('T')[0];
            
            // Preencher os campos de data
            document.getElementById('compraDataPedido').value = dataFormatada;
            document.getElementById('compraDataEntrega').value = entregaFormatada;
            
            // Limpar os itens
            const tbody = document.querySelector('#compraItensTable tbody');
            tbody.innerHTML = `
                <tr>
                    <td>
                        <input type="text" class="compra-produto-nome" placeholder="Nome do produto">
                    </td>
                    <td>
                        <input type="number" class="compra-qtd" min="1" value="1">
                    </td>
                    <td>
                        <input type="number" step="0.01" class="compra-valor" placeholder="0.00">
                    </td>
                    <td class="compra-subtotal">R$ 0,00</td>
                    <td>
                        <button type="button" class="action-btn remover-item-compra"><i class="material-icons">delete</i></button>
                    </td>
                </tr>
            `;
            
            // Adicionar eventos aos campos
            const tr = tbody.querySelector('tr');
            adicionarEventosItemCompra(tr);
            
            // Atualizar o total
            document.getElementById('compraTotal').textContent = 'R$ 0,00';
        }
        
        function adicionarEventosItemCompra(tr) {
            // Campos de quantidade e valor
            const qtdInput = tr.querySelector('.compra-qtd');
            const valorInput = tr.querySelector('.compra-valor');
            const subtotalCell = tr.querySelector('.compra-subtotal');
            
            // Função para calcular o subtotal do item
            const calcularSubtotal = function() {
                const quantidade = parseInt(qtdInput.value) || 0;
                const valor = parseFloat(valorInput.value) || 0;
                const subtotal = quantidade * valor;
                
                subtotalCell.textContent = formatarMoeda(subtotal);
                atualizarTotalCompra();
            };
            
            // Adicionar eventos para recalcular ao alterar quantidade ou valor
            qtdInput.addEventListener('input', calcularSubtotal);
            valorInput.addEventListener('input', calcularSubtotal);
            
            // Botão para remover o item
            const removerBtn = tr.querySelector('.remover-item-compra');
            removerBtn.addEventListener('click', function() {
                const tbody = tr.parentNode;
                
                // Não remover se for o único item
                if (tbody.children.length > 1) {
                    tbody.removeChild(tr);
                    atualizarTotalCompra();
                } else {
                    // Se for o único, apenas limpa os valores
                    tr.querySelector('.compra-produto-nome').value = '';
                    qtdInput.value = 1;
                    valorInput.value = '';
                    subtotalCell.textContent = 'R$ 0,00';
                    atualizarTotalCompra();
                }
            });
        }
        
        function atualizarTotalCompra() {
            // Calcular o total geral da compra
            let total = 0;
            const isEditing = document.getElementById('editarCompraModal').classList.contains('active');
            const table = isEditing ? '#editarCompraItensTable' : '#compraItensTable';
            const totalElement = isEditing ? 'editarCompraTotal' : 'compraTotal';
            
            document.querySelectorAll(`${table} tbody tr`).forEach(function(tr) {
                const subtotalText = tr.querySelector('.compra-subtotal').textContent;
                const subtotal = parseFloat(subtotalText.replace(/[^\d,.-]/g, '').replace(',', '.')) || 0;
                total += subtotal;
            });
            
            document.getElementById(totalElement).textContent = formatarMoeda(total);
        }
        
        function openViewCompraModal(id) {
            const compra = DB.getCompraPorId(id);
            if (!compra) return;
            
            // Salvar ID da compra no modal para uso posterior
            document.getElementById('verCompraModal').setAttribute('data-compra-id', id);
            
            // Gerar HTML para itens
            let itensHTML = '';
            let total = 0;
            
            if (compra.itensDetalhados && compra.itensDetalhados.length > 0) {
                compra.itensDetalhados.forEach(item => {
                    itensHTML += `
                        <tr>
                            <td>${item.produto}</td>
                            <td>${item.quantidade}</td>
                            <td>${formatarMoeda(item.valor)}</td>
                            <td>${formatarMoeda(item.subtotal)}</td>
                        </tr>
                    `;
                    total += item.subtotal;
                });
            }
            
            // Preencher o conteúdo do modal
            document.getElementById('verCompraConteudo').innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                    <div>
                        <h4 style="color: var(--primary-color); margin-bottom: 5px;">Pedido #</h4>
                        <p>${compra.id}</p>
                    </div>
                    <div>
                        <h4 style="color: var(--primary-color); margin-bottom: 5px;">Status</h4>
                        <p><span class="status ${getStatusClass(compra.status, 'compra')}">${getStatusText(compra.status, 'compra')}</span></p>
                    </div>
                    <div>
                        <h4 style="color: var(--primary-color); margin-bottom: 5px;">Fornecedor</h4>
                        <p>${compra.fornecedorNome}</p>
                    </div>
                    <div>
                        <h4 style="color: var(--primary-color); margin-bottom: 5px;">Total</h4>
                        <p>${formatarMoeda(compra.total)}</p>
                    </div>
                    <div>
                        <h4 style="color: var(--primary-color); margin-bottom: 5px;">Data do Pedido</h4>
                        <p>${compra.dataPedido}</p>
                    </div>
                    <div>
                        <h4 style="color: var(--primary-color); margin-bottom: 5px;">Data de Entrega</h4>
                        <p>${compra.dataEntrega}</p>
                    </div>
                </div>
                
                <h4 style="margin-top: 20px; margin-bottom: 10px; color: var(--primary-color);">Itens do Pedido</h4>
                <table class="sale-products-table">
                    <thead>
                        <tr>
                            <th>Produto</th>
                            <th>Qtd</th>
                            <th>Valor Unit.</th>
                            <th>Subtotal</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${itensHTML}
                        <tr class="sale-total-row">
                            <td colspan="3" style="text-align: right;">Total:</td>
                            <td>${formatarMoeda(compra.total)}</td>
                        </tr>
                    </tbody>
                </table>
                
                ${compra.observacoes ? `
                <div style="margin-top: 20px;">
                    <h4 style="color: var(--primary-color); margin-bottom: 5px;">Observações</h4>
                    <p>${compra.observacoes}</p>
                </div>
                ` : ''}
            `;
            
            // Abrir o modal
            openModal('verCompraModal');
        }
        
        function openEditCompraModal(id) {
            const compra = DB.getCompraPorId(id);
            if (!compra) return;
            
            // Preencher o formulário com os dados da compra
            document.getElementById('editarCompraId').value = compra.id;
            document.getElementById('editarCompraPedido').value = compra.id;
            document.getElementById('editarCompraFornecedor').value = compra.fornecedor;
            
            // Converter datas
            const partesDataPedido = compra.dataPedido.split('/');
            const dataPedido = `${partesDataPedido[2]}-${partesDataPedido[1]}-${partesDataPedido[0]}`;
            document.getElementById('editarCompraDataPedido').value = dataPedido;
            
            const partesDataEntrega = compra.dataEntrega.split('/');
            const dataEntrega = `${partesDataEntrega[2]}-${partesDataEntrega[1]}-${partesDataEntrega[0]}`;
            document.getElementById('editarCompraDataEntrega').value = dataEntrega;
            
            document.getElementById('editarCompraStatus').value = compra.status;
            document.getElementById('editarCompraObservacoes').value = compra.observacoes || '';
            
            // Preencher os itens
            const tbody = document.querySelector('#editarCompraItensTable tbody');
            tbody.innerHTML = '';
            
            if (compra.itensDetalhados && compra.itensDetalhados.length > 0) {
                compra.itensDetalhados.forEach(item => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>
                            <input type="text" class="compra-produto-nome" placeholder="Nome do produto" value="${item.produto}">
                        </td>
                        <td>
                            <input type="number" class="compra-qtd" min="1" value="${item.quantidade}">
                        </td>
                        <td>
                            <input type="number" step="0.01" class="compra-valor" placeholder="0.00" value="${item.valor}">
                        </td>
                        <td class="compra-subtotal">${formatarMoeda(item.subtotal)}</td>
                        <td>
                            <button type="button" class="action-btn remover-item-compra"><i class="material-icons">delete</i></button>
                        </td>
                    `;
                    tbody.appendChild(tr);
                    
                    // Adicionar eventos
                    adicionarEventosItemCompra(tr);
                });
            } else {
                // Se não houver itens, adicionar uma linha vazia
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>
                        <input type="text" class="compra-produto-nome" placeholder="Nome do produto">
                    </td>
                    <td>
                        <input type="number" class="compra-qtd" min="1" value="1">
                    </td>
                    <td>
                        <input type="number" step="0.01" class="compra-valor" placeholder="0.00">
                    </td>
                    <td class="compra-subtotal">R$ 0,00</td>
                    <td>
                        <button type="button" class="action-btn remover-item-compra"><i class="material-icons">delete</i></button>
                    </td>
                `;
                tbody.appendChild(tr);
                
                // Adicionar eventos
                adicionarEventosItemCompra(tr);
            }
            
            // Atualizar o total
            document.getElementById('editarCompraTotal').textContent = formatarMoeda(compra.total);
            
            // Abrir o modal
            openModal('editarCompraModal');
        }
        
        function buscarCompras() {
            const termo = document.getElementById('comprasSearchInput').value;
            const status = document.getElementById('statusCompraFilter').value;
            const data = document.getElementById('dataCompraFilter').value;
            
            // Formatar data se fornecida
            let dataFormatada = null;
            if (data) {
                const dataObj = new Date(data);
                dataFormatada = dataObj.toLocaleDateString('pt-BR');
            }
            
            // Filtrar compras
            const compras = DB.filtrarCompras({
                termo: termo,
                status: status,
                data: dataFormatada
            });
            
            // Atualizar a tabela
            const tbody = document.querySelector('#comprasTable tbody');
            tbody.innerHTML = '';
            
            if (compras.length === 0) {
                // Exibir mensagem de nenhum resultado
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td colspan="8" style="text-align: center; padding: 20px;">Nenhuma compra encontrada.</td>
                `;
                tbody.appendChild(tr);
            } else {
                compras.forEach(compra => {
                    const tr = document.createElement('tr');
                    
                    // Destacar termo na pesquisa
                    let idCell = compra.id;
                    let fornecedorCell = compra.fornecedorNome;
                    let dataPedidoCell = compra.dataPedido;
                    let dataEntregaCell = compra.dataEntrega;
                    
                    if (termo) {
                        const regex = new RegExp(`(${termo})`, 'gi');
                        idCell = compra.id.replace(regex, '<span class="highlight">$1</span>');
                        fornecedorCell = compra.fornecedorNome.replace(regex, '<span class="highlight">$1</span>');
                        
                        if (compra.dataPedido.includes(termo)) {
                            dataPedidoCell = compra.dataPedido.replace(regex, '<span class="highlight">$1</span>');
                        }
                        
                        if (compra.dataEntrega.includes(termo)) {
                            dataEntregaCell = compra.dataEntrega.replace(regex, '<span class="highlight">$1</span>');
                        }
                        
                        // Destacar também no valor total
                        const valorString = compra.total.toString();
                        if (valorString.includes(termo)) {
                            tr.classList.add('highlight');
                        }
                    }
                    
                    tr.innerHTML = `
                        <td>${idCell}</td>
                        <td>${fornecedorCell}</td>
                        <td>${compra.itens}</td>
                        <td>${formatarMoeda(compra.total)}</td>
                        <td>${dataPedidoCell}</td>
                        <td>${dataEntregaCell}</td>
                        <td><span class="status ${getStatusClass(compra.status, 'compra')}">${getStatusText(compra.status, 'compra')}</span></td>
                        <td class="action-cell">
                            <button class="action-btn" data-action="view" data-id="${compra.id}"><i class="material-icons">visibility</i></button>
                            <button class="action-btn" data-action="edit" data-id="${compra.id}"><i class="material-icons">edit</i></button>
                        </td>
                    `;
                    tbody.appendChild(tr);
                    
                    // Adicionar eventos
                    tr.querySelector('[data-action="view"]').addEventListener('click', function() {
                        openViewCompraModal(this.getAttribute('data-id'));
                    });
                    
                    tr.querySelector('[data-action="edit"]').addEventListener('click', function() {
                        openEditCompraModal(this.getAttribute('data-id'));
                    });
                });
                
                // Reinicializar seleção de linhas
                initializeTableRowSelection('#comprasTable');
            }
            
            mostrarNotificacao('Busca realizada');
        }
        
        function initializeCompraPagination() {
            // Implementar paginação para compras
            const compraPrevBtn = document.getElementById('compraPrevPageBtn');
            const compraNextBtn = document.getElementById('compraNextPageBtn');
            const compraPageNumbers = document.getElementById('compraPageNumbers');
            
            // Adiciona eventos aos botões de paginação
            if (compraPrevBtn && compraNextBtn) {
                let currentPage = 1;
                
                compraPrevBtn.addEventListener('click', function() {
                    if (currentPage > 1) {
                        currentPage--;
                        updateCompraPaginationButtons(currentPage);
                    }
                });
                
                compraNextBtn.addEventListener('click', function() {
                    const pages = compraPageNumbers.querySelectorAll('.pagination-btn');
                    if (currentPage < pages.length) {
                        currentPage++;
                        updateCompraPaginationButtons(currentPage);
                    }
                });
                
                // Adiciona eventos aos botões de número de página
                compraPageNumbers.querySelectorAll('.pagination-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        currentPage = parseInt(this.getAttribute('data-page'));
                        updateCompraPaginationButtons(currentPage);
                    });
                });
            }
        }
        
        function updateCompraPaginationButtons(currentPage) {
            // Atualizar botões de paginação para compras
            const pages = document.getElementById('compraPageNumbers').querySelectorAll('.pagination-btn');
            
            pages.forEach(btn => {
                const page = parseInt(btn.getAttribute('data-page'));
                if (page === currentPage) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // Mostra/esconde linhas baseado na página atual (simulação)
            mostrarNotificacao(`Página ${currentPage} de compras carregada`);
        }
        
        // Função para adicionar navegação com teclado na tabela
        function initializeTableRowSelection(tableSelector) {
            const tbody = document.querySelector(`${tableSelector} tbody`);
            if (!tbody) return;
            
            // Adicionar evento de clique nas linhas para seleção
            tbody.querySelectorAll('tr').forEach(tr => {
                tr.addEventListener('click', function() {
                    // Remover seleção de outras linhas
                    tbody.querySelectorAll('tr').forEach(row => {
                        row.classList.remove('selected');
                    });
                    
                    // Selecionar esta linha
                    this.classList.add('selected');
                });
            });
            
            // Adicionar navegação com setas
            document.addEventListener('keydown', function(e) {
                // Verificar se o foco está na tabela ou em algum de seus elementos
                const activeTable = document.querySelector(`${tableSelector}.active`) || 
                                    document.querySelector(`${tableSelector} .selected`) || 
                                    document.activeElement.closest(tableSelector);
                
                if (!activeTable) return;
                
                const selectedRow = tbody.querySelector('tr.selected');
                let newSelectedRow;
                
                switch (e.key) {
                    case 'ArrowUp':
                        e.preventDefault();
                        if (selectedRow) {
                            newSelectedRow = selectedRow.previousElementSibling;
                            if (newSelectedRow) {
                                selectedRow.classList.remove('selected');
                                newSelectedRow.classList.add('selected');
                                newSelectedRow.scrollIntoView({ block: 'nearest' });
                            }
                        } else {
                            // Se nenhuma linha estiver selecionada, selecione a última
                            newSelectedRow = tbody.querySelector('tr:last-child');
                            if (newSelectedRow) {
                                newSelectedRow.classList.add('selected');
                                newSelectedRow.scrollIntoView({ block: 'nearest' });
                            }
                        }
                        break;
                    case 'ArrowDown':
                        e.preventDefault();
                        if (selectedRow) {
                            newSelectedRow = selectedRow.nextElementSibling;
                            if (newSelectedRow) {
                                selectedRow.classList.remove('selected');
                                newSelectedRow.classList.add('selected');
                                newSelectedRow.scrollIntoView({ block: 'nearest' });
                            }
                        } else {
                            // Se nenhuma linha estiver selecionada, selecione a primeira
                            newSelectedRow = tbody.querySelector('tr:first-child');
                            if (newSelectedRow) {
                                newSelectedRow.classList.add('selected');
                                newSelectedRow.scrollIntoView({ block: 'nearest' });
                            }
                        }
                        break;
                    case 'Enter':
                        if (selectedRow) {
                            // Simular clique no botão de visualizar
                            const viewBtn = selectedRow.querySelector('[data-action="view"]');
                            if (viewBtn) {
                                e.preventDefault();
                                viewBtn.click();
                            }
                        }
                        break;
                }
            });
        }
        
        // Inicializa funcionalidades de relatórios
        function initializeRelatoriosFunctionality() {
            // Botões de geração de relatórios
            document.getElementById('gerarRelatorioVendas').addEventListener('click', function() {
                gerarRelatorio('vendas', 'mensal');
            });
            
            document.getElementById('gerarRelatorioEstoque').addEventListener('click', function() {
                gerarRelatorio('estoque', 'mensal');
            });
            
            document.getElementById('gerarRelatorioFinanceiro').addEventListener('click', function() {
                gerarRelatorio('financeiro', 'mensal');
            });
            
            document.getElementById('gerarRelatorioClientes').addEventListener('click', function() {
                gerarRelatorio('clientes', 'mensal');
            });
            
            // Botão de relatório personalizado
            document.getElementById('gerarRelatorioPersonalizado').addEventListener('click', function() {
                const tipo = document.getElementById('tipoRelatorioPersonalizado').value;
                const periodo = document.getElementById('periodoRelatorioPersonalizado').value;
                const dataInicio = document.getElementById('dataInicioPersonalizado').value;
                const dataFim = document.getElementById('dataFimPersonalizado').value;
                const incluirGraficos = document.getElementById('incluirGraficos').checked;
                const incluirTabelas = document.getElementById('incluirTabelas').checked;
                const incluirResumo = document.getElementById('incluirResumo').checked;
                
                if (!tipo || !periodo) {
                    alert('Selecione o tipo e período do relatório.');
                    return;
                }
                
                gerarRelatorio(tipo, periodo, dataInicio, dataFim, incluirGraficos, incluirTabelas, incluirResumo);
            });
            
            // Inicializar eventos dos botões de visualizar relatório
            document.querySelectorAll('.view-report-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const reportId = this.getAttribute('data-id');
                    openViewReportModal(reportId);
                });
            });
            
            // Inicializar eventos dos botões de download relatório
            document.querySelectorAll('.download-report-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const reportId = this.getAttribute('data-id');
                    downloadReport(reportId);
                });
            });
            
            // Eventos para o modal de visualização de relatório
            document.getElementById('closeVerRelatorioModal').addEventListener('click', function() {
                closeModal('verRelatorioModal');
            });
            
            document.getElementById('fecharVerRelatorioBtn').addEventListener('click', function() {
                closeModal('verRelatorioModal');
            });
            
            document.getElementById('downloadRelatorioBtn').addEventListener('click', function() {
                const reportId = document.getElementById('verRelatorioModal').getAttribute('data-report-id');
                downloadReport(reportId);
            });
        }
        
        function gerarRelatorio(tipo, periodo, dataInicio, dataFim, incluirGraficos, incluirTabelas, incluirResumo) {
            // Gerar relatório
            const relatorio = DB.gerarRelatorio(tipo, periodo, dataInicio, dataFim, incluirGraficos, incluirTabelas, incluirResumo);
            
            // Adicionar o relatório à tabela
            const tbody = document.querySelector('#relatoriosTable tbody');
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${relatorio.nome}</td>
                <td>${relatorio.tipo}</td>
                <td>${relatorio.periodo}</td>
                <td>${relatorio.geradoEm}</td>
                <td>${relatorio.geradoPor}</td>
                <td class="action-cell">
                    <button class="action-btn view-report-btn" data-id="${relatorio.id}"><i class="material-icons">visibility</i></button>
                    <button class="action-btn download-report-btn" data-id="${relatorio.id}"><i class="material-icons">download</i></button>
                </td>
            `;
            tbody.prepend(tr);
            
            // Adicionar eventos aos botões
            tr.querySelector('.view-report-btn').addEventListener('click', function() {
                openViewReportModal(this.getAttribute('data-id'));
            });
            
            tr.querySelector('.download-report-btn').addEventListener('click', function() {
                downloadReport(this.getAttribute('data-id'));
            });
            
            // Exibir visualização imediata
            openViewReportModal(relatorio.id);
            
            // Mostrar notificação
            mostrarNotificacao('Relatório gerado com sucesso!');
        }
        
        function openViewReportModal(reportId) {
            const relatorio = DB.getRelatorioPorId(reportId);
            if (!relatorio) return;
            
            // Salvar ID do relatório no modal
            document.getElementById('verRelatorioModal').setAttribute('data-report-id', reportId);
            
            // Montar o conteúdo do relatório
            let conteudoHTML = `
                <div style="text-align: center; margin-bottom: 30px;">
                    <h2 style="color: var(--primary-color); font-size: 1.8rem; margin-bottom: 10px;">${relatorio.conteudo.titulo}</h2>
                    <p style="color: var(--dark-gray);">Período: ${relatorio.conteudo.periodo}</p>
                    <p style="color: var(--dark-gray); font-size: 0.9rem;">Gerado em: ${relatorio.geradoEm} por ${relatorio.geradoPor}</p>
                </div>
                
                <div class="report-summary" style="margin-bottom: 25px; padding: 20px; background-color: var(--light-bg); border-radius: 10px;">
                    <h3 style="color: var(--primary-color); margin-bottom: 15px;">Resumo</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px;">
            `;
            
            // Adicionar itens do resumo baseado no tipo
            const resumo = relatorio.conteudo.resumo;
            for (const [key, value] of Object.entries(resumo)) {
                // Formatar chave para exibição
                let keyFormatted = key.replace(/([A-Z])/g, ' $1')
                    .replace(/^./, function(str) { return str.toUpperCase(); })
                    .replace(/([a-z])([A-Z])/g, '$1 $2');
                
                conteudoHTML += `
                    <div style="background-color: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                        <div style="font-size: 0.85rem; color: var(--dark-gray); margin-bottom: 5px;">${keyFormatted}</div>
                        <div style="font-size: 1.2rem; font-weight: 600; color: var(--primary-color);">${value}</div>
                    </div>
                `;
            }
            
            conteudoHTML += `
                    </div>
                </div>
            `;
            
            // Adicionar detalhes específicos para cada tipo de relatório
            switch (relatorio.tipo) {
                case 'Vendas':
                    if (relatorio.conteudo.tabelaVendas) {
                        conteudoHTML += `
                            <div style="margin-bottom: 25px;">
                                <h3 style="color: var(--primary-color); margin-bottom: 15px;">Últimas Vendas</h3>
                                <table style="width: 100%; border-collapse: collapse;">
                                    <thead>
                                        <tr style="background-color: var(--light-bg);">
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Data</th>
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Cliente</th>
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Valor</th>
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        `;
                        
                        relatorio.conteudo.tabelaVendas.forEach(venda => {
                            const statusClass = venda.status === 'Concluído' ? 'status-success' : 
                                              venda.status === 'Preparando' ? 'status-warning' : 
                                              'status-danger';
                            
                            conteudoHTML += `
                                <tr style="border-bottom: 1px solid var(--border-color);">
                                    <td style="padding: 10px;">${venda.data}</td>
                                    <td style="padding: 10px;">${venda.cliente}</td>
                                    <td style="padding: 10px;">${venda.valor}</td>
                                    <td style="padding: 10px;"><span class="status ${statusClass}" style="display: inline-block; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem;">${venda.status}</span></td>
                                </tr>
                            `;
                        });
                        
                        conteudoHTML += `
                                    </tbody>
                                </table>
                            </div>
                        `;
                    }
                    break;
                    
                case 'Estoque':
                    if (relatorio.conteudo.tabelaEstoque) {
                        conteudoHTML += `
                            <div style="margin-bottom: 25px;">
                                <h3 style="color: var(--primary-color); margin-bottom: 15px;">Status do Estoque</h3>
                                <table style="width: 100%; border-collapse: collapse;">
                                    <thead>
                                        <tr style="background-color: var(--light-bg);">
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Código</th>
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Produto</th>
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Quantidade</th>
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        `;
                        
                        relatorio.conteudo.tabelaEstoque.forEach(item => {
                            const statusClass = item.status === 'Em Estoque' ? 'status-success' : 
                                              item.status === 'Baixo Estoque' ? 'status-warning' : 
                                              'status-danger';
                            
                            conteudoHTML += `
                                <tr style="border-bottom: 1px solid var(--border-color);">
                                    <td style="padding: 10px;">${item.codigo}</td>
                                    <td style="padding: 10px;">${item.nome}</td>
                                    <td style="padding: 10px;">${item.estoque}</td>
                                    <td style="padding: 10px;"><span class="status ${statusClass}" style="display: inline-block; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem;">${item.status}</span></td>
                                </tr>
                            `;
                        });
                        
                        conteudoHTML += `
                                    </tbody>
                                </table>
                            </div>
                        `;
                    }
                    break;
                    
                case 'Financeiro':
                    if (relatorio.conteudo.receitas && relatorio.conteudo.despesas) {
                        conteudoHTML += `
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 25px;">
                                <div style="background-color: var(--light-bg); padding: 20px; border-radius: 10px;">
                                    <h3 style="color: var(--primary-color); margin-bottom: 15px;">Receitas</h3>
                                    <ul style="list-style: none; padding: 0;">
                        `;
                        
                        for (const [key, value] of Object.entries(relatorio.conteudo.receitas)) {
                            const keyFormatted = key.charAt(0).toUpperCase() + key.slice(1).replace(/([A-Z])/g, ' $1');
                            
                            conteudoHTML += `
                                <li style="display: flex; justify-content: space-between; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid rgba(0,0,0,0.1);">
                                    <span>${keyFormatted}</span>
                                    <span style="font-weight: 600; color: var(--success);">${value}</span>
                                </li>
                            `;
                        }
                        
                        conteudoHTML += `
                                    </ul>
                                </div>
                                
                                <div style="background-color: var(--light-bg); padding: 20px; border-radius: 10px;">
                                    <h3 style="color: var(--primary-color); margin-bottom: 15px;">Despesas</h3>
                                    <ul style="list-style: none; padding: 0;">
                        `;
                        
                        for (const [key, value] of Object.entries(relatorio.conteudo.despesas)) {
                            const keyFormatted = key.charAt(0).toUpperCase() + key.slice(1).replace(/([A-Z])/g, ' $1');
                            
                            conteudoHTML += `
                                <li style="display: flex; justify-content: space-between; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid rgba(0,0,0,0.1);">
                                    <span>${keyFormatted}</span>
                                    <span style="font-weight: 600; color: var(--danger);">${value}</span>
                                </li>
                            `;
                        }
                        
                        conteudoHTML += `
                                    </ul>
                                </div>
                            </div>
                        `;
                    }
                    break;
                    
                case 'Clientes':
                    if (relatorio.conteudo.tabelaClientes) {
                        conteudoHTML += `
                            <div style="margin-bottom: 25px;">
                                <h3 style="color: var(--primary-color); margin-bottom: 15px;">Clientes Recentes</h3>
                                <table style="width: 100%; border-collapse: collapse;">
                                    <thead>
                                        <tr style="background-color: var(--light-bg);">
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">ID</th>
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Nome</th>
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Email</th>
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Última Compra</th>
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Total Gasto</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        `;
                        
                        relatorio.conteudo.tabelaClientes.forEach(cliente => {
                            conteudoHTML += `
                                <tr style="border-bottom: 1px solid var(--border-color);">
                                    <td style="padding: 10px;">${cliente.id}</td>
                                    <td style="padding: 10px;">${cliente.nome}</td>
                                    <td style="padding: 10px;">${cliente.email}</td>
                                    <td style="padding: 10px;">${cliente.ultimaCompra}</td>
                                    <td style="padding: 10px;">${cliente.totalGasto}</td>
                                </tr>
                            `;
                        });
                        
                        conteudoHTML += `
                                    </tbody>
                                </table>
                            </div>
                        `;
                    }
                    break;
                    
                case 'Compras':
                    if (relatorio.conteudo.tabelaCompras) {
                        conteudoHTML += `
                            <div style="margin-bottom: 25px;">
                                <h3 style="color: var(--primary-color); margin-bottom: 15px;">Compras Recentes</h3>
                                <table style="width: 100%; border-collapse: collapse;">
                                    <thead>
                                        <tr style="background-color: var(--light-bg);">
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Pedido</th>
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Fornecedor</th>
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Data</th>
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Valor</th>
                                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid var(--border-color);">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        `;
                        
                        relatorio.conteudo.tabelaCompras.forEach(compra => {
                            const statusClass = compra.status === 'Entregue' ? 'status-success' : 
                                              compra.status === 'Pendente' ? 'status-warning' : 
                                              'status-danger';
                            
                            conteudoHTML += `
                                <tr style="border-bottom: 1px solid var(--border-color);">
                                    <td style="padding: 10px;">${compra.pedido}</td>
                                    <td style="padding: 10px;">${compra.fornecedor}</td>
                                    <td style="padding: 10px;">${compra.dataPedido}</td>
                                    <td style="padding: 10px;">${compra.valor}</td>
                                    <td style="padding: 10px;"><span class="status ${statusClass}" style="display: inline-block; padding: 4px 8px; border-radius: 12px; font-size: 0.8rem;">${compra.status}</span></td>
                                </tr>
                            `;
                        });
                        
                        conteudoHTML += `
                                    </tbody>
                                </table>
                            </div>
                        `;
                    }
                    break;
            }
            
            // Finalizar o conteúdo
            conteudoHTML += `
                <div style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid var(--border-color); color: var(--dark-gray); font-size: 0.85rem;">
                    <p>Relatório gerado por ${DB.getConfiguracoes().nomeEmpresa} - ${relatorio.geradoEm}</p>
                </div>
            `;
            
            // Preencher o modal com o conteúdo
            document.getElementById('verRelatorioConteudo').innerHTML = conteudoHTML;
            
            // Mostrar o modal
            openModal('verRelatorioModal');
            
            // Adicionar o relatório ao container do relatório para exibição inline
            const reportContainer = document.getElementById('reportContainer');
            reportContainer.innerHTML = conteudoHTML;
            reportContainer.classList.add('active');
        }
        
        function downloadReport(reportId) {
            const relatorio = DB.getRelatorioPorId(reportId);
            if (!relatorio) return;
            
            // Simulação de download (em um ambiente real, geraria um PDF)
            mostrarNotificacao(`Relatório "${relatorio.nome}" baixado com sucesso!`);
        }

         document.addEventListener('DOMContentLoaded', function() {
            const helpBotButton = document.getElementById('helpBotButton');
            const helpBotPanel = document.getElementById('helpBotPanel');
            const closeHelpBot = document.getElementById('closeHelpBot');
            const commonQuestions = document.getElementById('commonQuestions');
            const helpBotChat = document.getElementById('helpBotChat');
            const chatMessages = document.getElementById('chatMessages');
            const backToQuestions = document.getElementById('backToQuestions');
            const questionItems = document.querySelectorAll('.question-item');
            const toggleAudioButton = document.getElementById('toggleAudio');
            
            // Estado para controle de áudio
            let audioEnabled = false;
            let speaking = false;
            let paused = false;
            let speechSynthesis = window.speechSynthesis;
            let speechUtterance = null;
            let selectedVoice = null;
            let speechRate = 1.0;
            let speechVolume = 1.0;
            
            // Respostas pré-definidas para as perguntas
            const responses = {
                "Como adicionar um novo produto?": 
                    "Para adicionar um novo produto:<br><br>1. Clique na seção 'Produtos' no menu lateral<br>2. Clique no botão 'Novo Produto' no canto superior direito<br>3. Preencha o formulário com os dados do produto<br>4. Clique em 'Salvar'<br><br>Precisa de mais ajuda com isso?",
                
                "Como registrar uma venda?": 
                    "Para registrar uma nova venda:<br><br>1. Clique no botão 'Nova Venda' no Dashboard<br>2. Selecione os produtos a serem vendidos<br>3. Adicione informações do cliente (opcional)<br>4. Selecione a forma de pagamento<br>5. Finalize a venda<br><br>Posso ajudar com mais alguma coisa?",
                
                "Como verificar o estoque?": 
                    "Para verificar o estoque:<br><br>1. Acesse a seção 'Produtos' no menu lateral<br>2. A coluna 'Estoque' mostra a quantidade disponível de cada produto<br>3. Use os filtros para ver produtos com estoque baixo ou sem estoque<br><br>Você também pode verificar os produtos em baixa diretamente no Dashboard. Posso ajudar com mais detalhes?",
                
                "Como gerar relatórios?": 
                    "Para gerar relatórios:<br><br>1. Acesse a seção 'Relatórios' no menu lateral<br>2. Selecione o tipo de relatório desejado (Vendas, Estoque, Financeiro, etc.)<br>3. Defina o período desejado<br>4. Clique em 'Gerar Relatório'<br>5. Você pode exportar em PDF ou Excel<br><br>Precisa de ajuda com algum relatório específico?",
                
                "Como adicionar novos usuários?": 
                    "Para adicionar novos usuários:<br><br>1. Acesse a seção 'Usuários' no menu lateral<br>2. Clique no botão 'Novo Usuário'<br>3. Preencha os dados do usuário<br>4. Defina o nível de permissão<br>5. Clique em 'Salvar'<br><br>O usuário receberá um email com instruções para definir sua senha. Posso ajudar com mais alguma coisa?",
                
                "Como atualizar meus dados?": 
                    "Para atualizar seus dados:<br><br>1. Clique no seu nome/avatar no canto inferior esquerdo do menu lateral<br>2. Selecione 'Meu Perfil'<br>3. Atualize suas informações<br>4. Clique em 'Salvar'<br><br>Para alterar sua senha, há uma opção específica na página de perfil. Precisa de mais ajuda?"
            };
            
            // Função para carregar vozes disponíveis
            function loadVoices() {
                const voiceSelect = document.getElementById('voiceSelect');
                const voices = speechSynthesis.getVoices();
                
                // Limpar opções existentes
                voiceSelect.innerHTML = '';
                
                // Adicionar opção padrão
                const defaultOption = document.createElement('option');
                defaultOption.value = '';
                defaultOption.textContent = 'Selecione uma voz';
                voiceSelect.appendChild(defaultOption);
                
                // Adicionar vozes disponíveis
                voices.forEach((voice, index) => {
                    if (voice.lang.includes('pt')) {
                        const option = document.createElement('option');
                        option.value = index;
                        option.textContent = `${voice.name} (${voice.lang})`;
                        voiceSelect.appendChild(option);
                    }
                });
                
                // Habilitar o select se houver vozes
                voiceSelect.disabled = voices.length === 0;
                
                // Selecionar voz padrão em português, se disponível
                const ptVoice = voices.find(voice => voice.lang.includes('pt'));
                if (ptVoice) {
                    selectedVoice = ptVoice;
                    voiceSelect.value = voices.indexOf(ptVoice);
                }
            }
            
            // Inicializar vozes
            function initVoices() {
                loadVoices();
                if (speechSynthesis.onvoiceschanged !== undefined) {
                    speechSynthesis.onvoiceschanged = loadVoices;
                }
            }
            
            // Configurar áudio se suportado
            if ('speechSynthesis' in window) {
                const voiceSelect = document.getElementById('voiceSelect');
                const speechRateInput = document.getElementById('speechRate');
                const speechVolumeInput = document.getElementById('speechVolume');
                const speechStatus = document.getElementById('speechStatus');
                
                // Configurar botão de alternância de áudio
                toggleAudioButton.addEventListener('click', function() {
                    audioEnabled = !audioEnabled;
                    
                    if (audioEnabled) {
                        const welcomeMessage = "Olá! Sou o assistente virtual do NewBox. Como posso ajudar?";
                        speakText(welcomeMessage);
                        this.innerHTML = '<i class="material-icons">volume_off</i><span>Desativar Voz</span>';
                        speechStatus.textContent = 'Voz ativada';
                        voiceSelect.disabled = false;
                    } else {
                        if (speaking) {
                            speechSynthesis.cancel();
                            speaking = false;
                            paused = false;
                        }
                        this.innerHTML = '<i class="material-icons">volume_up</i><span>Ativar Voz</span>';
                        speechStatus.textContent = 'Voz desativada';
                        voiceSelect.disabled = true;
                        document.querySelector('.audio-toggle-button.pause').style.display = 'none';
                    }
                });
                
                // Seleção de voz
                voiceSelect.addEventListener('change', function() {
                    const voices = speechSynthesis.getVoices();
                    const selectedIndex = this.value;
                    if (selectedIndex) {
                        selectedVoice = voices[selectedIndex];
                    }
                });
                
                // Ajustar velocidade
                speechRateInput.addEventListener('input', function() {
                    speechRate = parseFloat(this.value);
                    speechStatus.textContent = `Voz ativada (Velocidade: ${speechRate.toFixed(1)})`;
                });
                
                // Ajustar volume
                speechVolumeInput.addEventListener('input', function() {
                    speechVolume = parseFloat(this.value);
                    speechStatus.textContent = `Voz ativada (Volume: ${(speechVolume * 100).toFixed(0)}%)`;
                });
                
                // Botão de pausar/continuar
                const pauseButton = document.createElement('button');
                pauseButton.className = 'audio-toggle-button pause';
                pauseButton.innerHTML = '<i class="material-icons">pause</i><span>Pausar Voz</span>';
                pauseButton.style.display = 'none';
                document.querySelector('.audio-controls').appendChild(pauseButton);
                
                pauseButton.addEventListener('click', function() {
                    if (speaking && !paused) {
                        speechSynthesis.pause();
                        paused = true;
                        this.innerHTML = '<i class="material-icons">play_arrow</i><span>Continuar Voz</span>';
                        speechStatus.textContent = 'Voz pausada';
                    } else if (paused) {
                        speechSynthesis.resume();
                        paused = false;
                        this.innerHTML = '<i class="material-icons">pause</i><span>Pausar Voz</span>';
                        speechStatus.textContent = `Voz ativada (Velocidade: ${speechRate.toFixed(1)}, Volume: ${(speechVolume * 100).toFixed(0)}%)`;
                    }
                });
            } else {
                // Ocultar controles se a síntese de voz não for suportada
                document.querySelector('.audio-controls').style.display = 'none';
            }
            
            // Abrir painel do bot
            helpBotButton.addEventListener('click', function() {
                helpBotPanel.classList.toggle('active');
                
                // Remove o badge de notificação quando o painel é aberto
                const badge = this.querySelector('.notification-badge');
                if (badge) {
                    badge.style.display = 'none';
                }
                
                // Fala a mensagem de boas-vindas se o áudio estiver ativado
                if (audioEnabled && helpBotPanel.classList.contains('active')) {
                    setTimeout(() => {
                        const welcomeMessage = "Olá! Sou o assistente virtual do NewBox. Como posso ajudar?";
                        speakText(welcomeMessage);
                    }, 300);
                }
            });
            
            // Fechar painel do bot
            closeHelpBot.addEventListener('click', function() {
                helpBotPanel.classList.remove('active');
                
                // Parar qualquer fala em andamento
                if (speaking) {
                    speechSynthesis.cancel();
                    speaking = false;
                    paused = false;
                }
            });
            
            // Voltar para perguntas frequentes
            backToQuestions.addEventListener('click', function() {
                helpBotChat.classList.remove('active');
                commonQuestions.style.display = 'block';
            });
            
            // Processar perguntas selecionadas
            questionItems.forEach(function(item) {
                item.addEventListener('click', function() {
                    const question = this.getAttribute('data-question');
                    const response = responses[question];
                    
                    // Esconde as perguntas frequentes
                    commonQuestions.style.display = 'none';
                    
                    // Mostra a área de chat
                    helpBotChat.classList.add('active');
                    
                    // Limpa mensagens anteriores
                    chatMessages.innerHTML = '';
                    
                    // Adiciona a pergunta do usuário
                    addUserMessage(question);
                    
                    // Mostra o indicador de digitação
                    showTypingIndicator();
                    
                    // Adiciona a resposta do bot após um pequeno delay
                    setTimeout(function() {
                        removeTypingIndicator();
                        
                        // Texto para fala (sem tags HTML)
                        const plainTextResponse = response.replace(/<br><br>/g, '. ').replace(/<br>/g, ' ').replace(/<[^>]*>/g, '');
                        
                        // Adiciona a resposta do bot
                        addBotMessage(response, plainTextResponse);
                        
                        // Adiciona opções de resposta rápida
                        addQuickOptions();
                    }, 1500);
                });
            });
            
            // Função para adicionar mensagem do usuário
            function addUserMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message message-user';
                messageDiv.innerHTML = `<div class="message-content">${message}</div>`;
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // Função para adicionar mensagem do bot
            function addBotMessage(message, plainText) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message message-bot';
                
                // Adiciona botão para falar o texto se a síntese de voz estiver disponível
                let speakButton = '';
                if ('speechSynthesis' in window) {
                    speakButton = `<button class="speak-button" title="Ouvir mensagem"><i class="material-icons">volume_up</i></button>`;
                }
                
                messageDiv.innerHTML = `<div class="message-content">${message}${speakButton}</div>`;
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // Adicionar evento de clique ao botão de fala
                const speakBtn = messageDiv.querySelector('.speak-button');
                if (speakBtn) {
                    speakBtn.addEventListener('click', function() {
                        if (speaking) {
                            speechSynthesis.cancel();
                            speaking = false;
                            paused = false;
                            this.classList.remove('speaking');
                            this.innerHTML = '<i class="material-icons">volume_up</i>';
                        } else {
                            speakText(plainText, this);
                        }
                    });
                }
                
                // Falar o texto automaticamente se a opção estiver ativada
                if (audioEnabled) {
                    speakText(plainText);
                }
            }
            
            // Função para mostrar indicador de digitação
            function showTypingIndicator() {
                const typingDiv = document.createElement('div');
                typingDiv.className = 'typing-indicator';
                typingDiv.id = 'typingIndicator';
                typingDiv.innerHTML = `
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                `;
                chatMessages.appendChild(typingDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // Função para remover indicador de digitação
            function removeTypingIndicator() {
                const typingIndicator = document.getElementById('typingIndicator');
                if (typingIndicator) {
                    typingIndicator.remove();
                }
            }
            
            // Função para adicionar opções de resposta rápida
            function addQuickOptions() {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message message-bot';
                
                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'bot-options';
                optionsDiv.innerHTML = `
                    <button class="bot-option-btn" data-response="Sim, obrigado!">Sim, obrigado!</button>
                    <button class="bot-option-btn" data-response="Preciso de mais ajuda">Preciso de mais ajuda</button>
                    <button class="bot-option-btn" data-response="Outro assunto">Outro assunto</button>
                `;
                
                messageDiv.appendChild(optionsDiv);
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                
                // Adicionar eventos aos botões de opção
                const optionBtns = optionsDiv.querySelectorAll('.bot-option-btn');
                optionBtns.forEach(function(btn) {
                    btn.addEventListener('click', function() {
                        const response = this.getAttribute('data-response');
                        
                        // Adiciona a resposta do usuário
                        addUserMessage(response);
                        
                        // Remove as opções depois de selecionada
                        messageDiv.remove();
                        
                        // Mostra o indicador de digitação
                        showTypingIndicator();
                        
                        // Processa a resposta
                        setTimeout(function() {
                            removeTypingIndicator();
                            
                            let botResponse = "";
                            
                            if (response === "Sim, obrigado!") {
                                botResponse = "Fico feliz em poder ajudar! Se precisar de mais alguma coisa, é só me chamar.";
                            } else if (response === "Preciso de mais ajuda") {
                                botResponse = "Claro! O que mais você gostaria de saber? Você pode selecionar uma das opções abaixo ou voltar para as perguntas frequentes.";
                            } else if (response === "Outro assunto") {
                                botResponse = "Claro! Você pode voltar para as perguntas frequentes e selecionar outra opção, ou me dizer em que posso ajudar.";
                            }
                            
                            // Adiciona a resposta do bot
                            addBotMessage(botResponse, botResponse);
                            
                            if (response !== "Sim, obrigado!") {
                                addQuickOptions();
                            }
                        }, 1000);
                    });
                });
            }
            
            // Função para sintetizar voz
            function speakText(text, button = null) {
                // Verificar se já está falando
                if (speaking) {
                    speechSynthesis.cancel();
                }
                
                // Criar nova fala
                speechUtterance = new SpeechSynthesisUtterance(text);
                
                // Usar voz selecionada
                if (selectedVoice) {
                    speechUtterance.voice = selectedVoice;
                }
                
                speechUtterance.lang = 'pt-BR';
                speechUtterance.rate = speechRate;
                speechUtterance.volume = speechVolume;
                
                // Marcar como falando
                speaking = true;
                
                // Atualizar botão se fornecido
                if (button) {
                    button.classList.add('speaking');
                    button.innerHTML = '<i class="material-icons">volume_off</i>';
                }
                
                // Atualizar status
                const speechStatus = document.getElementById('speechStatus');
                speechStatus.textContent = 'Falando...';
                
                // Mostrar botão de pausa
                const pauseButton = document.querySelector('.audio-toggle-button.pause');
                if (pauseButton) {
                    pauseButton.style.display = 'inline-flex';
                }
                
                // Eventos para controlar o estado de fala
                speechUtterance.onend = function() {
                    speaking = false;
                    paused = false;
                    if (button) {
                        button.classList.remove('speaking');
                        button.innerHTML = '<i class="material-icons">volume_up</i>';
                    }
                    if (pauseButton) {
                        pauseButton.style.display = 'none';
                    }
                    speechStatus.textContent = audioEnabled 
                        ? `Voz ativada (Velocidade: ${speechRate.toFixed(1)}, Volume: ${(speechVolume * 100).toFixed(0)}%)`
                        : 'Voz desativada';
                };
                
                speechUtterance.onerror = function(event) {
                    speaking = false;
                    paused = false;
                    if (button) {
                        button.classList.remove('speaking');
                        button.innerHTML = '<i class="material-icons">volume_up</i>';
                    }
                    if (pauseButton) {
                        pauseButton.style.display = 'none';
                    }
                    speechStatus.textContent = 'Erro na fala. Tente novamente.';
                    console.error('Erro na síntese de voz:', event.error);
                };
                
                // Iniciar fala
                speechSynthesis.speak(speechUtterance);
            }
            
            // Inicializar vozes quando o documento estiver pronto
            initVoices();
            
            // Falar mensagem de boas-vindas na primeira abertura
            helpBotButton.addEventListener('click', function() {
                if (!helpBotPanel.classList.contains('was-opened')) {
                    helpBotPanel.classList.add('was-opened');
                    if (audioEnabled) {
                        setTimeout(() => {
                            const welcomeMsg = "Olá! Sou o assistente virtual do NewBox. Como posso ajudar?";
                            speakText(welcomeMsg);
                        }, 1000);
                    }
                }
            });
        });
    </script>
</body>
</html>